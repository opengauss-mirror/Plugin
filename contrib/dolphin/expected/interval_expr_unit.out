create schema test_time_expr;
set current_schema to test_time_expr;
set dolphin.b_compatibility_mode = on;
-- test for 'bit_expr Â± interval expr unit'
drop table if exists test_type_table cascade;
NOTICE:  table "test_type_table" does not exist, skipping
create table test_type_table
(
  `int1`         tinyint,
  `uint1`        tinyint unsigned,
  `int2`         smallint,
  `uint2`        smallint unsigned,
  `int4`         integer,
  `uint4`        integer unsigned,
  `int8`         bigint,
  `uint8`        bigint unsigned,
  `float4`       float4,
  `float8`       float8,
  `numeric`      decimal(20, 6),
  `date`         date,
  `time`         time,
  `time(4)`      time(4),
  `datetime`     datetime,
  `datetime(4)`  datetime(4) default '2022-11-11 11:11:11',
  `timestamp`    timestamp,
  `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
  `year`         year,
  `char`         char(100),
  `varchar`      varchar(100),
  `text`         text
);
insert into test_type_table
values (111, 111, 11111, 11111, 1111111111, 1111111111, 11111111111111, 11111111111111, 111, 1111111111111.1, 111,
        '2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456',
        '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023',
        '2023-02-05', '2023-02-05', '2023-02-05');
drop view if exists res_view;
NOTICE:  view "res_view" does not exist, skipping
create view res_view as select
`int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4`  + interval 1 day as 'float4 + interval 1 day',
`float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric`  + interval 1 day as 'numeric + interval 1 day',
`date`  + interval 1 day as 'date + interval 1 day',
`time`  + interval 1 day as 'time + interval 1 day',
`time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year`  + interval 1 day as 'year + interval 1 day',
`char`  + interval 1 day as 'char + interval 1 day',
`varchar`  + interval 1 day as 'varchar + interval 1 day',
`text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table;
\x
select * from res_view;
-[ RECORD 1 ]-----------------+------------------------
int1 + interval 1 day         | 2000-01-12
uint1 + interval 1 day        | 2000-01-12
int2 + interval 1 day         | 2001-11-12
uint2 + interval 1 day        | 2001-11-12
int4 + interval 1 day         | 2000-11-12 11:11:11
uint4 + interval 1 day        | 2000-11-12 11:11:11
int8 + interval 1 day         | 1111-11-12 11:11:11
uint8 + interval 1 day        | 1111-11-12 11:11:11
float4 + interval 1 day       | 2000-01-12
float8 + interval 1 day       | 0111-11-12 11:11:11.1
numeric + interval 1 day      | 2000-01-12
date + interval 1 day         | 2023-02-06
--? time + interval 1 day         | .* 19:10:50
--? time(4) + interval 1 day      | .* 19:10:50.3456
datetime + interval 1 day     | 2023-02-06 19:10:50
datetime(4) + interval 1 day  | 2023-02-06 19:10:50.456
timestamp + interval 1 day    | 2023-02-06 19:10:50
timestamp(4) + interval 1 day | 2023-02-06 19:10:50.456
year + interval 1 day         | 2023
char + interval 1 day         | 2023-02-06
varchar + interval 1 day      | 2023-02-06
text + interval 1 day         | 2023-02-06

\x
desc res_view;
             Field             | Type | Null | Key | Default | Extra 
-------------------------------+------+------+-----+---------+-------
 int1 + interval 1 day         | text | YES  |     | NULL    | 
 uint1 + interval 1 day        | text | YES  |     | NULL    | 
 int2 + interval 1 day         | text | YES  |     | NULL    | 
 uint2 + interval 1 day        | text | YES  |     | NULL    | 
 int4 + interval 1 day         | text | YES  |     | NULL    | 
 uint4 + interval 1 day        | text | YES  |     | NULL    | 
 int8 + interval 1 day         | text | YES  |     | NULL    | 
 uint8 + interval 1 day        | text | YES  |     | NULL    | 
 float4 + interval 1 day       | text | YES  |     | NULL    | 
 float8 + interval 1 day       | text | YES  |     | NULL    | 
 numeric + interval 1 day      | text | YES  |     | NULL    | 
 date + interval 1 day         | text | YES  |     | NULL    | 
 time + interval 1 day         | text | YES  |     | NULL    | 
 time(4) + interval 1 day      | text | YES  |     | NULL    | 
 datetime + interval 1 day     | text | YES  |     | NULL    | 
 datetime(4) + interval 1 day  | text | YES  |     | NULL    | 
 timestamp + interval 1 day    | text | YES  |     | NULL    | 
 timestamp(4) + interval 1 day | text | YES  |     | NULL    | 
 year + interval 1 day         | year | YES  |     | NULL    | 
 char + interval 1 day         | text | YES  |     | NULL    | 
 varchar + interval 1 day      | text | YES  |     | NULL    | 
 text + interval 1 day         | text | YES  |     | NULL    | 
(22 rows)

drop view if exists res_view;
create view res_view as select
interval 1 day + `int1` as 'interval 1 day + int1',
interval 1 day + `uint1` as 'interval 1 day + uint1',
interval 1 day + `int2` as 'interval 1 day + int2',
interval 1 day + `uint2` as 'interval 1 day + uint2',
interval 1 day + `int4` as 'interval 1 day + int4',
interval 1 day + `uint4` as 'interval 1 day + uint4',
interval 1 day + `int8` as 'interval 1 day + int8',
interval 1 day + `uint8` as 'interval 1 day + uint8',
interval 1 day + `float4` as 'interval 1 day + float4',
interval 1 day + `float8` as 'interval 1 day + float8',
interval 1 day + `numeric` as 'interval 1 day + numeric',
interval 1 day + `date` as 'interval 1 day + date',
interval 1 day + `time` as 'interval 1 day + time',
interval 1 day + `time(4)` as 'interval 1 day + time(4)',
interval 1 day + `datetime` as 'interval 1 day + datetime',
interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
interval 1 day + `timestamp` as 'interval 1 day + timestamp',
interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
interval 1 day + `year` as 'interval 1 day + year',
interval 1 day + `char` as 'interval 1 day + char',
interval 1 day + `varchar` as 'interval 1 day + varchar',
interval 1 day + `text` as 'interval 1 day + text'
from test_type_table;
\x
select * from res_view;
-[ RECORD 1 ]-----------------+------------------------
interval 1 day + int1         | 2000-01-12
interval 1 day + uint1        | 2000-01-12
interval 1 day + int2         | 2001-11-12
interval 1 day + uint2        | 2001-11-12
interval 1 day + int4         | 2000-11-12 11:11:11
interval 1 day + uint4        | 2000-11-12 11:11:11
interval 1 day + int8         | 1111-11-12 11:11:11
interval 1 day + uint8        | 1111-11-12 11:11:11
interval 1 day + float4       | 2000-01-12
interval 1 day + float8       | 0111-11-12 11:11:11.1
interval 1 day + numeric      | 2000-01-12
interval 1 day + date         | 2023-02-06
--? interval 1 day + time         | .* 19:10:50
--? interval 1 day + time(4)      | .* 19:10:50.3456
interval 1 day + datetime     | 2023-02-06 19:10:50
interval 1 day + datetime(4)  | 2023-02-06 19:10:50.456
interval 1 day + timestamp    | 2023-02-06 19:10:50
interval 1 day + timestamp(4) | 2023-02-06 19:10:50.456
interval 1 day + year         | 2023
interval 1 day + char         | 2023-02-06
interval 1 day + varchar      | 2023-02-06
interval 1 day + text         | 2023-02-06

\x
desc res_view;
             Field             | Type | Null | Key | Default | Extra 
-------------------------------+------+------+-----+---------+-------
 interval 1 day + int1         | text | YES  |     | NULL    | 
 interval 1 day + uint1        | text | YES  |     | NULL    | 
 interval 1 day + int2         | text | YES  |     | NULL    | 
 interval 1 day + uint2        | text | YES  |     | NULL    | 
 interval 1 day + int4         | text | YES  |     | NULL    | 
 interval 1 day + uint4        | text | YES  |     | NULL    | 
 interval 1 day + int8         | text | YES  |     | NULL    | 
 interval 1 day + uint8        | text | YES  |     | NULL    | 
 interval 1 day + float4       | text | YES  |     | NULL    | 
 interval 1 day + float8       | text | YES  |     | NULL    | 
 interval 1 day + numeric      | text | YES  |     | NULL    | 
 interval 1 day + date         | text | YES  |     | NULL    | 
 interval 1 day + time         | text | YES  |     | NULL    | 
 interval 1 day + time(4)      | text | YES  |     | NULL    | 
 interval 1 day + datetime     | text | YES  |     | NULL    | 
 interval 1 day + datetime(4)  | text | YES  |     | NULL    | 
 interval 1 day + timestamp    | text | YES  |     | NULL    | 
 interval 1 day + timestamp(4) | text | YES  |     | NULL    | 
 interval 1 day + year         | year | YES  |     | NULL    | 
 interval 1 day + char         | text | YES  |     | NULL    | 
 interval 1 day + varchar      | text | YES  |     | NULL    | 
 interval 1 day + text         | text | YES  |     | NULL    | 
(22 rows)

drop view if exists res_view;
create view res_view as select
`int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4`  - interval 1 day as 'float4 - interval 1 day',
`float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric`  - interval 1 day as 'numeric - interval 1 day',
`date`  - interval 1 day as 'date - interval 1 day',
`time`  - interval 1 day as 'time - interval 1 day',
`time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year`  - interval 1 day as 'year - interval 1 day',
`char`  - interval 1 day as 'char - interval 1 day',
`varchar`  - interval 1 day as 'varchar - interval 1 day',
`text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table;
\x
select * from res_view;
-[ RECORD 1 ]-----------------+------------------------
int1 - interval 1 day         | 2000-01-10
uint1 - interval 1 day        | 2000-01-10
int2 - interval 1 day         | 2001-11-10
uint2 - interval 1 day        | 2001-11-10
int4 - interval 1 day         | 2000-11-10 11:11:11
uint4 - interval 1 day        | 2000-11-10 11:11:11
int8 - interval 1 day         | 1111-11-10 11:11:11
uint8 - interval 1 day        | 1111-11-10 11:11:11
float4 - interval 1 day       | 2000-01-10
float8 - interval 1 day       | 0111-11-10 11:11:11.1
numeric - interval 1 day      | 2000-01-10
date - interval 1 day         | 2023-02-04
--? time - interval 1 day         | .* 19:10:50
--? time(4) - interval 1 day      | .* 19:10:50.3456
datetime - interval 1 day     | 2023-02-04 19:10:50
datetime(4) - interval 1 day  | 2023-02-04 19:10:50.456
timestamp - interval 1 day    | 2023-02-04 19:10:50
timestamp(4) - interval 1 day | 2023-02-04 19:10:50.456
year - interval 1 day         | 2022
char - interval 1 day         | 2023-02-04
varchar - interval 1 day      | 2023-02-04
text - interval 1 day         | 2023-02-04

\x
desc res_view;
             Field             | Type | Null | Key | Default | Extra 
-------------------------------+------+------+-----+---------+-------
 int1 - interval 1 day         | text | YES  |     | NULL    | 
 uint1 - interval 1 day        | text | YES  |     | NULL    | 
 int2 - interval 1 day         | text | YES  |     | NULL    | 
 uint2 - interval 1 day        | text | YES  |     | NULL    | 
 int4 - interval 1 day         | text | YES  |     | NULL    | 
 uint4 - interval 1 day        | text | YES  |     | NULL    | 
 int8 - interval 1 day         | text | YES  |     | NULL    | 
 uint8 - interval 1 day        | text | YES  |     | NULL    | 
 float4 - interval 1 day       | text | YES  |     | NULL    | 
 float8 - interval 1 day       | text | YES  |     | NULL    | 
 numeric - interval 1 day      | text | YES  |     | NULL    | 
 date - interval 1 day         | text | YES  |     | NULL    | 
 time - interval 1 day         | text | YES  |     | NULL    | 
 time(4) - interval 1 day      | text | YES  |     | NULL    | 
 datetime - interval 1 day     | text | YES  |     | NULL    | 
 datetime(4) - interval 1 day  | text | YES  |     | NULL    | 
 timestamp - interval 1 day    | text | YES  |     | NULL    | 
 timestamp(4) - interval 1 day | text | YES  |     | NULL    | 
 year - interval 1 day         | year | YES  |     | NULL    | 
 char - interval 1 day         | text | YES  |     | NULL    | 
 varchar - interval 1 day      | text | YES  |     | NULL    | 
 text - interval 1 day         | text | YES  |     | NULL    | 
(22 rows)

-- test whether support default
drop table if exists test_def_interval_pl;
NOTICE:  table "test_def_interval_pl" does not exist, skipping
create table test_def_interval_pl(
  a datetime default ('2020-01-01 00:00:00' + interval 1 day),
  b datetime default (interval 1 day + '2020-01-01 00:00:00'),
  c datetime default ('2020-01-01 00:00:00' - interval 1 day)
);
desc test_def_interval_pl;
 Field |              Type              | Null | Key |                         Default                         | Extra 
-------+--------------------------------+------+-----+---------------------------------------------------------+-------
 a     | timestamp(0) without time zone | YES  |     | ('2020-01-01 00:00:00'::text + '@ 1 day'::interval day) | 
 b     | timestamp(0) without time zone | YES  |     | ('@ 1 day'::interval day + '2020-01-01 00:00:00'::text) | 
 c     | timestamp(0) without time zone | YES  |     | ('2020-01-01 00:00:00'::text - '@ 1 day'::interval day) | 
(3 rows)

insert into test_def_interval_pl values(default, default, default);
select * from test_def_interval_pl;
          a          |          b          |          c          
---------------------+---------------------+---------------------
 2020-01-02 00:00:00 | 2020-01-02 00:00:00 | 2019-12-31 00:00:00
(1 row)

drop table if exists test_def_interval_pl;
-- no strict mode
set dolphin.sql_mode = '';
drop table if exists test_type_table_null;
NOTICE:  table "test_type_table_null" does not exist, skipping
create table test_type_table_null (like test_type_table);
insert into test_type_table_null values(null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null);
drop table if exists test_type_table_zero;
NOTICE:  table "test_type_table_zero" does not exist, skipping
create table test_type_table_zero (like test_type_table);
insert into test_type_table_zero values(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
drop table if exists test_type_table_invalid;
NOTICE:  table "test_type_table_invalid" does not exist, skipping
create table test_type_table_invalid (like test_type_table);
insert into test_type_table_invalid values(-1, 1, -1, 1, -1, 1, -1, 1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, '2023', 'a', 'a', 'a');
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
int1 + interval 1 day         | 
uint1                         | 
uint1 + interval 1 day        | 
int2                          | 
int2 + interval 1 day         | 
uint2                         | 
uint2 + interval 1 day        | 
int4                          | 
int4 + interval 1 day         | 
uint4                         | 
uint4 + interval 1 day        | 
int8                          | 
int8 + interval 1 day         | 
uint8                         | 
uint8 + interval 1 day        | 
float4                        | 
float4 + interval 1 day       | 
float8                        | 
float8 + interval 1 day       | 
numeric                       | 
numeric + interval 1 day      | 
date                          | 
date + interval 1 day         | 
time                          | 
time + interval 1 day         | 
time(4)                       | 
time(4) + interval 1 day      | 
datetime                      | 
datetime + interval 1 day     | 
datetime(4)                   | 
datetime(4) + interval 1 day  | 
timestamp                     | 
timestamp + interval 1 day    | 
timestamp(4)                  | 
timestamp(4) + interval 1 day | 
year                          | 
year + interval 1 day         | 
char                          | 
char + interval 1 day         | 
varchar                       | 
varchar + interval 1 day      | 
text                          | 
text + interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 + interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 + interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 + interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 + interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 + interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 + interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric + interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date + interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time + interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) + interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime + interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) + interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp + interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) + interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year + interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char + interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar + interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text + interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
interval 1 day + int1         | 
uint1                         | 
interval 1 day + uint1        | 
int2                          | 
interval 1 day + int2         | 
uint2                         | 
interval 1 day + uint2        | 
int4                          | 
interval 1 day + int4         | 
uint4                         | 
interval 1 day + uint4        | 
int8                          | 
interval 1 day + int8         | 
uint8                         | 
interval 1 day + uint8        | 
float4                        | 
interval 1 day + float4       | 
float8                        | 
interval 1 day + float8       | 
numeric                       | 
interval 1 day + numeric      | 
date                          | 
interval 1 day + date         | 
time                          | 
interval 1 day + time         | 
time(4)                       | 
interval 1 day + time(4)      | 
datetime                      | 
interval 1 day + datetime     | 
datetime(4)                   | 
interval 1 day + datetime(4)  | 
timestamp                     | 
interval 1 day + timestamp    | 
timestamp(4)                  | 
interval 1 day + timestamp(4) | 
year                          | 
interval 1 day + year         | 
char                          | 
interval 1 day + char         | 
varchar                       | 
interval 1 day + varchar      | 
text                          | 
interval 1 day + text         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 interval 1 day + int1         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 interval 1 day + uint1        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 interval 1 day + int2         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 interval 1 day + uint2        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 interval 1 day + int4         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 interval 1 day + uint4        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 interval 1 day + int8         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 interval 1 day + uint8        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 interval 1 day + float4       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 interval 1 day + float8       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 interval 1 day + numeric      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 interval 1 day + date         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 interval 1 day + time         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 interval 1 day + time(4)      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime(4)  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp(4) | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 interval 1 day + year         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 interval 1 day + char         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 interval 1 day + varchar      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 interval 1 day + text         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
int1 - interval 1 day         | 
uint1                         | 
uint1 - interval 1 day        | 
int2                          | 
int2 - interval 1 day         | 
uint2                         | 
uint2 - interval 1 day        | 
int4                          | 
int4 - interval 1 day         | 
uint4                         | 
uint4 - interval 1 day        | 
int8                          | 
int8 - interval 1 day         | 
uint8                         | 
uint8 - interval 1 day        | 
float4                        | 
float4 - interval 1 day       | 
float8                        | 
float8 - interval 1 day       | 
numeric                       | 
numeric - interval 1 day      | 
date                          | 
date - interval 1 day         | 
time                          | 
time - interval 1 day         | 
time(4)                       | 
time(4) - interval 1 day      | 
datetime                      | 
datetime - interval 1 day     | 
datetime(4)                   | 
datetime(4) - interval 1 day  | 
timestamp                     | 
timestamp - interval 1 day    | 
timestamp(4)                  | 
timestamp(4) - interval 1 day | 
year                          | 
year - interval 1 day         | 
char                          | 
char - interval 1 day         | 
varchar                       | 
varchar - interval 1 day      | 
text                          | 
text - interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 - interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 - interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 - interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 - interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 - interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 - interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric - interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date - interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time - interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) - interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime - interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) - interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp - interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) - interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year - interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char - interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar - interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text - interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_zero;
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int1 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint1 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int2 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint2 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int4 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint4 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int8 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint8 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: float4 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: float8 + interval 1 day
WARNING:  Incorrect datetime value: "0.000000"
CONTEXT:  referenced column: numeric + interval 1 day
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_add
SQL function "date_add" statement 1
referenced column: date + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime(4) + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp(4) + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: char + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: varchar + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: text + interval 1 day
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | 0
int1 + interval 1 day         | 
uint1                         | 0
uint1 + interval 1 day        | 
int2                          | 0
int2 + interval 1 day         | 
uint2                         | 0
uint2 + interval 1 day        | 
int4                          | 0
int4 + interval 1 day         | 
uint4                         | 0
uint4 + interval 1 day        | 
int8                          | 0
int8 + interval 1 day         | 
uint8                         | 0
uint8 + interval 1 day        | 
float4                        | 0
float4 + interval 1 day       | 
float8                        | 0
float8 + interval 1 day       | 
numeric                       | 0.000000
numeric + interval 1 day      | 
date                          | 0000-00-00
date + interval 1 day         | 
time                          | 00:00:00
--? time + interval 1 day         | .* 00:00:00
time(4)                       | 00:00:00
--? time(4) + interval 1 day      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
datetime + interval 1 day     | 
datetime(4)                   | 0000-00-00 00:00:00
datetime(4) + interval 1 day  | 
timestamp                     | 0000-00-00 00:00:00-08
timestamp + interval 1 day    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
timestamp(4) + interval 1 day | 
year                          | 0000
year + interval 1 day         | 00
char                          | 0
char + interval 1 day         | 
varchar                       | 0
varchar + interval 1 day      | 
text                          | 0
text + interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 + interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 + interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 + interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 + interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 + interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 + interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric + interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date + interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time + interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) + interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime + interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) + interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp + interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) + interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year + interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char + interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar + interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text + interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_zero;
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int1
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + uint1
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int2
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + uint2
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int4
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + uint4
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int8
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + uint8
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + float4
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + float8
WARNING:  Incorrect datetime value: "0.000000"
CONTEXT:  referenced column: interval 1 day + numeric
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_add
SQL function "date_add" statement 1
referenced column: interval 1 day + date
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + datetime
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + datetime(4)
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + timestamp
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + timestamp(4)
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + char
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + varchar
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + text
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | 0
interval 1 day + int1         | 
uint1                         | 0
interval 1 day + uint1        | 
int2                          | 0
interval 1 day + int2         | 
uint2                         | 0
interval 1 day + uint2        | 
int4                          | 0
interval 1 day + int4         | 
uint4                         | 0
interval 1 day + uint4        | 
int8                          | 0
interval 1 day + int8         | 
uint8                         | 0
interval 1 day + uint8        | 
float4                        | 0
interval 1 day + float4       | 
float8                        | 0
interval 1 day + float8       | 
numeric                       | 0.000000
interval 1 day + numeric      | 
date                          | 0000-00-00
interval 1 day + date         | 
time                          | 00:00:00
--? interval 1 day + time         | .* 00:00:00
time(4)                       | 00:00:00
--? nterval 1 day + time(4)      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
interval 1 day + datetime     | 
datetime(4)                   | 0000-00-00 00:00:00
interval 1 day + datetime(4)  | 
timestamp                     | 0000-00-00 00:00:00-08
interval 1 day + timestamp    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
interval 1 day + timestamp(4) | 
year                          | 0000
interval 1 day + year         | 00
char                          | 0
interval 1 day + char         | 
varchar                       | 0
interval 1 day + varchar      | 
text                          | 0
interval 1 day + text         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 interval 1 day + int1         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 interval 1 day + uint1        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 interval 1 day + int2         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 interval 1 day + uint2        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 interval 1 day + int4         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 interval 1 day + uint4        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 interval 1 day + int8         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 interval 1 day + uint8        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 interval 1 day + float4       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 interval 1 day + float8       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 interval 1 day + numeric      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 interval 1 day + date         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 interval 1 day + time         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 interval 1 day + time(4)      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime(4)  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp(4) | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 interval 1 day + year         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 interval 1 day + char         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 interval 1 day + varchar      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 interval 1 day + text         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_zero;
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int1 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint1 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int2 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint2 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int4 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint4 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int8 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint8 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: float4 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: float8 - interval 1 day
WARNING:  Incorrect datetime value: "0.000000"
CONTEXT:  referenced column: numeric - interval 1 day
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_sub
SQL function "date_sub" statement 1
referenced column: date - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime(4) - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp(4) - interval 1 day
ERROR:  Out of range value for year data type!
CONTEXT:  referenced column: year - interval 1 day
\x
select * from res_tab;
ERROR:  relation "res_tab" does not exist on datanode1
LINE 1: select * from res_tab;
                      ^
\x
desc res_tab;
ERROR:  Table 'test_time_expr.res_tab' doesn't exist.
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_invalid;
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int1 + interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint1 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int2 + interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint2 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int4 + interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint4 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int8 + interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint8 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: float4 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: float8 + interval 1 day
WARNING:  Incorrect datetime value: "-1.000000"
CONTEXT:  referenced column: numeric + interval 1 day
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_add
SQL function "date_add" statement 1
referenced column: date + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime(4) + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp(4) + interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: char + interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: varchar + interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: text + interval 1 day
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | -1
int1 + interval 1 day         | 
uint1                         | 1
uint1 + interval 1 day        | 
int2                          | -1
int2 + interval 1 day         | 
uint2                         | 1
uint2 + interval 1 day        | 
int4                          | -1
int4 + interval 1 day         | 
uint4                         | 1
uint4 + interval 1 day        | 
int8                          | -1
int8 + interval 1 day         | 
uint8                         | 1
uint8 + interval 1 day        | 
float4                        | -1
float4 + interval 1 day       | 
float8                        | -1
float8 + interval 1 day       | 
numeric                       | -1.000000
numeric + interval 1 day      | 
date                          | 0000-00-00
date + interval 1 day         | 
time                          | 00:00:00
--? time + interval 1 day         | .* 00:00:00
time(4)                       | 00:00:00
--? time(4) + interval 1 day      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
datetime + interval 1 day     | 
datetime(4)                   | 0000-00-00 00:00:00
datetime(4) + interval 1 day  | 
timestamp                     | 0000-00-00 00:00:00-08
timestamp + interval 1 day    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
timestamp(4) + interval 1 day | 
year                          | 2023
year + interval 1 day         | 2023
char                          | a
char + interval 1 day         | 
varchar                       | a
varchar + interval 1 day      | 
text                          | a
text + interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 + interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 + interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 + interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 + interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 + interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 + interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric + interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date + interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time + interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) + interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime + interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) + interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp + interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) + interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year + interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char + interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar + interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text + interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_invalid;
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int1
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: interval 1 day + uint1
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int2
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: interval 1 day + uint2
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int4
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: interval 1 day + uint4
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int8
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: interval 1 day + uint8
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + float4
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + float8
WARNING:  Incorrect datetime value: "-1.000000"
CONTEXT:  referenced column: interval 1 day + numeric
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_add
SQL function "date_add" statement 1
referenced column: interval 1 day + date
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + datetime
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + datetime(4)
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + timestamp
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + timestamp(4)
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: interval 1 day + char
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: interval 1 day + varchar
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: interval 1 day + text
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | -1
interval 1 day + int1         | 
uint1                         | 1
interval 1 day + uint1        | 
int2                          | -1
interval 1 day + int2         | 
uint2                         | 1
interval 1 day + uint2        | 
int4                          | -1
interval 1 day + int4         | 
uint4                         | 1
interval 1 day + uint4        | 
int8                          | -1
interval 1 day + int8         | 
uint8                         | 1
interval 1 day + uint8        | 
float4                        | -1
interval 1 day + float4       | 
float8                        | -1
interval 1 day + float8       | 
numeric                       | -1.000000
interval 1 day + numeric      | 
date                          | 0000-00-00
interval 1 day + date         | 
time                          | 00:00:00
--? interval 1 day + time         | .* 00:00:00
time(4)                       | 00:00:00
--? interval 1 day + time(4)      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
interval 1 day + datetime     | 
datetime(4)                   | 0000-00-00 00:00:00
interval 1 day + datetime(4)  | 
timestamp                     | 0000-00-00 00:00:00-08
interval 1 day + timestamp    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
interval 1 day + timestamp(4) | 
year                          | 2023
interval 1 day + year         | 2023
char                          | a
interval 1 day + char         | 
varchar                       | a
interval 1 day + varchar      | 
text                          | a
interval 1 day + text         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 interval 1 day + int1         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 interval 1 day + uint1        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 interval 1 day + int2         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 interval 1 day + uint2        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 interval 1 day + int4         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 interval 1 day + uint4        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 interval 1 day + int8         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 interval 1 day + uint8        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 interval 1 day + float4       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 interval 1 day + float8       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 interval 1 day + numeric      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 interval 1 day + date         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 interval 1 day + time         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 interval 1 day + time(4)      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime(4)  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp(4) | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 interval 1 day + year         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 interval 1 day + char         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 interval 1 day + varchar      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 interval 1 day + text         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_invalid;
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int1 - interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint1 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int2 - interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint2 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int4 - interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint4 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int8 - interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint8 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: float4 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: float8 - interval 1 day
WARNING:  Incorrect datetime value: "-1.000000"
CONTEXT:  referenced column: numeric - interval 1 day
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_sub
SQL function "date_sub" statement 1
referenced column: date - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime(4) - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp(4) - interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: char - interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: varchar - interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: text - interval 1 day
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | -1
int1 - interval 1 day         | 
uint1                         | 1
uint1 - interval 1 day        | 
int2                          | -1
int2 - interval 1 day         | 
uint2                         | 1
uint2 - interval 1 day        | 
int4                          | -1
int4 - interval 1 day         | 
uint4                         | 1
uint4 - interval 1 day        | 
int8                          | -1
int8 - interval 1 day         | 
uint8                         | 1
uint8 - interval 1 day        | 
float4                        | -1
float4 - interval 1 day       | 
float8                        | -1
float8 - interval 1 day       | 
numeric                       | -1.000000
numeric - interval 1 day      | 
date                          | 0000-00-00
date - interval 1 day         | 
time                          | 00:00:00
--? time - interval 1 day         | .* 00:00:00
time(4)                       | 00:00:00
--? time(4) - interval 1 day      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
datetime - interval 1 day     | 
datetime(4)                   | 0000-00-00 00:00:00
datetime(4) - interval 1 day  | 
timestamp                     | 0000-00-00 00:00:00-08
timestamp - interval 1 day    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
timestamp(4) - interval 1 day | 
year                          | 2023
year - interval 1 day         | 2022
char                          | a
char - interval 1 day         | 
varchar                       | a
varchar - interval 1 day      | 
text                          | a
text - interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 - interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 - interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 - interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 - interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 - interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 - interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric - interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date - interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time - interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) - interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime - interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) - interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp - interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) - interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year - interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char - interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar - interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text - interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

reset dolphin.sql_mode;
-- strict mode
set dolphin.sql_mode = 'sql_mode_strict';
drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
int1 + interval 1 day         | 
uint1                         | 
uint1 + interval 1 day        | 
int2                          | 
int2 + interval 1 day         | 
uint2                         | 
uint2 + interval 1 day        | 
int4                          | 
int4 + interval 1 day         | 
uint4                         | 
uint4 + interval 1 day        | 
int8                          | 
int8 + interval 1 day         | 
uint8                         | 
uint8 + interval 1 day        | 
float4                        | 
float4 + interval 1 day       | 
float8                        | 
float8 + interval 1 day       | 
numeric                       | 
numeric + interval 1 day      | 
date                          | 
date + interval 1 day         | 
time                          | 
time + interval 1 day         | 
time(4)                       | 
time(4) + interval 1 day      | 
datetime                      | 
datetime + interval 1 day     | 
datetime(4)                   | 
datetime(4) + interval 1 day  | 
timestamp                     | 
timestamp + interval 1 day    | 
timestamp(4)                  | 
timestamp(4) + interval 1 day | 
year                          | 
year + interval 1 day         | 
char                          | 
char + interval 1 day         | 
varchar                       | 
varchar + interval 1 day      | 
text                          | 
text + interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 + interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 + interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 + interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 + interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 + interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 + interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric + interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date + interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time + interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) + interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime + interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) + interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp + interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) + interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year + interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char + interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar + interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text + interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
interval 1 day + int1         | 
uint1                         | 
interval 1 day + uint1        | 
int2                          | 
interval 1 day + int2         | 
uint2                         | 
interval 1 day + uint2        | 
int4                          | 
interval 1 day + int4         | 
uint4                         | 
interval 1 day + uint4        | 
int8                          | 
interval 1 day + int8         | 
uint8                         | 
interval 1 day + uint8        | 
float4                        | 
interval 1 day + float4       | 
float8                        | 
interval 1 day + float8       | 
numeric                       | 
interval 1 day + numeric      | 
date                          | 
interval 1 day + date         | 
time                          | 
interval 1 day + time         | 
time(4)                       | 
interval 1 day + time(4)      | 
datetime                      | 
interval 1 day + datetime     | 
datetime(4)                   | 
interval 1 day + datetime(4)  | 
timestamp                     | 
interval 1 day + timestamp    | 
timestamp(4)                  | 
interval 1 day + timestamp(4) | 
year                          | 
interval 1 day + year         | 
char                          | 
interval 1 day + char         | 
varchar                       | 
interval 1 day + varchar      | 
text                          | 
interval 1 day + text         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 interval 1 day + int1         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 interval 1 day + uint1        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 interval 1 day + int2         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 interval 1 day + uint2        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 interval 1 day + int4         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 interval 1 day + uint4        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 interval 1 day + int8         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 interval 1 day + uint8        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 interval 1 day + float4       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 interval 1 day + float8       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 interval 1 day + numeric      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 interval 1 day + date         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 interval 1 day + time         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 interval 1 day + time(4)      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime(4)  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp(4) | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 interval 1 day + year         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 interval 1 day + char         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 interval 1 day + varchar      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 interval 1 day + text         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
int1 - interval 1 day         | 
uint1                         | 
uint1 - interval 1 day        | 
int2                          | 
int2 - interval 1 day         | 
uint2                         | 
uint2 - interval 1 day        | 
int4                          | 
int4 - interval 1 day         | 
uint4                         | 
uint4 - interval 1 day        | 
int8                          | 
int8 - interval 1 day         | 
uint8                         | 
uint8 - interval 1 day        | 
float4                        | 
float4 - interval 1 day       | 
float8                        | 
float8 - interval 1 day       | 
numeric                       | 
numeric - interval 1 day      | 
date                          | 
date - interval 1 day         | 
time                          | 
time - interval 1 day         | 
time(4)                       | 
time(4) - interval 1 day      | 
datetime                      | 
datetime - interval 1 day     | 
datetime(4)                   | 
datetime(4) - interval 1 day  | 
timestamp                     | 
timestamp - interval 1 day    | 
timestamp(4)                  | 
timestamp(4) - interval 1 day | 
year                          | 
year - interval 1 day         | 
char                          | 
char - interval 1 day         | 
varchar                       | 
varchar - interval 1 day      | 
text                          | 
text - interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 - interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 - interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 - interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 - interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 - interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 - interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric - interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date - interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time - interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) - interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime - interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) - interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp - interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) - interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year - interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char - interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar - interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text - interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_zero;
ERROR:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int1 + interval 1 day
\x
select * from res_tab;
ERROR:  relation "res_tab" does not exist on datanode1
LINE 1: select * from res_tab;
                      ^
\x
desc res_tab;
ERROR:  Table 'test_time_expr.res_tab' doesn't exist.
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_zero;
ERROR:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int1
\x
select * from res_tab;
ERROR:  relation "res_tab" does not exist on datanode1
LINE 1: select * from res_tab;
                      ^
\x
desc res_tab;
ERROR:  Table 'test_time_expr.res_tab' doesn't exist.
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_zero;
ERROR:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int1 - interval 1 day
\x
select * from res_tab;
ERROR:  relation "res_tab" does not exist on datanode1
LINE 1: select * from res_tab;
                      ^
\x
desc res_tab;
ERROR:  Table 'test_time_expr.res_tab' doesn't exist.
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_invalid;
ERROR:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int1 + interval 1 day
\x
select * from res_tab;
ERROR:  relation "res_tab" does not exist on datanode1
LINE 1: select * from res_tab;
                      ^
\x
desc res_tab;
ERROR:  Table 'test_time_expr.res_tab' doesn't exist.
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_invalid;
ERROR:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int1
\x
select * from res_tab;
ERROR:  relation "res_tab" does not exist on datanode1
LINE 1: select * from res_tab;
                      ^
\x
desc res_tab;
ERROR:  Table 'test_time_expr.res_tab' doesn't exist.
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_invalid;
ERROR:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int1 - interval 1 day
\x
select * from res_tab;
ERROR:  relation "res_tab" does not exist on datanode1
LINE 1: select * from res_tab;
                      ^
\x
desc res_tab;
ERROR:  Table 'test_time_expr.res_tab' doesn't exist.
reset dolphin.sql_mode;
-- test sql_mode NO_ZERO_DATE
set dolphin.sql_mode = 'no_zero_date';
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
int1 + interval 1 day         | 
uint1                         | 
uint1 + interval 1 day        | 
int2                          | 
int2 + interval 1 day         | 
uint2                         | 
uint2 + interval 1 day        | 
int4                          | 
int4 + interval 1 day         | 
uint4                         | 
uint4 + interval 1 day        | 
int8                          | 
int8 + interval 1 day         | 
uint8                         | 
uint8 + interval 1 day        | 
float4                        | 
float4 + interval 1 day       | 
float8                        | 
float8 + interval 1 day       | 
numeric                       | 
numeric + interval 1 day      | 
date                          | 
date + interval 1 day         | 
time                          | 
time + interval 1 day         | 
time(4)                       | 
time(4) + interval 1 day      | 
datetime                      | 
datetime + interval 1 day     | 
datetime(4)                   | 
datetime(4) + interval 1 day  | 
timestamp                     | 
timestamp + interval 1 day    | 
timestamp(4)                  | 
timestamp(4) + interval 1 day | 
year                          | 
year + interval 1 day         | 
char                          | 
char + interval 1 day         | 
varchar                       | 
varchar + interval 1 day      | 
text                          | 
text + interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 + interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 + interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 + interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 + interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 + interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 + interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric + interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date + interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time + interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) + interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime + interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) + interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp + interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) + interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year + interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char + interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar + interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text + interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
interval 1 day + int1         | 
uint1                         | 
interval 1 day + uint1        | 
int2                          | 
interval 1 day + int2         | 
uint2                         | 
interval 1 day + uint2        | 
int4                          | 
interval 1 day + int4         | 
uint4                         | 
interval 1 day + uint4        | 
int8                          | 
interval 1 day + int8         | 
uint8                         | 
interval 1 day + uint8        | 
float4                        | 
interval 1 day + float4       | 
float8                        | 
interval 1 day + float8       | 
numeric                       | 
interval 1 day + numeric      | 
date                          | 
interval 1 day + date         | 
time                          | 
interval 1 day + time         | 
time(4)                       | 
interval 1 day + time(4)      | 
datetime                      | 
interval 1 day + datetime     | 
datetime(4)                   | 
interval 1 day + datetime(4)  | 
timestamp                     | 
interval 1 day + timestamp    | 
timestamp(4)                  | 
interval 1 day + timestamp(4) | 
year                          | 
interval 1 day + year         | 
char                          | 
interval 1 day + char         | 
varchar                       | 
interval 1 day + varchar      | 
text                          | 
interval 1 day + text         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 interval 1 day + int1         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 interval 1 day + uint1        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 interval 1 day + int2         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 interval 1 day + uint2        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 interval 1 day + int4         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 interval 1 day + uint4        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 interval 1 day + int8         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 interval 1 day + uint8        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 interval 1 day + float4       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 interval 1 day + float8       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 interval 1 day + numeric      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 interval 1 day + date         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 interval 1 day + time         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 interval 1 day + time(4)      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime(4)  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp(4) | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 interval 1 day + year         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 interval 1 day + char         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 interval 1 day + varchar      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 interval 1 day + text         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_null;
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-
int1                          | 
int1 - interval 1 day         | 
uint1                         | 
uint1 - interval 1 day        | 
int2                          | 
int2 - interval 1 day         | 
uint2                         | 
uint2 - interval 1 day        | 
int4                          | 
int4 - interval 1 day         | 
uint4                         | 
uint4 - interval 1 day        | 
int8                          | 
int8 - interval 1 day         | 
uint8                         | 
uint8 - interval 1 day        | 
float4                        | 
float4 - interval 1 day       | 
float8                        | 
float8 - interval 1 day       | 
numeric                       | 
numeric - interval 1 day      | 
date                          | 
date - interval 1 day         | 
time                          | 
time - interval 1 day         | 
time(4)                       | 
time(4) - interval 1 day      | 
datetime                      | 
datetime - interval 1 day     | 
datetime(4)                   | 
datetime(4) - interval 1 day  | 
timestamp                     | 
timestamp - interval 1 day    | 
timestamp(4)                  | 
timestamp(4) - interval 1 day | 
year                          | 
year - interval 1 day         | 
char                          | 
char - interval 1 day         | 
varchar                       | 
varchar - interval 1 day      | 
text                          | 
text - interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 - interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 - interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 - interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 - interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 - interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 - interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric - interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date - interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time - interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) - interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime - interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) - interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp - interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) - interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year - interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char - interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar - interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text - interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_zero;
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int1 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint1 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int2 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint2 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int4 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint4 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int8 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint8 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: float4 + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: float8 + interval 1 day
WARNING:  Incorrect datetime value: "0.000000"
CONTEXT:  referenced column: numeric + interval 1 day
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_add
SQL function "date_add" statement 1
referenced column: date + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime(4) + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp(4) + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: char + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: varchar + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: text + interval 1 day
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | 0
int1 + interval 1 day         | 
uint1                         | 0
uint1 + interval 1 day        | 
int2                          | 0
int2 + interval 1 day         | 
uint2                         | 0
uint2 + interval 1 day        | 
int4                          | 0
int4 + interval 1 day         | 
uint4                         | 0
uint4 + interval 1 day        | 
int8                          | 0
int8 + interval 1 day         | 
uint8                         | 0
uint8 + interval 1 day        | 
float4                        | 0
float4 + interval 1 day       | 
float8                        | 0
float8 + interval 1 day       | 
numeric                       | 0.000000
numeric + interval 1 day      | 
date                          | 0000-00-00
date + interval 1 day         | 
time                          | 00:00:00
--? time + interval 1 day         | .* 00:00:00
time(4)                       | 00:00:00
--? time(4) + interval 1 day      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
datetime + interval 1 day     | 
datetime(4)                   | 0000-00-00 00:00:00
datetime(4) + interval 1 day  | 
timestamp                     | 0000-00-00 00:00:00-08
timestamp + interval 1 day    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
timestamp(4) + interval 1 day | 
year                          | 0000
year + interval 1 day         | 00
char                          | 0
char + interval 1 day         | 
varchar                       | 0
varchar + interval 1 day      | 
text                          | 0
text + interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 + interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 + interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 + interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 + interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 + interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 + interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric + interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date + interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time + interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) + interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime + interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) + interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp + interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) + interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year + interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char + interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar + interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text + interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_zero;
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int1
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + uint1
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int2
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + uint2
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int4
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + uint4
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + int8
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + uint8
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + float4
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + float8
WARNING:  Incorrect datetime value: "0.000000"
CONTEXT:  referenced column: interval 1 day + numeric
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_add
SQL function "date_add" statement 1
referenced column: interval 1 day + date
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + datetime
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + datetime(4)
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + timestamp
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + timestamp(4)
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + char
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + varchar
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + text
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | 0
interval 1 day + int1         | 
uint1                         | 0
interval 1 day + uint1        | 
int2                          | 0
interval 1 day + int2         | 
uint2                         | 0
interval 1 day + uint2        | 
int4                          | 0
interval 1 day + int4         | 
uint4                         | 0
interval 1 day + uint4        | 
int8                          | 0
interval 1 day + int8         | 
uint8                         | 0
interval 1 day + uint8        | 
float4                        | 0
interval 1 day + float4       | 
float8                        | 0
interval 1 day + float8       | 
numeric                       | 0.000000
interval 1 day + numeric      | 
date                          | 0000-00-00
interval 1 day + date         | 
time                          | 00:00:00
--? interval 1 day + time         | .* 00:00:00
time(4)                       | 00:00:00
--? interval 1 day + time(4)      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
interval 1 day + datetime     | 
datetime(4)                   | 0000-00-00 00:00:00
interval 1 day + datetime(4)  | 
timestamp                     | 0000-00-00 00:00:00-08
interval 1 day + timestamp    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
interval 1 day + timestamp(4) | 
year                          | 0000
interval 1 day + year         | 00
char                          | 0
interval 1 day + char         | 
varchar                       | 0
interval 1 day + varchar      | 
text                          | 0
interval 1 day + text         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 interval 1 day + int1         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 interval 1 day + uint1        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 interval 1 day + int2         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 interval 1 day + uint2        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 interval 1 day + int4         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 interval 1 day + uint4        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 interval 1 day + int8         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 interval 1 day + uint8        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 interval 1 day + float4       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 interval 1 day + float8       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 interval 1 day + numeric      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 interval 1 day + date         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 interval 1 day + time         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 interval 1 day + time(4)      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime(4)  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp(4) | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 interval 1 day + year         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 interval 1 day + char         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 interval 1 day + varchar      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 interval 1 day + text         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_zero;
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int1 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint1 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int2 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint2 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int4 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint4 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: int8 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: uint8 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: float4 - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: float8 - interval 1 day
WARNING:  Incorrect datetime value: "0.000000"
CONTEXT:  referenced column: numeric - interval 1 day
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_sub
SQL function "date_sub" statement 1
referenced column: date - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime(4) - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp(4) - interval 1 day
ERROR:  Out of range value for year data type!
CONTEXT:  referenced column: year - interval 1 day
\x
select * from res_tab;
ERROR:  relation "res_tab" does not exist on datanode1
LINE 1: select * from res_tab;
                      ^
\x
desc res_tab;
ERROR:  Table 'test_time_expr.res_tab' doesn't exist.
drop table if exists res_tab;
NOTICE:  table "res_tab" does not exist, skipping
create table res_tab as select
`int1` as 'int1', `int1`  + interval 1 day as 'int1 + interval 1 day',
`uint1` as 'uint1', `uint1`  + interval 1 day as 'uint1 + interval 1 day',
`int2` as 'int2', `int2`  + interval 1 day as 'int2 + interval 1 day',
`uint2` as 'uint2', `uint2`  + interval 1 day as 'uint2 + interval 1 day',
`int4` as 'int4', `int4`  + interval 1 day as 'int4 + interval 1 day',
`uint4` as 'uint4', `uint4`  + interval 1 day as 'uint4 + interval 1 day',
`int8` as 'int8', `int8`  + interval 1 day as 'int8 + interval 1 day',
`uint8` as 'uint8', `uint8`  + interval 1 day as 'uint8 + interval 1 day',
`float4` as 'float4', `float4`  + interval 1 day as 'float4 + interval 1 day',
`float8` as 'float8', `float8`  + interval 1 day as 'float8 + interval 1 day',
`numeric` as 'numeric', `numeric`  + interval 1 day as 'numeric + interval 1 day',
`date` as 'date', `date`  + interval 1 day as 'date + interval 1 day',
`time` as 'time', `time`  + interval 1 day as 'time + interval 1 day',
`time(4)` as 'time(4)', `time(4)`  + interval 1 day as 'time(4) + interval 1 day',
`datetime` as 'datetime', `datetime`  + interval 1 day as 'datetime + interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  + interval 1 day as 'datetime(4) + interval 1 day',
`timestamp` as 'timestamp', `timestamp`  + interval 1 day as 'timestamp + interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  + interval 1 day as 'timestamp(4) + interval 1 day',
`year` as 'year', `year`  + interval 1 day as 'year + interval 1 day',
`char` as 'char', `char`  + interval 1 day as 'char + interval 1 day',
`varchar` as 'varchar', `varchar`  + interval 1 day as 'varchar + interval 1 day',
`text` as 'text', `text`  + interval 1 day as 'text + interval 1 day' 
from test_type_table_invalid;
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int1 + interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint1 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int2 + interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint2 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int4 + interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint4 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int8 + interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint8 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: float4 + interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: float8 + interval 1 day
WARNING:  Incorrect datetime value: "-1.000000"
CONTEXT:  referenced column: numeric + interval 1 day
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_add
SQL function "date_add" statement 1
referenced column: date + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime(4) + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp + interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp(4) + interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: char + interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: varchar + interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: text + interval 1 day
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | -1
int1 + interval 1 day         | 
uint1                         | 1
uint1 + interval 1 day        | 
int2                          | -1
int2 + interval 1 day         | 
uint2                         | 1
uint2 + interval 1 day        | 
int4                          | -1
int4 + interval 1 day         | 
uint4                         | 1
uint4 + interval 1 day        | 
int8                          | -1
int8 + interval 1 day         | 
uint8                         | 1
uint8 + interval 1 day        | 
float4                        | -1
float4 + interval 1 day       | 
float8                        | -1
float8 + interval 1 day       | 
numeric                       | -1.000000
numeric + interval 1 day      | 
date                          | 0000-00-00
date + interval 1 day         | 
time                          | 00:00:00
--? time + interval 1 day         | .* 00:00:00
time(4)                       | 00:00:00
--? time(4) + interval 1 day      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
datetime + interval 1 day     | 
datetime(4)                   | 0000-00-00 00:00:00
datetime(4) + interval 1 day  | 
timestamp                     | 0000-00-00 00:00:00-08
timestamp + interval 1 day    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
timestamp(4) + interval 1 day | 
year                          | 2023
year + interval 1 day         | 2023
char                          | a
char + interval 1 day         | 
varchar                       | a
varchar + interval 1 day      | 
text                          | a
text + interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 + interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 + interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 + interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 + interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 + interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 + interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 + interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric + interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date + interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time + interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) + interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime + interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) + interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp + interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) + interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year + interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char + interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar + interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text + interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', interval 1 day + `int1` as 'interval 1 day + int1',
`uint1` as 'uint1', interval 1 day + `uint1` as 'interval 1 day + uint1',
`int2` as 'int2', interval 1 day + `int2` as 'interval 1 day + int2',
`uint2` as 'uint2', interval 1 day + `uint2` as 'interval 1 day + uint2',
`int4` as 'int4', interval 1 day + `int4` as 'interval 1 day + int4',
`uint4` as 'uint4', interval 1 day + `uint4` as 'interval 1 day + uint4',
`int8` as 'int8', interval 1 day + `int8` as 'interval 1 day + int8',
`uint8` as 'uint8', interval 1 day + `uint8` as 'interval 1 day + uint8',
`float4` as 'float4', interval 1 day + `float4` as 'interval 1 day + float4',
`float8` as 'float8', interval 1 day + `float8` as 'interval 1 day + float8',
`numeric` as 'numeric', interval 1 day + `numeric` as 'interval 1 day + numeric',
`date` as 'date', interval 1 day + `date` as 'interval 1 day + date',
`time` as 'time', interval 1 day + `time` as 'interval 1 day + time',
`time(4)` as 'time(4)', interval 1 day + `time(4)` as 'interval 1 day + time(4)',
`datetime` as 'datetime', interval 1 day + `datetime` as 'interval 1 day + datetime',
`datetime(4)` as 'datetime(4)', interval 1 day + `datetime(4)` as 'interval 1 day + datetime(4)',
`timestamp` as 'timestamp', interval 1 day + `timestamp` as 'interval 1 day + timestamp',
`timestamp(4)` as 'timestamp(4)', interval 1 day + `timestamp(4)` as 'interval 1 day + timestamp(4)',
`year` as 'year', interval 1 day + `year` as 'interval 1 day + year',
`char` as 'char', interval 1 day + `char` as 'interval 1 day + char',
`varchar` as 'varchar', interval 1 day + `varchar` as 'interval 1 day + varchar',
`text` as 'text', interval 1 day + `text` as 'interval 1 day + text' 
from test_type_table_invalid;
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int1
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: interval 1 day + uint1
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int2
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: interval 1 day + uint2
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int4
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: interval 1 day + uint4
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + int8
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: interval 1 day + uint8
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + float4
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: interval 1 day + float8
WARNING:  Incorrect datetime value: "-1.000000"
CONTEXT:  referenced column: interval 1 day + numeric
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_add
SQL function "date_add" statement 1
referenced column: interval 1 day + date
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + datetime
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + datetime(4)
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + timestamp
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: interval 1 day + timestamp(4)
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: interval 1 day + char
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: interval 1 day + varchar
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: interval 1 day + text
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | -1
interval 1 day + int1         | 
uint1                         | 1
interval 1 day + uint1        | 
int2                          | -1
interval 1 day + int2         | 
uint2                         | 1
interval 1 day + uint2        | 
int4                          | -1
interval 1 day + int4         | 
uint4                         | 1
interval 1 day + uint4        | 
int8                          | -1
interval 1 day + int8         | 
uint8                         | 1
interval 1 day + uint8        | 
float4                        | -1
interval 1 day + float4       | 
float8                        | -1
interval 1 day + float8       | 
numeric                       | -1.000000
interval 1 day + numeric      | 
date                          | 0000-00-00
interval 1 day + date         | 
time                          | 00:00:00
--? interval 1 day + time         | .* 00:00:00
time(4)                       | 00:00:00
--? interval 1 day + time(4)      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
interval 1 day + datetime     | 
datetime(4)                   | 0000-00-00 00:00:00
interval 1 day + datetime(4)  | 
timestamp                     | 0000-00-00 00:00:00-08
interval 1 day + timestamp    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
interval 1 day + timestamp(4) | 
year                          | 2023
interval 1 day + year         | 2023
char                          | a
interval 1 day + char         | 
varchar                       | a
interval 1 day + varchar      | 
text                          | a
interval 1 day + text         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 interval 1 day + int1         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 interval 1 day + uint1        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 interval 1 day + int2         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 interval 1 day + uint2        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 interval 1 day + int4         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 interval 1 day + uint4        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 interval 1 day + int8         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 interval 1 day + uint8        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 interval 1 day + float4       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 interval 1 day + float8       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 interval 1 day + numeric      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 interval 1 day + date         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 interval 1 day + time         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 interval 1 day + time(4)      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 interval 1 day + datetime(4)  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 interval 1 day + timestamp(4) | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 interval 1 day + year         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 interval 1 day + char         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 interval 1 day + varchar      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 interval 1 day + text         | text                           | YES  |     | NULL    | 
(44 rows)

drop table if exists res_tab;
create table res_tab as select
`int1` as 'int1', `int1`  - interval 1 day as 'int1 - interval 1 day',
`uint1` as 'uint1', `uint1`  - interval 1 day as 'uint1 - interval 1 day',
`int2` as 'int2', `int2`  - interval 1 day as 'int2 - interval 1 day',
`uint2` as 'uint2', `uint2`  - interval 1 day as 'uint2 - interval 1 day',
`int4` as 'int4', `int4`  - interval 1 day as 'int4 - interval 1 day',
`uint4` as 'uint4', `uint4`  - interval 1 day as 'uint4 - interval 1 day',
`int8` as 'int8', `int8`  - interval 1 day as 'int8 - interval 1 day',
`uint8` as 'uint8', `uint8`  - interval 1 day as 'uint8 - interval 1 day',
`float4` as 'float4', `float4`  - interval 1 day as 'float4 - interval 1 day',
`float8` as 'float8', `float8`  - interval 1 day as 'float8 - interval 1 day',
`numeric` as 'numeric', `numeric`  - interval 1 day as 'numeric - interval 1 day',
`date` as 'date', `date`  - interval 1 day as 'date - interval 1 day',
`time` as 'time', `time`  - interval 1 day as 'time - interval 1 day',
`time(4)` as 'time(4)', `time(4)`  - interval 1 day as 'time(4) - interval 1 day',
`datetime` as 'datetime', `datetime`  - interval 1 day as 'datetime - interval 1 day',
`datetime(4)` as 'datetime(4)', `datetime(4)`  - interval 1 day as 'datetime(4) - interval 1 day',
`timestamp` as 'timestamp', `timestamp`  - interval 1 day as 'timestamp - interval 1 day',
`timestamp(4)` as 'timestamp(4)', `timestamp(4)`  - interval 1 day as 'timestamp(4) - interval 1 day',
`year` as 'year', `year`  - interval 1 day as 'year - interval 1 day',
`char` as 'char', `char`  - interval 1 day as 'char - interval 1 day',
`varchar` as 'varchar', `varchar`  - interval 1 day as 'varchar - interval 1 day',
`text` as 'text', `text`  - interval 1 day as 'text - interval 1 day' 
from test_type_table_invalid;
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int1 - interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint1 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int2 - interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint2 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int4 - interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint4 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: int8 - interval 1 day
WARNING:  Incorrect datetime value: "1"
CONTEXT:  referenced column: uint8 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: float4 - interval 1 day
WARNING:  Incorrect datetime value: "-1"
CONTEXT:  referenced column: float8 - interval 1 day
WARNING:  Incorrect datetime value: "-1.000000"
CONTEXT:  referenced column: numeric - interval 1 day
WARNING:  Incorrect datetime value: "0000-00-00"
CONTEXT:  referenced column: date_sub
SQL function "date_sub" statement 1
referenced column: date - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: datetime(4) - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp - interval 1 day
WARNING:  Incorrect datetime value: "0"
CONTEXT:  referenced column: timestamp(4) - interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: char - interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: varchar - interval 1 day
WARNING:  Incorrect datetime value: "a"
CONTEXT:  referenced column: text - interval 1 day
\x
select * from res_tab;
-[ RECORD 1 ]-----------------+-----------------------
int1                          | -1
int1 - interval 1 day         | 
uint1                         | 1
uint1 - interval 1 day        | 
int2                          | -1
int2 - interval 1 day         | 
uint2                         | 1
uint2 - interval 1 day        | 
int4                          | -1
int4 - interval 1 day         | 
uint4                         | 1
uint4 - interval 1 day        | 
int8                          | -1
int8 - interval 1 day         | 
uint8                         | 1
uint8 - interval 1 day        | 
float4                        | -1
float4 - interval 1 day       | 
float8                        | -1
float8 - interval 1 day       | 
numeric                       | -1.000000
numeric - interval 1 day      | 
date                          | 0000-00-00
date - interval 1 day         | 
time                          | 00:00:00
--? time - interval 1 day         | .* 00:00:00
time(4)                       | 00:00:00
--? time(4) - interval 1 day      | .* 00:00:00
datetime                      | 0000-00-00 00:00:00
datetime - interval 1 day     | 
datetime(4)                   | 0000-00-00 00:00:00
datetime(4) - interval 1 day  | 
timestamp                     | 0000-00-00 00:00:00-08
timestamp - interval 1 day    | 
timestamp(4)                  | 0000-00-00 00:00:00-08
timestamp(4) - interval 1 day | 
year                          | 2023
year - interval 1 day         | 2022
char                          | a
char - interval 1 day         | 
varchar                       | a
varchar - interval 1 day      | 
text                          | a
text - interval 1 day         | 

\x
desc res_tab;
             Field             |              Type              | Null | Key | Default | Extra 
-------------------------------+--------------------------------+------+-----+---------+-------
 int1                          | tinyint                        | YES  |     | NULL    | 
 int1 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint1                         | uint1                          | YES  |     | NULL    | 
 uint1 - interval 1 day        | text                           | YES  |     | NULL    | 
 int2                          | smallint                       | YES  |     | NULL    | 
 int2 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint2                         | uint2                          | YES  |     | NULL    | 
 uint2 - interval 1 day        | text                           | YES  |     | NULL    | 
 int4                          | integer                        | YES  |     | NULL    | 
 int4 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint4                         | uint4                          | YES  |     | NULL    | 
 uint4 - interval 1 day        | text                           | YES  |     | NULL    | 
 int8                          | bigint                         | YES  |     | NULL    | 
 int8 - interval 1 day         | text                           | YES  |     | NULL    | 
 uint8                         | uint8                          | YES  |     | NULL    | 
 uint8 - interval 1 day        | text                           | YES  |     | NULL    | 
 float4                        | real                           | YES  |     | NULL    | 
 float4 - interval 1 day       | text                           | YES  |     | NULL    | 
 float8                        | double precision               | YES  |     | NULL    | 
 float8 - interval 1 day       | text                           | YES  |     | NULL    | 
 numeric                       | numeric(20,6)                  | YES  |     | NULL    | 
 numeric - interval 1 day      | text                           | YES  |     | NULL    | 
 date                          | date                           | YES  |     | NULL    | 
 date - interval 1 day         | text                           | YES  |     | NULL    | 
 time                          | time(0) without time zone      | YES  |     | NULL    | 
 time - interval 1 day         | text                           | YES  |     | NULL    | 
 time(4)                       | time(4) without time zone      | YES  |     | NULL    | 
 time(4) - interval 1 day      | text                           | YES  |     | NULL    | 
 datetime                      | timestamp(0) without time zone | YES  |     | NULL    | 
 datetime - interval 1 day     | text                           | YES  |     | NULL    | 
 datetime(4)                   | timestamp(4) without time zone | YES  |     | NULL    | 
 datetime(4) - interval 1 day  | text                           | YES  |     | NULL    | 
 timestamp                     | timestamp(0) with time zone    | YES  |     | NULL    | 
 timestamp - interval 1 day    | text                           | YES  |     | NULL    | 
 timestamp(4)                  | timestamp(4) with time zone    | YES  |     | NULL    | 
 timestamp(4) - interval 1 day | text                           | YES  |     | NULL    | 
 year                          | year                           | YES  |     | NULL    | 
 year - interval 1 day         | year                           | YES  |     | NULL    | 
 char                          | character(100)                 | YES  |     | NULL    | 
 char - interval 1 day         | text                           | YES  |     | NULL    | 
 varchar                       | character varying(100)         | YES  |     | NULL    | 
 varchar - interval 1 day      | text                           | YES  |     | NULL    | 
 text                          | text                           | YES  |     | NULL    | 
 text - interval 1 day         | text                           | YES  |     | NULL    | 
(44 rows)

reset dolphin.sql_mode;
drop table if exists res_tab;
drop view if exists res_view;
drop table if exists test_type_table_null cascade;
drop table if exists test_type_table_zero cascade;
drop table if exists test_type_table_invalid cascade;
drop table if exists test_type_table cascade;
-- end test for 'bit_expr Â± interval expr unit'
reset dolphin.b_compatibility_mode;
drop schema test_time_expr cascade;
reset current_schema;
alter system set upgrade_mode to 0;
