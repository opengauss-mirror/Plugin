create schema db_b_plpgsql_test;
set current_schema to 'db_b_plpgsql_test';
create table tb_b_grammar_0038(a text(10)) engine = è¡¨1;
create or replace procedure proc_01()
as
begin
insert tb_b_grammar_0038 values('tom') ;
end;
/
create or replace procedure PEOC_165()
as
begin
CREATE TABLE t1 (a binary) engine INNODB;
end;
/
CREATE TABLE J1_TBL (
i integer,
j integer,
t text
);
CREATE TABLE J2_TBL (
i integer,
k integer
);
INSERT INTO J1_TBL VALUES (1, 4, 'one');
INSERT INTO J1_TBL VALUES (2, 3, 'two');
INSERT INTO J1_TBL VALUES (0, NULL, 'zero');
INSERT INTO J2_TBL VALUES (1, -1);
INSERT INTO J2_TBL VALUES (NULL, 0);
create or replace procedure PEOC_165()
as
begin
SELECT '' AS "xxx", * FROM J1_TBL JOIN J2_TBL;
end;
/
SELECT * from proc_01();
 proc_01 
---------
 
(1 row)

SELECT * from tb_b_grammar_0038;
  a  
-----
 tom
(1 row)

-- test "set"
create procedure proc1(x int) as
v int;
begin
set x=x+1;
set v=x+1;
raise notice '%',v;
end;
/
call proc1(1);
NOTICE:  3
 proc1 
-------
 
(1 row)

call proc1(2);
NOTICE:  4
 proc1 
-------
 
(1 row)

drop procedure proc1;
declare
i int;
begin
set j=1;
raise notice '%',j;
end;
/
ERROR:  unrecognized configuration parameter "j"
CONTEXT:  SQL statement "set j=1"
PL/pgSQL function inline_code_block line 4 at SQL statement
declare
i int;
begin
set j=1;
raise notice '%',j;
end;
/
ERROR:  unrecognized configuration parameter "j"
CONTEXT:  SQL statement "set j=1"
PL/pgSQL function inline_code_block line 4 at SQL statement
begin
set enable_set_variable_b_format = on;
end;
/
show enable_set_variable_b_format;
 enable_set_variable_b_format 
------------------------------
 on
(1 row)

begin
set @i=0;
end;
/
select @i;
 @i 
----
  0
(1 row)

reset enable_set_variable_b_format;
drop schema db_b_plpgsql_test cascade;
NOTICE:  drop cascades to 5 other objects
DETAIL:  drop cascades to table tb_b_grammar_0038
drop cascades to function proc_01()
drop cascades to table j1_tbl
drop cascades to table j2_tbl
drop cascades to function peoc_165()
reset current_schema;
