create schema date_add_time_interval;
set current_schema = date_add_time_interval;
set dolphin.cmpt_version = '5.7';
select date_add(time'838:59:59', interval -1 day);
 date_add  
-----------
 814:59:59
(1 row)

select date_sub(time'838:59:59', interval 1 day);
 date_sub  
-----------
 814:59:59
(1 row)

select date_add(time'838:59:59', interval 1 day);
WARNING:  time field value out of range
CONTEXT:  referenced column: date_add
 date_add 
----------
 
(1 row)

select date_sub(time'838:59:59', interval -1 day);
WARNING:  time field value out of range
CONTEXT:  referenced column: date_sub
 date_sub 
----------
 
(1 row)

select date_add(time'838:59:59', interval -1 month);
WARNING:  time field value out of range
CONTEXT:  referenced column: date_add
 date_add 
----------
 
(1 row)

select date_sub(time'838:59:59', interval 1 month);
WARNING:  time field value out of range
CONTEXT:  referenced column: date_sub
 date_sub 
----------
 
(1 row)

select date_add(time'838:59:59', interval -1 year);
WARNING:  time field value out of range
CONTEXT:  referenced column: date_add
 date_add 
----------
 
(1 row)

select date_sub(time'838:59:59', interval 1 year);
WARNING:  time field value out of range
CONTEXT:  referenced column: date_sub
 date_sub 
----------
 
(1 row)

SELECT SUBDATE(time'23:59:59.9', '3 years 2 mons 5 days 14:25:26');
WARNING:  invalid input syntax for type bigint: "3 years 2 mons 5 days 14:25:26"
LINE 1: SELECT SUBDATE(time'23:59:59.9', '3 years 2 mons 5 days 14:2...
                                         ^
CONTEXT:  referenced column: subdate
   subdate   
-------------
 -48:00:00.1
(1 row)

SELECT SUBDATE(time'23:59:59','08:00:2b:01:02:03');
WARNING:  invalid input syntax for type bigint: "08:00:2b:01:02:03"
LINE 1: SELECT SUBDATE(time'23:59:59','08:00:2b:01:02:03');
                                      ^
CONTEXT:  referenced column: subdate
  subdate   
------------
 -168:00:01
(1 row)

SELECT SUBDATE(time'838:59:59.9', '3 years 2 mons 5 days 14:25:26');
WARNING:  invalid input syntax for type bigint: "3 years 2 mons 5 days 14:25:26"
LINE 1: SELECT SUBDATE(time'838:59:59.9', '3 years 2 mons 5 days 14:...
                                          ^
CONTEXT:  referenced column: subdate
ERROR:  truncated incorrect time value: "838:59:59.9"
CONTEXT:  referenced column: subdate
SELECT SUBDATE(time'838:59:59','08:00:2b:01:02:03');
WARNING:  invalid input syntax for type bigint: "08:00:2b:01:02:03"
LINE 1: SELECT SUBDATE(time'838:59:59','08:00:2b:01:02:03');
                                       ^
CONTEXT:  referenced column: subdate
  subdate  
-----------
 646:59:59
(1 row)

SELECT ADDDATE(time'23:59:59.9', '3 years 2 mons 5 days 14:25:26');
WARNING:  invalid input syntax for type bigint: "3 years 2 mons 5 days 14:25:26"
LINE 1: SELECT ADDDATE(time'23:59:59.9', '3 years 2 mons 5 days 14:2...
                                         ^
CONTEXT:  referenced column: adddate
  adddate   
------------
 95:59:59.9
(1 row)

SELECT ADDDATE(time'23:59:59','08:00:2b:01:02:03');
WARNING:  invalid input syntax for type bigint: "08:00:2b:01:02:03"
LINE 1: SELECT ADDDATE(time'23:59:59','08:00:2b:01:02:03');
                                      ^
CONTEXT:  referenced column: adddate
  adddate  
-----------
 215:59:59
(1 row)

SELECT ADDDATE(time'838:59:59.9', '3 years 2 mons 5 days 14:25:26');
WARNING:  invalid input syntax for type bigint: "3 years 2 mons 5 days 14:25:26"
LINE 1: SELECT ADDDATE(time'838:59:59.9', '3 years 2 mons 5 days 14:...
                                          ^
CONTEXT:  referenced column: adddate
ERROR:  truncated incorrect time value: "838:59:59.9"
CONTEXT:  referenced column: adddate
SELECT ADDDATE(time'838:59:59','08:00:2b:01:02:03');
WARNING:  invalid input syntax for type bigint: "08:00:2b:01:02:03"
LINE 1: SELECT ADDDATE(time'838:59:59','08:00:2b:01:02:03');
                                       ^
CONTEXT:  referenced column: adddate
WARNING:  time field value out of range
CONTEXT:  referenced column: adddate
 adddate 
---------
 
(1 row)

set dolphin.cmpt_version = '8.0';
select date_add(time'838:59:59', interval -1 day);
      date_add       
---------------------
--?.*
(1 row)

select date_sub(time'838:59:59', interval 1 day);
      date_sub       
---------------------
--?.*
(1 row)

select date_add(time'838:59:59', interval 1 day);
      date_add       
---------------------
--?.*
(1 row)

select date_sub(time'838:59:59', interval -1 day);
      date_sub       
---------------------
--?.*
(1 row)

select date_add(time'838:59:59', interval -1 month);
      date_add       
---------------------
--?.*
(1 row)

select date_sub(time'838:59:59', interval 1 month);
      date_sub       
---------------------
--?.*
(1 row)

select date_add(time'838:59:59', interval -1 year);
      date_add       
---------------------
--?.*
(1 row)

select date_sub(time'838:59:59', interval 1 year);
      date_sub       
---------------------
--?.*
(1 row)

SELECT SUBDATE(time'23:59:59.9', '3 years 2 mons 5 days 14:25:26');
WARNING:  invalid input syntax for type bigint: "3 years 2 mons 5 days 14:25:26"
LINE 1: SELECT SUBDATE(time'23:59:59.9', '3 years 2 mons 5 days 14:2...
                                         ^
CONTEXT:  referenced column: subdate
        subdate        
-----------------------
--?.*
(1 row)

SELECT SUBDATE(time'23:59:59','08:00:2b:01:02:03');
WARNING:  invalid input syntax for type bigint: "08:00:2b:01:02:03"
LINE 1: SELECT SUBDATE(time'23:59:59','08:00:2b:01:02:03');
                                      ^
CONTEXT:  referenced column: subdate
       subdate       
---------------------
--?.*
(1 row)

SELECT SUBDATE(time'838:59:59.9', '3 years 2 mons 5 days 14:25:26');
WARNING:  invalid input syntax for type bigint: "3 years 2 mons 5 days 14:25:26"
LINE 1: SELECT SUBDATE(time'838:59:59.9', '3 years 2 mons 5 days 14:...
                                          ^
CONTEXT:  referenced column: subdate
ERROR:  truncated incorrect time value: "838:59:59.9"
CONTEXT:  referenced column: subdate
SELECT SUBDATE(time'838:59:59','08:00:2b:01:02:03');
WARNING:  invalid input syntax for type bigint: "08:00:2b:01:02:03"
LINE 1: SELECT SUBDATE(time'838:59:59','08:00:2b:01:02:03');
                                       ^
CONTEXT:  referenced column: subdate
       subdate       
---------------------
--?.*
(1 row)

SELECT ADDDATE(time'23:59:59.9', '3 years 2 mons 5 days 14:25:26');
WARNING:  invalid input syntax for type bigint: "3 years 2 mons 5 days 14:25:26"
LINE 1: SELECT ADDDATE(time'23:59:59.9', '3 years 2 mons 5 days 14:2...
                                         ^
CONTEXT:  referenced column: adddate
        adddate        
-----------------------
--?.*
(1 row)

SELECT ADDDATE(time'23:59:59','08:00:2b:01:02:03');
WARNING:  invalid input syntax for type bigint: "08:00:2b:01:02:03"
LINE 1: SELECT ADDDATE(time'23:59:59','08:00:2b:01:02:03');
                                      ^
CONTEXT:  referenced column: adddate
       adddate       
---------------------
--?.*
(1 row)

SELECT ADDDATE(time'838:59:59.9', '3 years 2 mons 5 days 14:25:26');
WARNING:  invalid input syntax for type bigint: "3 years 2 mons 5 days 14:25:26"
LINE 1: SELECT ADDDATE(time'838:59:59.9', '3 years 2 mons 5 days 14:...
                                          ^
CONTEXT:  referenced column: adddate
ERROR:  truncated incorrect time value: "838:59:59.9"
CONTEXT:  referenced column: adddate
SELECT ADDDATE(time'838:59:59','08:00:2b:01:02:03');
WARNING:  invalid input syntax for type bigint: "08:00:2b:01:02:03"
LINE 1: SELECT ADDDATE(time'838:59:59','08:00:2b:01:02:03');
                                       ^
CONTEXT:  referenced column: adddate
       adddate       
---------------------
--?.*
(1 row)

create table test1(c1 date);
create table x1 as select * from test1 where c1 >= date_sub(curdate(), interval 3 month);
create table x2 as select * from test1 where c1 >= date_add(curdate(), interval 3 month);
drop table test1;
drop table x1;
drop table x2;
create table testdate_add(d time);
insert into testdate_add(d) values('2022-12-31 22:12:20');
select * from testdate_add;
    d     
----------
 22:12:20
(1 row)

set dolphin.cmpt_version = '5.7';
select date_add(d,INTERVAL 2 DAY_MINUTE) from testdate_add;
 date_add 
----------
 22:14:20
(1 row)

select date_sub(d,INTERVAL 2 DAY_HOUR) from testdate_add;
 date_sub 
----------
 20:12:20
(1 row)

select date_sub(date_add(d,INTERVAL 2 DAY_MINUTE),INTERVAL 2 DAY_HOUR) from testdate_add;
 date_sub 
----------
 20:14:20
(1 row)

select date_add(date_sub(d,INTERVAL 2 DAY_MINUTE),INTERVAL 2 DAY_HOUR) from testdate_add;
 date_add 
----------
 24:10:20
(1 row)

set dolphin.cmpt_version = '8.0';
select date_add(d,INTERVAL 2 DAY_MINUTE) from testdate_add;
      date_add       
---------------------
--?.*
(1 row)

select date_sub(d,INTERVAL 2 DAY_HOUR) from testdate_add;
      date_sub       
---------------------
--?.*
(1 row)

select date_sub(date_add(d,INTERVAL 2 DAY_MINUTE),INTERVAL 2 DAY_HOUR) from testdate_add;
      date_sub       
---------------------
--?.*
(1 row)

select date_add(date_sub(d,INTERVAL 2 DAY_MINUTE),INTERVAL 2 DAY_HOUR) from testdate_add;
      date_add       
---------------------
--?.*
(1 row)

drop table testdate_add;
reset dolphin.cmpt_version;
reset current_schema;
drop schema date_add_time_interval;
