create schema test_dml_func;
set current_schema to 'test_dml_func';
create table test_type_table
(
   `int1` tinyint,
   `uint1` tinyint unsigned,
   `int2` smallint,
   `uint2` smallint unsigned,
   `int4` integer,
   `uint4` integer unsigned,
   `int8` bigint,
   `uint8` bigint unsigned,
   `float4` float4,
   `float8` float8,
   `numeric` decimal(20, 6),
   `bit1` bit(1),
   `bit64` bit(64),
   `boolean` boolean,
   `date` date,
   `time` time,
   `time(4)` time(4),
   `datetime` datetime,
   `datetime(4)` datetime(4) default '2022-11-11 11:11:11',
   `timestamp` timestamp,
   `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
   `year` year,
   `char` char(100),
   `varchar` varchar(100), 
   `binary` binary(100),
   `varbinary` varbinary(100),
   `tinyblob` tinyblob,
   `blob` blob,
   `mediumblob` mediumblob,
   `longblob` longblob,
   `text` text,
   `enum_t` enum('a', 'b', 'c'),
   `set_t` set('a', 'b', 'c'),
   `json` json   
);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_set_t_set" for column "test_type_table.set_t"
create table test_type_table_ustore
(
   `int1` tinyint,
   `uint1` tinyint unsigned,
   `int2` smallint,
   `uint2` smallint unsigned,
   `int4` integer,
   `uint4` integer unsigned,
   `int8` bigint,
   `uint8` bigint unsigned,
   `float4` float4,
   `float8` float8,
   `numeric` decimal(20, 6),
   `bit1` bit(1),
   `bit64` bit(64),
   `boolean` boolean,
   `date` date,
   `time` time,
   `time(4)` time(4),
   `datetime` datetime,
   `datetime(4)` datetime(4) default '2022-11-11 11:11:11',
   `timestamp` timestamp,
   `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
   `year` year,
   `char` char(100),
   `varchar` varchar(100), 
   `binary` binary(100),
   `varbinary` varbinary(100),
   `tinyblob` tinyblob,
   `blob` blob,
   `mediumblob` mediumblob,
   `longblob` longblob,
   `text` text,
   `enum_t` enum('a', 'b', 'c'),
   `set_t` set('a', 'b', 'c'),
   `json` json   
) with (storage_type = ustore);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_ustore_set_t_set" for column "test_type_table_ustore.set_t"
create table test_type_table_partition
(
   `int1` tinyint,
   `uint1` tinyint unsigned,
   `int2` smallint,
   `uint2` smallint unsigned,
   `int4` integer,
   `uint4` integer unsigned,
   `int8` bigint,
   `uint8` bigint unsigned,
   `float4` float4,
   `float8` float8,
   `numeric` decimal(20, 6),
   `bit1` bit(1),
   `bit64` bit(64),
   `boolean` boolean,
   `date` date,
   `time` time,
   `time(4)` time(4),
   `datetime` datetime,
   `datetime(4)` datetime(4) default '2022-11-11 11:11:11',
   `timestamp` timestamp,
   `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
   `year` year,
   `char` char(100),
   `varchar` varchar(100), 
   `binary` binary(100),
   `varbinary` varbinary(100),
   `tinyblob` tinyblob,
   `blob` blob,
   `mediumblob` mediumblob,
   `longblob` longblob,
   `text` text,
   `enum_t` enum('a', 'b', 'c'),
   `set_t` set('a', 'b', 'c'),
   `json` json   
) PARTITION BY RANGE(`int4`)
(
    PARTITION P1 VALUES LESS THAN(1),
    PARTITION P2 VALUES LESS THAN(2),
    PARTITION P3 VALUES LESS THAN(3),
    PARTITION P4 VALUES LESS THAN(MAXVALUE)
);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_partition_set_t_set" for column "test_type_table_partition.set_t"
create table test_type_table_second_partition
(
   `int1` tinyint,
   `uint1` tinyint unsigned,
   `int2` smallint,
   `uint2` smallint unsigned,
   `int4` integer,
   `uint4` integer unsigned,
   `int8` bigint,
   `uint8` bigint unsigned,
   `float4` float4,
   `float8` float8,
   `numeric` decimal(20, 6),
   `bit1` bit(1),
   `bit64` bit(64),
   `boolean` boolean,
   `date` date,
   `time` time,
   `time(4)` time(4),
   `datetime` datetime,
   `datetime(4)` datetime(4) default '2022-11-11 11:11:11',
   `timestamp` timestamp,
   `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
   `year` year,
   `char` char(100),
   `varchar` varchar(100), 
   `binary` binary(100),
   `varbinary` varbinary(100),
   `tinyblob` tinyblob,
   `blob` blob,
   `mediumblob` mediumblob,
   `longblob` longblob,
   `text` text,
   `enum_t` enum('a', 'b', 'c'),
   `set_t` set('a', 'b', 'c'),
   `json` json   
) PARTITION BY RANGE(`int4`) SUBPARTITION BY hash(`int1`)
(
    PARTITION P1 VALUES LESS THAN(1)
    (
        SUBPARTITION p0_0,
        SUBPARTITION p0_1,
        SUBPARTITION p0_2
    ),
    PARTITION P2 VALUES LESS THAN(2)
    (
        SUBPARTITION p1_0,
        SUBPARTITION p1_1,
        SUBPARTITION p1_2
    ),
    PARTITION P3 VALUES LESS THAN(3)
    (
        SUBPARTITION p2_0,
        SUBPARTITION p2_1,
        SUBPARTITION p2_2
    ),
    PARTITION P4 VALUES LESS THAN(MAXVALUE)
    (
        SUBPARTITION p3_0,
        SUBPARTITION p3_1,
        SUBPARTITION p3_2
    )
);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_second_partition_set_t_set" for column "test_type_table_second_partition.set_t"
create temporary table test_type_table_temporary
(
   `int1` tinyint,
   `uint1` tinyint unsigned,
   `int2` smallint,
   `uint2` smallint unsigned,
   `int4` integer,
   `uint4` integer unsigned,
   `int8` bigint,
   `uint8` bigint unsigned,
   `float4` float4,
   `float8` float8,
   `numeric` decimal(20, 6),
   `bit1` bit(1),
   `bit64` bit(64),
   `boolean` boolean,
   `date` date,
   `time` time,
   `time(4)` time(4),
   `datetime` datetime,
   `datetime(4)` datetime(4) default '2022-11-11 11:11:11',
   `timestamp` timestamp,
   `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
   `year` year,
   `char` char(100),
   `varchar` varchar(100), 
   `binary` binary(100),
   `varbinary` varbinary(100),
   `tinyblob` tinyblob,
   `blob` blob,
   `mediumblob` mediumblob,
   `longblob` longblob,
   `text` text,
   `enum_t` enum('a', 'b', 'c'),
   `set_t` set('a', 'b', 'c'),
   `json` json   
);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_temporary_set_t_set" for column "test_type_table_temporary.set_t"
create UNLOGGED  table test_type_table_unlogged
(
   `int1` tinyint,
   `uint1` tinyint unsigned,
   `int2` smallint,
   `uint2` smallint unsigned,
   `int4` integer,
   `uint4` integer unsigned,
   `int8` bigint,
   `uint8` bigint unsigned,
   `float4` float4,
   `float8` float8,
   `numeric` decimal(20, 6),
   `bit1` bit(1),
   `bit64` bit(64),
   `boolean` boolean,
   `date` date,
   `time` time,
   `time(4)` time(4),
   `datetime` datetime,
   `datetime(4)` datetime(4) default '2022-11-11 11:11:11',
   `timestamp` timestamp,
   `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
   `year` year,
   `char` char(100),
   `varchar` varchar(100), 
   `binary` binary(100),
   `varbinary` varbinary(100),
   `tinyblob` tinyblob,
   `blob` blob,
   `mediumblob` mediumblob,
   `longblob` longblob,
   `text` text,
   `enum_t` enum('a', 'b', 'c'),
   `set_t` set('a', 'b', 'c'),
   `json` json   
);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_unlogged_set_t_set" for column "test_type_table_unlogged.set_t"
create table test_type_table_segment
(
   `int1` tinyint,
   `uint1` tinyint unsigned,
   `int2` smallint,
   `uint2` smallint unsigned,
   `int4` integer,
   `uint4` integer unsigned,
   `int8` bigint,
   `uint8` bigint unsigned,
   `float4` float4,
   `float8` float8,
   `numeric` decimal(20, 6),
   `bit1` bit(1),
   `bit64` bit(64),
   `boolean` boolean,
   `date` date,
   `time` time,
   `time(4)` time(4),
   `datetime` datetime,
   `datetime(4)` datetime(4) default '2022-11-11 11:11:11',
   `timestamp` timestamp,
   `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
   `year` year,
   `char` char(100),
   `varchar` varchar(100), 
   `binary` binary(100),
   `varbinary` varbinary(100),
   `tinyblob` tinyblob,
   `blob` blob,
   `mediumblob` mediumblob,
   `longblob` longblob,
   `text` text,
   `enum_t` enum('a', 'b', 'c'),
   `set_t` set('a', 'b', 'c'),
   `json` json   
) with(segment = on);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_segment_set_t_set" for column "test_type_table_segment.set_t"
insert into test_type_table values (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, b'1', b'111', true, '2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456',
'2023', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', 'a', 'a,c', json_object('a', 1, 'b', 2));
insert into test_type_table_ustore values (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, b'1', b'111', true, '2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456',
'2023', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', 'a', 'a,c', json_object('a', 1, 'b', 2));
insert into test_type_table_partition values (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, b'1', b'111', true, '2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456',
'2023', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', 'a', 'a,c', json_object('a', 1, 'b', 2));
insert into test_type_table_second_partition values (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, b'1', b'111', true, '2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456',
'2023', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', 'a', 'a,c', json_object('a', 1, 'b', 2));
insert into test_type_table_temporary values (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, b'1', b'111', true, '2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456',
'2023', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', 'a', 'a,c', json_object('a', 1, 'b', 2));
insert into test_type_table_unlogged values (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, b'1', b'111', true, '2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456',
'2023', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', 'a', 'a,c', json_object('a', 1, 'b', 2));
insert into test_type_table_segment values (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, b'1', b'111', true, '2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456',
'2023', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', 'a', 'a,c', json_object('a', 1, 'b', 2));
-- select (subquery) from tbl_name
select (select t1.`int4`) from test_type_table t1;
 int4 
------
    1
(1 row)

select (select sum(`int1` + `int4`)) from test_type_table;
 sum 
-----
   2
(1 row)

select (select `int4` from test_type_table t1 where t1.`int4` = t2.`int4`) from test_type_table t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table t2;
 int4 
------
    1
(1 row)

select (select `int4` from (select * from test_type_table) t1 where t1.`int4` = t2.`int4`) from test_type_table t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table t1 where t1.`int4` in (select t2.`int4`)) from test_type_table t2;
 int4 
------
    1
(1 row)

create view v1 as select (select `int4` from test_type_table t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table t2;
select * from v1;
 int4 
------
    1
(1 row)

select (select t1.`int4`) from test_type_table_ustore t1;
 int4 
------
    1
(1 row)

select (select sum(`int1` + `int4`)) from test_type_table_ustore;
 sum 
-----
   2
(1 row)

select (select `int4` from test_type_table_ustore t1 where t1.`int4` = t2.`int4`) from test_type_table_ustore t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table_ustore t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table_ustore t2;
 int4 
------
    1
(1 row)

select (select `int4` from (select * from test_type_table_ustore) t1 where t1.`int4` = t2.`int4`) from test_type_table_ustore t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table_ustore t1 where t1.`int4` in (select t2.`int4`)) from test_type_table_ustore t2;
 int4 
------
    1
(1 row)

create view v2 as select (select `int4` from test_type_table_ustore t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table_ustore t2;
select * from v2;
 int4 
------
    1
(1 row)

select (select t1.`int4`) from test_type_table_partition t1;
 int4 
------
    1
(1 row)

select (select sum(`int1` + `int4`)) from test_type_table_second_partition;
 sum 
-----
   2
(1 row)

select (select `int4` from test_type_table_second_partition t1 where t1.`int4` = t2.`int4`) from test_type_table_partition t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table_second_partition t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table_partition t2;
 int4 
------
    1
(1 row)

select (select `int4` from (select * from test_type_table_partition) t1 where t1.`int4` = t2.`int4`) from test_type_table t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table_partition t1 where t1.`int4` in (select t2.`int4`)) from test_type_table_second_partition t2;
 int4 
------
    1
(1 row)

create view v3 as select (select `int4` from test_type_table_partition t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table_second_partition t2;
select * from v3;
 int4 
------
    1
(1 row)

select (select t1.`int4`) from test_type_table_temporary t1;
 int4 
------
    1
(1 row)

select (select sum(`int1` + `int4`)) from test_type_table_unlogged;
 sum 
-----
   2
(1 row)

select (select `int4` from test_type_table_unlogged t1 where t1.`int4` = t2.`int4`) from test_type_table_temporary t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table_temporary t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table_unlogged t2;
 int4 
------
    1
(1 row)

select (select `int4` from (select * from test_type_table_unlogged) t1 where t1.`int4` = t2.`int4`) from test_type_table_temporary t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table_temporary t1 where t1.`int4` in (select t2.`int4`)) from test_type_table_unlogged t2;
 int4 
------
    1
(1 row)

create view v4 as select (select `int4` from test_type_table_temporary t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table_unlogged t2;
NOTICE:  view "v4" will be a temporary view
select * from v4;
 int4 
------
    1
(1 row)

select (select t1.`int4`) from test_type_table_segment t1;
 int4 
------
    1
(1 row)

select (select sum(`int1` + `int4`)) from test_type_table_segment;
 sum 
-----
   2
(1 row)

select (select `int4` from test_type_table_segment t1 where t1.`int4` = t2.`int4`) from test_type_table_segment t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table_segment t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table_segment t2;
 int4 
------
    1
(1 row)

select (select `int4` from (select * from test_type_table_segment) t1 where t1.`int4` = t2.`int4`) from test_type_table_segment t2;
 int4 
------
    1
(1 row)

select (select `int4` from test_type_table_segment t1 where t1.`int4` in (select t2.`int4`)) from test_type_table_segment t2;
 int4 
------
    1
(1 row)

create view v5 as select (select `int4` from test_type_table_segment t1 where t1.`int4` = t2.`int4` order by t2.`int4`) from test_type_table_segment t2;
select * from v5;
 int4 
------
    1
(1 row)

set enable_opfusion=on;
explain select (select t1.`int4`) from test_type_table t1;
                             QUERY PLAN                             
--------------------------------------------------------------------
 Seq Scan on test_type_table t1  (cost=0.00..11.50 rows=75 width=4)
   SubPlan 1
     ->  Result  (cost=0.00..0.01 rows=1 width=0)
(3 rows)

reset enable_opfusion;
-- non_subquery_operand LIKE (subquery)
select * from test_type_table where `text` like (select '1%') union all select * from test_type_table where `int4` like (select '1%'); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(2 rows)

select * from test_type_table where `text` like (select `text` from test_type_table) union all select * from test_type_table where `int4` like (select `int4` from test_type_table); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(2 rows)

select * from test_type_table where `text` like (select `int1` from test_type_table) union all select * from test_type_table where `text` like (select `int4` from test_type_table); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table where `date` like (select '2023-%');
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table where `text` like (select upper(`text`) from test_type_table);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table where `text` like (select concat(`text`, '%') from test_type_table);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table where `text` like (select concat(`text`, 'a%') from test_type_table);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table where `timestamp` like (select '2023-%');
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table where `date` like (select '2023-%' union all select '2023-%');
ERROR:  more than one row returned by a subquery used as an expression
select * from test_type_table_ustore where `text` like (select '1%') union all select * from test_type_table_ustore where `int4` like (select '1%'); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(2 rows)

select * from test_type_table_ustore where `text` like (select `text` from test_type_table_ustore) union all select * from test_type_table_ustore where `int4` like (select `int4` from test_type_table_ustore); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(2 rows)

select * from test_type_table_ustore where `text` like (select `int1` from test_type_table_ustore) union all select * from test_type_table_ustore where `text` like (select `int4` from test_type_table_ustore); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_ustore where `date` like (select '2023-%');
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_ustore where `text` like (select upper(`text`) from test_type_table_ustore);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_ustore where `text` like (select concat(`text`, '%') from test_type_table_ustore);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_ustore where `text` like (select concat(`text`, 'a%') from test_type_table_ustore);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_ustore where `timestamp` like (select '2023-%');
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_ustore where `date` like (select '2023-%' union all select '2023-%');
ERROR:  more than one row returned by a subquery used as an expression
select * from test_type_table_partition where `text` like (select '1%') union all select * from test_type_table_second_partition where `int4` like (select '1%'); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(2 rows)

select * from test_type_table_second_partition where `text` like (select `text` from test_type_table_partition) union all select * from test_type_table_second_partition where `int4` like (select `int4` from test_type_table); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(2 rows)

select * from test_type_table where `text` like (select `int1` from test_type_table_second_partition) union all select * from test_type_table where `text` like (select `int4` from test_type_table); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_second_partition where `date` like (select '2023-%');
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_partition where `text` like (select upper(`text`) from test_type_table);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_second_partition where `text` like (select concat(`text`, '%') from test_type_table_partition);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_second_partition where `text` like (select concat(`text`, 'a%') from test_type_table);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_partition where `timestamp` like (select '2023-%');
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_second_partition where `date` like (select '2023-%' union all select '2023-%');
ERROR:  more than one row returned by a subquery used as an expression
select * from test_type_table_unlogged where `text` like (select '1%') union all select * from test_type_table_unlogged where `int4` like (select '1%'); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(2 rows)

select * from test_type_table_temporary where `text` like (select `text` from test_type_table_unlogged) union all select * from test_type_table_segment where `int4` like (select `int4` from test_type_table_unlogged); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(2 rows)

select * from test_type_table_unlogged where `text` like (select `int1` from test_type_table_temporary) union all select * from test_type_table_segment where `text` like (select `int4` from test_type_table_temporary); 
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_temporary where `date` like (select '2023-%');
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_temporary where `text` like (select upper(`text`) from test_type_table_unlogged);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_temporary where `text` like (select concat(`text`, '%') from test_type_table_temporary);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_unlogged where `text` like (select concat(`text`, 'a%') from test_type_table_segment);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_unlogged where `timestamp` like (select '2023-%');
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_temporary where `date` like (select '2023-%' union all select '2023-%');
ERROR:  more than one row returned by a subquery used as an expression
-- ANY
select * from test_type_table t1 where `text` = any(select `text` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `text` = any(select NULL);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `int4` > any(select `int4` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `int1` < any(select `int1` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `time` >= any(select `time` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `datetime` <= any(select `datetime` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `timestamp` <> any(select `timestamp` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `blob` != any(select `blob` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_ustore t1 where `text` != any(select `text` from test_type_table_ustore t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_ustore t1 where `text` > any(select NULL);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_ustore t1 where `int4` >= any(select `int4` from test_type_table_ustore t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_ustore t1 where `int1` <= any(select `int1` from test_type_table_ustore t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_ustore t1 where `time` < any(select `time` from test_type_table_ustore t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_ustore t1 where `datetime` = any(select `datetime` from test_type_table_ustore t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_ustore t1 where `timestamp` <= any(select `timestamp` from test_type_table_ustore t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_ustore t1 where `blob` <> any(select `blob` from test_type_table_ustore t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

-- some
select * from test_type_table t1 where `text` = SOME(select `text` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `text` = SOME(select NULL);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `int4` > SOME(select `int4` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `int1` < SOME(select `int1` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `time` >= SOME(select `time` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `datetime` <= SOME(select `datetime` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `timestamp` <> SOME(select `timestamp` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `blob` != SOME(select `blob` from test_type_table t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_partition t1 where `text` != SOME(select `text` from test_type_table_second_partition t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_partition t1 where `text` > SOME(select NULL);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_second_partition t1 where `int4` >= SOME(select `int4` from test_type_table_partition t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_second_partition t1 where `int1` <= SOME(select `int1` from test_type_table_partition t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_second_partition t1 where `time` < SOME(select `time` from test_type_table_partition t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_partition t1 where `datetime` = SOME(select `datetime` from test_type_table_second_partition t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_partition t1 where `timestamp` <= SOME(select `timestamp` from test_type_table_second_partition t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_second_partition t1 where `blob` <> SOME(select `blob` from test_type_table_partition t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

-- all
select * from test_type_table_unlogged t1 where `text` = ALL(select `text` from test_type_table_temporary t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_temporary t1 where `text` = ALL(select NULL);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_temporary t1 where `int4` > ALL(select `int4` from test_type_table_unlogged t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_unlogged t1 where `int1` < ALL(select `int1` from test_type_table_temporary t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_temporary t1 where `time` >= ALL(select `time` from test_type_table_unlogged t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_temporary t1 where `datetime` <= ALL(select `datetime` from test_type_table_unlogged t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_unlogged t1 where `timestamp` <> ALL(select `timestamp` from test_type_table_temporary t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_unlogged t1 where `blob` != ALL(select `blob` from test_type_table_temporary t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_segment t1 where `text` != ALL(select `text` from test_type_table_segment t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_segment t1 where `text` > ALL(select NULL);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_segment t1 where `int4` >= ALL(select `int4` from test_type_table_segment t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_segment t1 where `int1` <= ALL(select `int1` from test_type_table_segment t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_segment t1 where `time` < ALL(select `time` from test_type_table_segment t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table_segment t1 where `datetime` = ALL(select `datetime` from test_type_table_segment t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_segment t1 where `timestamp` <= ALL(select `timestamp` from test_type_table_segment t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table_segment t1 where `blob` <> ALL(select `blob` from test_type_table_segment t2 where t1.`int4` = t2.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

-- in
select * from test_type_table t1 where `text` in (select `text` from test_type_table t2 where t1.`int4` = t2.`int4` union all select `text` from test_type_table_ustore t3 where t3.`int4` = t1.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `text` in (select NULL);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `int4` in (select `int4` from test_type_table t2 where t1.`int4` = t2.`int4` union all select `text` from test_type_table_partition t3 where t3.`int4` = t1.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `int1` in (select `int1` from test_type_table t2 where t1.`int4` = t2.`int4` union all select `text` from test_type_table_second_partition t3 where t3.`int4` = t1.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `time` in (select `time` from test_type_table t2 where t1.`int4` = t2.`int4` union all select `text` from test_type_table_temporary t3 where t3.`int4` = t1.`int4`);
WARNING:  invalid input syntax for type int16: "19:10:50"
DETAIL:  text contain invalid character
WARNING:  invalid input syntax for type int16: "1.23a"
DETAIL:  text contain invalid character
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric | bit1 | bit64 | boolean | date | time | time(4) | datetime | datetime(4) | timestamp | timestamp(4) | year | char | varchar | binary | varbinary | tinyblob | blob | mediumblob | longblob | text | enum_t | set_t | json 
------+-------+------+-------+------+-------+------+-------+--------+--------+---------+------+-------+---------+------+------+---------+----------+-------------+-----------+--------------+------+------+---------+--------+-----------+----------+------+------------+----------+------+--------+-------+------
(0 rows)

select * from test_type_table t1 where `datetime` in (select `datetime` from test_type_table t2 where t1.`int4` = t2.`int4` union all select `text` from test_type_table_unlogged t3 where t3.`int4` = t1.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `timestamp` in (select `timestamp` from test_type_table t2 where t1.`int4` = t2.`int4` union all select `text` from test_type_table_segment t3 where t3.`int4` = t1.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

select * from test_type_table t1 where `blob` in (select `blob` from test_type_table t2 where t1.`int4` = t2.`int4` union all select `text` from test_type_table_ustore t3 where t3.`int4` = t1.`int4`);
 int1 | uint1 | int2 | uint2 | int4 | uint4 | int8 | uint8 | float4 | float8 | numeric  | bit1 |                              bit64                               | boolean |    date    |   time   |    time(4)    |      datetime       |       datetime(4)       |       timestamp        |        timestamp(4)        | year |                                                 char                                                 | varchar |                                                                                                   binary                                                                                                   |  varbinary   |   tinyblob   |     blob     |  mediumblob  |   longblob   | text  | enum_t | set_t |       json       
------+-------+------+-------+------+-------+------+-------+--------+--------+----------+------+------------------------------------------------------------------+---------+------------+----------+---------------+---------------------+-------------------------+------------------------+----------------------------+------+------------------------------------------------------------------------------------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+--------------+--------------+--------------+-------+--------+-------+------------------
 1    | 1     |    1 | 1     |    1 | 1     |    1 | 1     |      1 |      1 | 1.000000 | 1    | 0000000000000000000000000000000000000000000000000000000000000111 | t       | 2023-02-05 | 19:10:50 | 19:10:50.3456 | 2023-02-05 19:10:50 | 2023-02-05 19:10:50.456 | 2023-02-05 19:10:50-08 | 2023-02-05 19:10:50.456-08 | 2023 | 1.23a                                                                                                | 1.23a   | \x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | \x312e323361 | 1.23a | a      | a,c   | {"a": 1, "b": 2}
(1 row)

drop view v1;
drop view v2;
drop view v3;
drop view v4;
drop view v5;
drop table test_type_table;
drop table test_type_table_ustore;
drop table test_type_table_partition;
drop table test_type_table_second_partition;
drop table test_type_table_temporary;
drop table test_type_table_unlogged;
drop table test_type_table_segment;
drop schema test_dml_func cascade;
reset current_schema;
