create schema db_test_condition;
set current_schema to 'db_test_condition';
set dolphin.sql_mode = 'pad_char_to_full_length';
create table test_bccf (t1 int ,t2 float, t3 char, t4 text);
insert into test_bccf values(1,3,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(1,null,'b','asdf');
insert into test_bccf values(3,2.0,'b','sdf');
insert into test_bccf values(4,6.1,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(5,null,'b','asdf');
insert into test_bccf values(6,6.0,'b','sdf');
insert into test_bccf values(7,9,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(1,null,'b','asdf');
insert into test_bccf values(1,4.0,'b','sdf');
insert into test_bccf values(1,7.1,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(11,null,'b','asdf');
insert into test_bccf values(10,6.0,'b','sdf');
insert into test_bccf values(11,14.6,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(13,null,'b','asdf');
insert into test_bccf values(12,2.0,'b','sdf');
insert into test_bccf values(9,2.2,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(8,null,'b','asdf');
insert into test_bccf values(7,2.3,'b','sdf');
insert into test_bccf values(123,3,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(51,null,'b','asdf');
insert into test_bccf values(73,72.0,'b','sdf');
insert into test_bccf values(84,96.1,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(5,null,'b','asdf');
insert into test_bccf values(6,6.7,'b','sdf');
insert into test_bccf values(7,null,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(1,null,'b','asdf');
insert into test_bccf values(2,4.0,'b','sdf');
insert into test_bccf values(1,7.1,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(13,null,'b','asdf');
insert into test_bccf values(10,6.7,'b','sdf');
insert into test_bccf values(11,24.6,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(13,null,'b','asdf');
insert into test_bccf values(12,2.7,'b','sdf');
insert into test_bccf values(9,12.2,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(8,null,'b','asdf');
insert into test_bccf values(7,42.3,'b','sdf');
----------------Coalesce function----------------------
set dolphin.b_compatibility_mode to on;
select coalesce(null, null);
 coalesce 
----------
 
(1 row)

select coalesce(null, 'other');
 coalesce 
----------
 other
(1 row)

select coalesce('something','other');
 coalesce  
-----------
 something
(1 row)

select coalesce(null,321);
 coalesce 
----------
 321
(1 row)

select coalesce(null, null,123,'321');
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,123::int2,321::int2);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,123::int4,321::int4);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,123::int8,321::int8);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,123::float4,321::float4);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,null,123::float8,321::float8);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,null,''::text,'hello!'::text);
 coalesce 
----------
 
(1 row)

select coalesce(null, null,null,'100.001'::numeric,134);
 coalesce 
----------
 100
(1 row)

select coalesce(null, null,null,'2001-01-01 01:01:01.3654'::date,'2012-08-02 15:57:54.6365'::date);
  coalesce  
------------
 2001-01-01
(1 row)

select coalesce(null, null,null,'2001-01-01 01:01:01.3654'::timestamp,'2012-08-02 15:57:54.6365'::timestamp);
        coalesce        
------------------------
 2001-01-01 01:01:01-08
(1 row)

select coalesce(null, null);
 coalesce 
----------
 
(1 row)

select coalesce(null, 'other');
 coalesce 
----------
 other
(1 row)

select coalesce('something','other');
 coalesce  
-----------
 something
(1 row)

select coalesce(null,321);
 coalesce 
----------
 321
(1 row)

select coalesce(123,'321');
 coalesce 
----------
 123
(1 row)

select coalesce(123::int2,null, null,321::int2);
 coalesce 
----------
 123
(1 row)

select coalesce(123::int4,null, null,321::int4);
 coalesce 
----------
 123
(1 row)

select coalesce(123::int8,null, null,321::int8);
 coalesce 
----------
 123
(1 row)

select coalesce(123::float4,null, null,321::float4);
 coalesce 
----------
 123
(1 row)

select coalesce(123::float8,null, null,321::float8);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,'2001-01-01 01:01:01.3654'::date,'2012-08-02 15:57:54.6365'::date);
  coalesce  
------------
 2001-01-01
(1 row)

select coalesce('2001-01-01 01:01:01.3654'::timestamp,null, null,'2012-08-02 15:57:54.6365'::timestamp);
        coalesce        
------------------------
 2001-01-01 01:01:01-08
(1 row)

SELECT coalesce(null,1, 'k');
 coalesce 
----------
 1
(1 row)

SELECT coalesce(null,1, '6');
 coalesce 
----------
 1
(1 row)

SELECT coalesce(null,'j', '');
 coalesce 
----------
 j
(1 row)

SELECT coalesce(null,'j', null);
 coalesce 
----------
 j
(1 row)

SELECT coalesce(null,'', 'k');
 coalesce 
----------
 
(1 row)

SELECT coalesce(null, 'k');
 coalesce 
----------
 k
(1 row)

SELECT coalesce(null,t1, 12) from test_bccf;
 coalesce 
----------
 1
 12
 1
 3
 4
 12
 5
 6
 7
 12
 1
 1
 1
 12
 11
 10
 11
 12
 13
 12
 9
 12
 8
 7
 123
 12
 51
 73
 84
 12
 5
 6
 7
 12
 1
 2
 1
 12
 13
 10
 11
 12
 13
 12
 9
 12
 8
 7
(48 rows)

SELECT coalesce(null,t2, 213.4) from test_bccf;
 coalesce 
----------
 3
 213.4
 213.4
 2
 6.1
 213.4
 213.4
 6
 9
 213.4
 213.4
 4
 7.1
 213.4
 213.4
 6
 14.6
 213.4
 213.4
 2
 2.2
 213.4
 213.4
 2.3
 3
 213.4
 213.4
 72
 96.1
 213.4
 213.4
 6.7
 213.4
 213.4
 213.4
 4
 7.1
 213.4
 213.4
 6.7
 24.6
 213.4
 213.4
 2.7
 12.2
 213.4
 213.4
 42.3
(48 rows)

SELECT coalesce(null,t3, 'c') from test_bccf;
 coalesce 
----------
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
(48 rows)

SELECT coalesce(null,t4, 'hello') from test_bccf;
 coalesce 
----------
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
(48 rows)

SELECT coalesce(null,t1,t2) from test_bccf;
 coalesce 
----------
 1
 
 1
 3
 4
 
 5
 6
 7
 
 1
 1
 1
 
 11
 10
 11
 
 13
 12
 9
 
 8
 7
 123
 
 51
 73
 84
 
 5
 6
 7
 
 1
 2
 1
 
 13
 10
 11
 
 13
 12
 9
 
 8
 7
(48 rows)

SELECT coalesce(null,t2,t1) from test_bccf;
 coalesce 
----------
 3
 
 1
 2
 6.1
 
 5
 6
 9
 
 1
 4
 7.1
 
 11
 6
 14.6
 
 13
 2
 2.2
 
 8
 2.3
 3
 
 51
 72
 96.1
 
 5
 6.7
 7
 
 1
 4
 7.1
 
 13
 6.7
 24.6
 
 13
 2.7
 12.2
 
 8
 42.3
(48 rows)

select pg_typeof(coalesce(null, null));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, 'other'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce('something','other'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null,321));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,123,'321'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,123::int2,321::int2));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,123::int4,321::int4));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,123::int8,321::int8));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,123::float4,321::float4));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,null,123::float8,321::float8));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,null,''::text,'hello!'::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,null,'100.001'::numeric,134));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(null, null,null,'2001-01-01 01:01:01.3654'::date,'2012-08-02 15:57:54.6365'::date));
 pg_typeof 
-----------
 date
(1 row)

select pg_typeof(coalesce(null, null,null,'2001-01-01 01:01:01.3654'::timestamp,'2012-08-02 15:57:54.6365'::timestamp));
        pg_typeof         
--------------------------
 timestamp with time zone
(1 row)

SELECT pg_typeof(coalesce(null,1, 'k'));
 pg_typeof 
-----------
 text
(1 row)

SELECT pg_typeof(coalesce(null,1, '6'));
 pg_typeof 
-----------
 text
(1 row)

SELECT pg_typeof(coalesce(null,'j', ''));
 pg_typeof 
-----------
 text
(1 row)

SELECT pg_typeof(coalesce(null,'j', null));
 pg_typeof 
-----------
 text
(1 row)

SELECT pg_typeof(coalesce(null,'', 'k'));
 pg_typeof 
-----------
 text
(1 row)

SELECT pg_typeof(coalesce(null, 'k'));
 pg_typeof 
-----------
 text
(1 row)

SELECT pg_typeof(coalesce(null,t1, 12)) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

SELECT pg_typeof(coalesce(null,t2, 213.4)) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

SELECT pg_typeof(coalesce(null,t3, 'c')) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

SELECT pg_typeof(coalesce(null,t4, 'hello')) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

SELECT pg_typeof(coalesce(null,t1,t2)) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

SELECT pg_typeof(coalesce(null,t2,t1)) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

----------------IfNULL function------------------------
select ifnull(null, null);
 ifnull 
--------
 
(1 row)

select ifnull(null, 'other');
 ifnull 
--------
 other
(1 row)

select ifnull('something','other');
  ifnull   
-----------
 something
(1 row)

select ifnull(null,321);
 ifnull 
--------
 321
(1 row)

select ifnull(123,'321');
 ifnull 
--------
 123
(1 row)

select ifnull(123::int2,321::int2);
 ifnull 
--------
    123
(1 row)

select ifnull(123::int4,321::int4);
 ifnull 
--------
    123
(1 row)

select ifnull(123::int8,321::int8);
 ifnull 
--------
    123
(1 row)

select ifnull(123::float4,321::float4);
 ifnull 
--------
    123
(1 row)

select ifnull(123::float8,321::float8);
 ifnull 
--------
    123
(1 row)

select ifnull('2001-01-01 01:01:01.3654'::date,'2012-08-02 15:57:54.6365'::date);
   ifnull   
------------
 2001-01-01
(1 row)

select ifnull('2001-01-01 01:01:01.3654'::timestamp,'2012-08-02 15:57:54.6365'::timestamp);
         ifnull         
------------------------
 2001-01-01 01:01:01-08
(1 row)

select pg_typeof(ifnull(null, null));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(null, 'other'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('something','other'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(null,321));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(123,'321'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(123::int2,321::int2));
 pg_typeof 
-----------
 smallint
(1 row)

select pg_typeof(ifnull(123::int4,321::int4));
 pg_typeof 
-----------
 integer
(1 row)

select pg_typeof(ifnull(123::int8,321::int8));
 pg_typeof 
-----------
 bigint
(1 row)

select pg_typeof(ifnull(123::float4,321::float4));
 pg_typeof 
-----------
 real
(1 row)

select pg_typeof(ifnull(123::float8,321::float8));
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(ifnull('2001-01-01 01:01:01.3654'::date,'2012-08-02 15:57:54.6365'::date));
 pg_typeof 
-----------
 date
(1 row)

select pg_typeof(ifnull('2001-01-01 01:01:01.3654'::timestamp,'2012-08-02 15:57:54.6365'::timestamp));
        pg_typeof         
--------------------------
 timestamp with time zone
(1 row)

--ifnull(unknown, int)
SELECT ifnull('j', 1);
 ifnull 
--------
 j
(1 row)

--ifnull(int, unknown)
SELECT ifnull(1, 'k');
 ifnull 
--------
 1
(1 row)

SELECT ifnull(1, '6');
 ifnull 
--------
 1
(1 row)

--ifnull(char, int)
SELECT ifnull('o'::char, 1);
 ifnull 
--------
 o
(1 row)

--ifnull(int, char)
SELECT ifnull(1, 'o'::char);
 ifnull 
--------
 1
(1 row)

--ifnull(text, int2)
SELECT ifnull('hello!'::text, '100'::int2);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100'::int2, 'hello!'::text);
 ifnull 
--------
 100
(1 row)

--ifnull(text, int4)
SELECT ifnull('hello!'::text, '100'::int4);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100'::int4, 'hello!'::text);
 ifnull 
--------
 100
(1 row)

--ifnull(text, int8)
SELECT ifnull('hello!'::text, '100'::int8);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100'::int8, 'hello!'::text);
 ifnull 
--------
 100
(1 row)

--ifnull(text, float4)
SELECT ifnull('hello!'::text, '100.001'::float4);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100.001'::float4, 'hello!'::text);
 ifnull  
---------
 100.001
(1 row)

--ifnull(text, float8)
SELECT ifnull('hello!'::text, '100.001'::float8);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100.001'::float8, 'hello!'::text);
 ifnull  
---------
 100.001
(1 row)

--ifnull(text, number)
SELECT ifnull('hello!'::text, '100.001'::numeric);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100.001'::numeric, 'hello!'::text);
 ifnull 
--------
 100
(1 row)

select pg_typeof(ifnull('j', 1));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(1, 'k'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(1, '6'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('o'::char, 1));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(1, 'o'::char));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('hello!'::text, '100'::int2));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100'::int2, 'hello!'::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('hello!'::text, '100'::int4));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100'::int4, 'hello!'::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('hello!'::text, '100'::int8));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100'::int8, 'hello!'::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('hello!'::text, '100.001'::float4));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100.001'::float4, 'hello!'::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('hello!'::text, '100.001'::float8));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100.001'::float8, 'hello!'::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('hello!'::text, '100.001'::numeric));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100.001'::numeric, 'hello!'::text));
 pg_typeof 
-----------
 text
(1 row)

--null
SELECT ifnull('j', '');
 ifnull 
--------
 j
(1 row)

SELECT ifnull('j', null);
 ifnull 
--------
 j
(1 row)

SELECT ifnull('', 'k');
 ifnull 
--------
 
(1 row)

SELECT ifnull(null, 'k');
 ifnull 
--------
 k
(1 row)

SELECT ifnull(''::text, '100'::int2);
 ifnull 
--------
 
(1 row)

SELECT ifnull(''::int2, 'hello!'::text);
WARNING:  invalid input syntax for type smallint: ""
LINE 1: SELECT ifnull(''::int2, 'hello!'::text);
                      ^
CONTEXT:  referenced column: ifnull
 ifnull 
--------
 0
(1 row)

SELECT ifnull('hello!'::text, ''::int2);
WARNING:  invalid input syntax for type smallint: ""
LINE 1: SELECT ifnull('hello!'::text, ''::int2);
                                      ^
CONTEXT:  referenced column: ifnull
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100'::int2, ''::text);
 ifnull 
--------
 100
(1 row)

SELECT ifnull(''::text, '100.001'::float8);
 ifnull 
--------
 
(1 row)

SELECT ifnull('100.001'::float8, ''::text);
 ifnull  
---------
 100.001
(1 row)

SELECT ifnull(''::text, '100.001'::numeric);
 ifnull 
--------
 
(1 row)

SELECT ifnull(''::numeric, 'hello!'::text);
WARNING:  invalid input syntax for numeric: ""
LINE 1: SELECT ifnull(''::numeric, 'hello!'::text);
                      ^
CONTEXT:  referenced column: ifnull
 ifnull 
--------
 0
(1 row)

SELECT ifnull('hello!'::text, ''::numeric);
WARNING:  invalid input syntax for numeric: ""
LINE 1: SELECT ifnull('hello!'::text, ''::numeric);
                                      ^
CONTEXT:  referenced column: ifnull
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100.001'::numeric, ''::text);
 ifnull 
--------
 100
(1 row)

select ifnull(t1,t2) from test_bccf;
 ifnull 
--------
      1
       
      1
      3
      4
       
      5
      6
      7
       
      1
      1
      1
       
     11
     10
     11
       
     13
     12
      9
       
      8
      7
    123
       
     51
     73
     84
       
      5
      6
      7
       
      1
      2
      1
       
     13
     10
     11
       
     13
     12
      9
       
      8
      7
(48 rows)

select ifnull(t1,t3) from test_bccf;
 ifnull 
--------
 1
 c
 1
 3
 4
 c
 5
 6
 7
 c
 1
 1
 1
 c
 11
 10
 11
 c
 13
 12
 9
 c
 8
 7
 123
 c
 51
 73
 84
 c
 5
 6
 7
 c
 1
 2
 1
 c
 13
 10
 11
 c
 13
 12
 9
 c
 8
 7
(48 rows)

select ifnull(t1,t4) from test_bccf;
 ifnull 
--------
 1
 
 1
 3
 4
 
 5
 6
 7
 
 1
 1
 1
 
 11
 10
 11
 
 13
 12
 9
 
 8
 7
 123
 
 51
 73
 84
 
 5
 6
 7
 
 1
 2
 1
 
 13
 10
 11
 
 13
 12
 9
 
 8
 7
(48 rows)

select ifnull(t3,t4) from test_bccf;
 ifnull 
--------
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
(48 rows)

select pg_typeof(ifnull('j', ''));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('j', null));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('', 'k'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(null, 'k'));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(''::text, '100'::int2));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(''::int2, 'hello!'::text));
WARNING:  invalid input syntax for type smallint: ""
LINE 1: select pg_typeof(ifnull(''::int2, 'hello!'::text));
                                ^
CONTEXT:  referenced column: pg_typeof
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('hello!'::text, ''::int2));
WARNING:  invalid input syntax for type smallint: ""
LINE 1: select pg_typeof(ifnull('hello!'::text, ''::int2));
                                                ^
CONTEXT:  referenced column: pg_typeof
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100'::int2, ''::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(''::text, '100.001'::float8));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100.001'::float8, ''::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(''::text, '100.001'::numeric));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(''::numeric, 'hello!'::text));
WARNING:  invalid input syntax for numeric: ""
LINE 1: select pg_typeof(ifnull(''::numeric, 'hello!'::text));
                                ^
CONTEXT:  referenced column: pg_typeof
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('hello!'::text, ''::numeric));
WARNING:  invalid input syntax for numeric: ""
LINE 1: select pg_typeof(ifnull('hello!'::text, ''::numeric));
                                                ^
CONTEXT:  referenced column: pg_typeof
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('100.001'::numeric, ''::text));
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(t1,t2)) from test_bccf;
    pg_typeof     
------------------
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
 double precision
(48 rows)

select pg_typeof(ifnull(t1,t3)) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

select pg_typeof(ifnull(t1,t4)) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

select pg_typeof(ifnull(t3,t4)) from test_bccf;
 pg_typeof 
-----------
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
 text
(48 rows)

select pg_typeof(ifnull('2022-1-1 11:11:11'::datetime, 'text'::text));
 pg_typeof 
-----------
 text
(1 row)

create table test_bool1(c1 boolean);
insert into test_bool1 values(1);
select ifnull(test_bool1.c1,'') from test_bool1;
 ifnull 
--------
 1
(1 row)

select ifnull('',test_bool1.c1) from test_bool1;
 ifnull 
--------
 
(1 row)

select pg_typeof(ifnull(test_bool1.c1,'')) from test_bool1;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull('',test_bool1.c1)) from test_bool1;
 pg_typeof 
-----------
 text
(1 row)

drop table test_bool1;
reset dolphin.b_compatibility_mode;
----------------ISNULL expression------------------------
--null
SELECT isnull(null);
 ?column? 
----------
 t
(1 row)

SELECT isnull('');
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::text);
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::char);
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::int2);
WARNING:  invalid input syntax for type smallint: ""
LINE 1: SELECT isnull(''::int2);
                      ^
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::int4);
WARNING:  invalid input syntax for type integer: ""
LINE 1: SELECT isnull(''::int4);
                      ^
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::int8);
WARNING:  invalid input syntax for type bigint: ""
LINE 1: SELECT isnull(''::int8);
                      ^
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::numeric);
WARNING:  invalid input syntax for numeric: ""
LINE 1: SELECT isnull(''::numeric);
                      ^
 ?column? 
----------
 f
(1 row)

SELECT isnull('j');
 ?column? 
----------
 f
(1 row)

SELECT isnull('hello!'::text);
 ?column? 
----------
 f
(1 row)

SELECT isnull('100'::int2);
 ?column? 
----------
 f
(1 row)

SELECT isnull('100.001'::float8);
 ?column? 
----------
 f
(1 row)

SELECT isnull('100.001'::numeric);
 ?column? 
----------
 f
(1 row)

select * from test_bccf where isnull(t1) order by 1, 2;
 t1 | t2 | t3 | t4 
----+----+----+----
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
(12 rows)

select * from test_bccf where isnull(t2) order by 1, 2;
 t1 | t2 | t3 |  t4  
----+----+----+------
  1 |    | b  | asdf
  1 |    | b  | asdf
  1 |    | b  | asdf
  5 |    | b  | asdf
  5 |    | b  | asdf
  7 |    |    | 
  8 |    | b  | asdf
  8 |    | b  | asdf
 11 |    | b  | asdf
 13 |    | b  | asdf
 13 |    | b  | asdf
 13 |    | b  | asdf
 51 |    | b  | asdf
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
(25 rows)

select * from test_bccf where isnull(t3) order by 1, 2;
 t1  |  t2  | t3 | t4 
-----+------+----+----
   1 |    3 |    | 
   1 |  7.1 |    | 
   1 |  7.1 |    | 
   4 |  6.1 |    | 
   7 |    9 |    | 
   7 |      |    | 
   9 |  2.2 |    | 
   9 | 12.2 |    | 
  11 | 14.6 |    | 
  11 | 24.6 |    | 
  84 | 96.1 |    | 
 123 |    3 |    | 
(12 rows)

select * from test_bccf where isnull(t4) order by 1, 2;
 t1  |  t2  | t3 | t4 
-----+------+----+----
   1 |    3 |    | 
   1 |  7.1 |    | 
   1 |  7.1 |    | 
   4 |  6.1 |    | 
   7 |    9 |    | 
   7 |      |    | 
   9 |  2.2 |    | 
   9 | 12.2 |    | 
  11 | 14.6 |    | 
  11 | 24.6 |    | 
  84 | 96.1 |    | 
 123 |    3 |    | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
(24 rows)

select * from test_bccf where isnull(t1) and t2 is not NULL order by 1, 2;
 t1 | t2 | t3 | t4 
----+----+----+----
(0 rows)

select * from test_bccf where isnull(t2) and t3 is not NULL order by 1, 2;
 t1 | t2 | t3 |  t4  
----+----+----+------
  1 |    | b  | asdf
  1 |    | b  | asdf
  1 |    | b  | asdf
  5 |    | b  | asdf
  5 |    | b  | asdf
  8 |    | b  | asdf
  8 |    | b  | asdf
 11 |    | b  | asdf
 13 |    | b  | asdf
 13 |    | b  | asdf
 13 |    | b  | asdf
 51 |    | b  | asdf
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
(24 rows)

select * from test_bccf where isnull(t3) and t4 is not NULL order by 1, 2;
 t1 | t2 | t3 | t4 
----+----+----+----
(0 rows)

select * from test_bccf where isnull(t4) and t1 is not NULL order by 1, 2;
 t1  |  t2  | t3 | t4 
-----+------+----+----
   1 |    3 |    | 
   1 |  7.1 |    | 
   1 |  7.1 |    | 
   4 |  6.1 |    | 
   7 |    9 |    | 
   7 |      |    | 
   9 |  2.2 |    | 
   9 | 12.2 |    | 
  11 | 14.6 |    | 
  11 | 24.6 |    | 
  84 | 96.1 |    | 
 123 |    3 |    | 
(12 rows)

----------------STRCMP expression------------------------
select strcmp(null, null);
 strcmp 
--------
       
(1 row)

select strcmp(null, 'other');
 strcmp 
--------
       
(1 row)

select strcmp('other', null);
 strcmp 
--------
       
(1 row)

select strcmp('something','other');
 strcmp 
--------
      1
(1 row)

select strcmp('something','something');
 strcmp 
--------
      0
(1 row)

select strcmp(null, 321);
 strcmp 
--------
       
(1 row)

select strcmp(321, null);
 strcmp 
--------
       
(1 row)

select strcmp(321, 321);
 strcmp 
--------
      0
(1 row)

select strcmp(321, 123);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::int2);
 strcmp 
--------
       
(1 row)

select strcmp(321::int2, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::int2, 321::int2);
 strcmp 
--------
      0
(1 row)

select strcmp(321::int2, 123::int2);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::int4);
 strcmp 
--------
       
(1 row)

select strcmp(321::int4, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::int4, 321::int4);
 strcmp 
--------
      0
(1 row)

select strcmp(321::int4, 123::int4);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::int8);
 strcmp 
--------
       
(1 row)

select strcmp(321::int8, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::int8, 321::int8);
 strcmp 
--------
      0
(1 row)

select strcmp(321::int8, 123::int8);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::float4);
 strcmp 
--------
       
(1 row)

select strcmp(321::float4, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::float4, 321::float4);
 strcmp 
--------
      0
(1 row)

select strcmp(321::float4, 123::float4);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::float8);
 strcmp 
--------
       
(1 row)

select strcmp(321::float8, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::float8, 321::float8);
 strcmp 
--------
      0
(1 row)

select strcmp(321::float8, 123::float8);
 strcmp 
--------
      1
(1 row)

select strcmp(null,'something'::text);
 strcmp 
--------
       
(1 row)

select strcmp('something'::text,null);
 strcmp 
--------
       
(1 row)

select strcmp('something'::text,'something'::text);
 strcmp 
--------
      0
(1 row)

select strcmp('something'::text,'other'::text);
 strcmp 
--------
      1
(1 row)

select strcmp(null, '2001-01-01 01:01:01.3654'::date);
 strcmp 
--------
       
(1 row)

select strcmp('2001-01-01 01:01:01.3654'::date, null);
 strcmp 
--------
       
(1 row)

select strcmp('2001-01-01 01:01:01.3654'::date, '2001-01-01 01:01:01.3654'::date);
 strcmp 
--------
      0
(1 row)

select strcmp('2001-01-01 01:01:01.3654'::date, '1999-01-01 01:01:01.3654'::date);
 strcmp 
--------
      1
(1 row)

SELECT strcmp(t1, 12) from test_bccf;
 strcmp 
--------
     -1
       
     -1
      1
      1
       
      1
      1
      1
       
     -1
     -1
     -1
       
     -1
     -1
     -1
       
      1
      0
      1
       
      1
      1
      1
       
      1
      1
      1
       
      1
      1
      1
       
     -1
      1
     -1
       
      1
     -1
     -1
       
      1
      0
      1
       
      1
      1
(48 rows)

SELECT strcmp(t2, 213.4) from test_bccf;
 strcmp 
--------
      1
       
       
     -1
      1
       
       
      1
      1
       
       
      1
      1
       
       
      1
     -1
       
       
     -1
     -1
       
       
     -1
      1
       
       
      1
      1
       
       
      1
       
       
       
      1
      1
       
       
      1
      1
       
       
     -1
     -1
       
       
      1
(48 rows)

SELECT strcmp(t3, 'c') from test_bccf;
 strcmp 
--------
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
(48 rows)

SELECT strcmp(t4, 'hello') from test_bccf;
 strcmp 
--------
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
(48 rows)

SELECT strcmp(t1,t2) from test_bccf;
 strcmp 
--------
     -1
       
       
      1
     -1
       
       
      0
     -1
       
       
     -1
     -1
       
       
     -1
     -1
       
       
     -1
      1
       
       
      1
     -1
       
       
      1
     -1
       
       
     -1
       
       
       
     -1
     -1
       
       
     -1
     -1
       
       
     -1
      1
       
       
      1
(48 rows)

SELECT strcmp(t2,t1) from test_bccf;
 strcmp 
--------
      1
       
       
     -1
      1
       
       
      0
      1
       
       
      1
      1
       
       
      1
      1
       
       
      1
     -1
       
       
     -1
      1
       
       
     -1
      1
       
       
      1
       
       
       
      1
      1
       
       
      1
      1
       
       
      1
     -1
       
       
     -1
(48 rows)

----------------interval expression------------------------
select interval(null);
ERROR:  syntax error at or near ")"
LINE 1: select interval(null);
                            ^
select interval(null, 123);
 interval 
----------
       -1
(1 row)

select interval(null, 123.45);
 interval 
----------
       -1
(1 row)

select interval(123,null);
 interval 
----------
        1
(1 row)

select interval(123,null,17,43.123);
 interval 
----------
        3
(1 row)

select interval(123.213,null,17,43.123);
 interval 
----------
        3
(1 row)

select interval(100, '10e2');
 interval 
----------
        0
(1 row)

select interval(100, '   10e1');
 interval 
----------
        1
(1 row)

select interval(100, '   10e1', '      10Eeasd');
 interval 
----------
        2
(1 row)

select interval(10e3, '   10e1', '      10E1easd    ', '2e10');
 interval 
----------
        2
(1 row)

select interval(0, '   wa');
 interval 
----------
        1
(1 row)

select interval(0, '   wa', '  e1212');
 interval 
----------
        2
(1 row)

select interval(0, '   abiusdhiw');
 interval 
----------
        1
(1 row)

select interval(0, '   abiusdhiw', '   kqiwjoiqh  ');
 interval 
----------
        2
(1 row)

select interval(0, '   1e12abiusdhiw');
 interval 
----------
        0
(1 row)

select interval(0, '   e13fsdsda');
 interval 
----------
        1
(1 row)

select interval(0, '1e13fsdsda');
 interval 
----------
        0
(1 row)

select interval(100, '1e1fsdsda');
 interval 
----------
        1
(1 row)

select interval('+12', 121);
 interval 
----------
        0
(1 row)

select interval('+12', 12);
 interval 
----------
        1
(1 row)

select interval('+12', 0);
 interval 
----------
        1
(1 row)

select interval('-12', 0);
 interval 
----------
        0
(1 row)

select interval('-12.2', 0);
 interval 
----------
        0
(1 row)

select interval('-.2', 0);
 interval 
----------
        0
(1 row)

select interval('-.2', -100);
 interval 
----------
        1
(1 row)

select interval('-.2E2', -100);
 interval 
----------
        1
(1 row)

select interval('-.2E4', -100);
 interval 
----------
        0
(1 row)

select interval('..', 21);
 interval 
----------
        0
(1 row)

select interval('.21.', 21);
 interval 
----------
        0
(1 row)

select interval('.21.', 0);
 interval 
----------
        1
(1 row)

select interval('+.21.', 0);
 interval 
----------
        1
(1 row)

select interval('-.21.', 0);
 interval 
----------
        0
(1 row)

select interval('-.21.', -1);
 interval 
----------
        1
(1 row)

select interval('-..21.', -1);
 interval 
----------
        1
(1 row)

select interval('...', -1);
 interval 
----------
        1
(1 row)

select interval('...', -1);
 interval 
----------
        1
(1 row)

select interval(123::int2,null);
 interval 
----------
        1
(1 row)

select interval(123::int4,null);
 interval 
----------
        1
(1 row)

select interval(123::int8,null);
 interval 
----------
        1
(1 row)

select interval(123,123.23);
 interval 
----------
        0
(1 row)

select interval(123,123.23::int);
 interval 
----------
        1
(1 row)

select interval(null, '2001-01-01 01:01:01.3654'::date);
 interval 
----------
       -1
(1 row)

select interval('2001-01-01 01:01:01.3654'::date, null);
 interval 
----------
        1
(1 row)

select interval('2001-01-01 01:01:01.3654'::date, '2001-01-01 01:01:01.3654'::date);
 interval 
----------
        1
(1 row)

select interval('2001-01-01 01:01:01.3654'::date, '1999-01-01 01:01:01.3654'::date);
 interval 
----------
        1
(1 row)

select interval('2022-12-12'::timestamp,123);
 interval 
----------
        1
(1 row)

select interval('2022-12-12'::timestamp,'2022-12-12'::timestamp);
 interval 
----------
        1
(1 row)

select interval(123,'2022-12-12'::timestamp);
 interval 
----------
        0
(1 row)

select interval(1,' ');
 interval 
----------
        1
(1 row)

select interval(b'1',' ');
 interval 
----------
        1
(1 row)

select interval('a',' ');
 interval 
----------
        1
(1 row)

select interval(false,' ');
 interval 
----------
        1
(1 row)

select interval(' ',true);
 interval 
----------
        0
(1 row)

select interval(' ',b'1');
 interval 
----------
        0
(1 row)

select interval(' ','a');
 interval 
----------
        1
(1 row)

select interval(' ',12);
 interval 
----------
        0
(1 row)

select interval(t1, t2) from test_bccf;
 interval 
----------
        0
       -1
        1
        1
        0
       -1
        1
        1
        0
       -1
        1
        0
        0
       -1
        1
        1
        0
       -1
        1
        1
        1
       -1
        1
        1
        1
       -1
        1
        1
        0
       -1
        1
        0
        1
       -1
        1
        0
        0
       -1
        1
        1
        0
       -1
        1
        1
        0
       -1
        1
        0
(48 rows)

select interval(t2, t1) from test_bccf;
 interval 
----------
        1
       -1
       -1
        0
        1
       -1
       -1
        1
        1
       -1
       -1
        1
        1
       -1
       -1
        0
        1
       -1
       -1
        0
        0
       -1
       -1
        0
        0
       -1
       -1
        0
        1
       -1
       -1
        1
       -1
       -1
       -1
        1
        1
       -1
       -1
        0
        1
       -1
       -1
        0
        1
       -1
       -1
        1
(48 rows)

drop table test_bccf;
create table test_bccf (t1 int ,t2 float, t3 char, t4 text) WITH (ORIENTATION = COLUMN);
insert into test_bccf values(1,3,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(1,null,'b','asdf');
insert into test_bccf values(3,2.0,'b','sdf');
insert into test_bccf values(4,6.1,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(5,null,'b','asdf');
insert into test_bccf values(6,6.0,'b','sdf');
insert into test_bccf values(7,9,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(1,null,'b','asdf');
insert into test_bccf values(1,4.0,'b','sdf');
insert into test_bccf values(1,7.1,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(11,null,'b','asdf');
insert into test_bccf values(10,6.0,'b','sdf');
insert into test_bccf values(11,14.6,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(13,null,'b','asdf');
insert into test_bccf values(12,2.0,'b','sdf');
insert into test_bccf values(9,2.2,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(8,null,'b','asdf');
insert into test_bccf values(7,2.3,'b','sdf');
insert into test_bccf values(123,3,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(51,null,'b','asdf');
insert into test_bccf values(73,72.0,'b','sdf');
insert into test_bccf values(84,96.1,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(5,null,'b','asdf');
insert into test_bccf values(6,6.7,'b','sdf');
insert into test_bccf values(7,null,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(1,null,'b','asdf');
insert into test_bccf values(2,4.0,'b','sdf');
insert into test_bccf values(1,7.1,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(13,null,'b','asdf');
insert into test_bccf values(10,6.7,'b','sdf');
insert into test_bccf values(11,24.6,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(13,null,'b','asdf');
insert into test_bccf values(12,2.7,'b','sdf');
insert into test_bccf values(9,12.2,null,null);
insert into test_bccf values(null,null,'c',null);
insert into test_bccf values(8,null,'b','asdf');
insert into test_bccf values(7,42.3,'b','sdf');
----------------Coalesce function----------------------
select coalesce(null, null);
 coalesce 
----------
 
(1 row)

select coalesce(null, 'other');
 coalesce 
----------
 other
(1 row)

select coalesce('something','other');
 coalesce  
-----------
 something
(1 row)

select coalesce(null,321);
 coalesce 
----------
 321
(1 row)

select coalesce(null, null,123,'321');
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,123::int2,321::int2);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,123::int4,321::int4);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,123::int8,321::int8);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,123::float4,321::float4);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,null,123::float8,321::float8);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,null,''::text,'hello!'::text);
 coalesce 
----------
 
(1 row)

select coalesce(null, null,null,'100.001'::numeric,134);
 coalesce 
----------
 100
(1 row)

select coalesce(null, null,null,'2001-01-01 01:01:01.3654'::date,'2012-08-02 15:57:54.6365'::date);
  coalesce  
------------
 2001-01-01
(1 row)

select coalesce(null, null,null,'2001-01-01 01:01:01.3654'::timestamp,'2012-08-02 15:57:54.6365'::timestamp);
        coalesce        
------------------------
 2001-01-01 01:01:01-08
(1 row)

select coalesce(null, null);
 coalesce 
----------
 
(1 row)

select coalesce(null, 'other');
 coalesce 
----------
 other
(1 row)

select coalesce('something','other');
 coalesce  
-----------
 something
(1 row)

select coalesce(null,321);
 coalesce 
----------
 321
(1 row)

select coalesce(123,'321');
 coalesce 
----------
 123
(1 row)

select coalesce(123::int2,null, null,321::int2);
 coalesce 
----------
 123
(1 row)

select coalesce(123::int4,null, null,321::int4);
 coalesce 
----------
 123
(1 row)

select coalesce(123::int8,null, null,321::int8);
 coalesce 
----------
 123
(1 row)

select coalesce(123::float4,null, null,321::float4);
 coalesce 
----------
 123
(1 row)

select coalesce(123::float8,null, null,321::float8);
 coalesce 
----------
 123
(1 row)

select coalesce(null, null,'2001-01-01 01:01:01.3654'::date,'2012-08-02 15:57:54.6365'::date);
  coalesce  
------------
 2001-01-01
(1 row)

select coalesce('2001-01-01 01:01:01.3654'::timestamp,null, null,'2012-08-02 15:57:54.6365'::timestamp);
        coalesce        
------------------------
 2001-01-01 01:01:01-08
(1 row)

SELECT coalesce(null,1, 'k');
 coalesce 
----------
 1
(1 row)

SELECT coalesce(null,1, '6');
 coalesce 
----------
 1
(1 row)

SELECT coalesce(null,'j', '');
 coalesce 
----------
 j
(1 row)

SELECT coalesce(null,'j', null);
 coalesce 
----------
 j
(1 row)

SELECT coalesce(null,'', 'k');
 coalesce 
----------
 
(1 row)

SELECT coalesce(null, 'k');
 coalesce 
----------
 k
(1 row)

SELECT coalesce(null,t1, 12) from test_bccf;
 coalesce 
----------
 1
 12
 1
 3
 4
 12
 5
 6
 7
 12
 1
 1
 1
 12
 11
 10
 11
 12
 13
 12
 9
 12
 8
 7
 123
 12
 51
 73
 84
 12
 5
 6
 7
 12
 1
 2
 1
 12
 13
 10
 11
 12
 13
 12
 9
 12
 8
 7
(48 rows)

SELECT coalesce(null,t2, 213.4) from test_bccf;
 coalesce 
----------
 3
 213.4
 213.4
 2
 6.1
 213.4
 213.4
 6
 9
 213.4
 213.4
 4
 7.1
 213.4
 213.4
 6
 14.6
 213.4
 213.4
 2
 2.2
 213.4
 213.4
 2.3
 3
 213.4
 213.4
 72
 96.1
 213.4
 213.4
 6.7
 213.4
 213.4
 213.4
 4
 7.1
 213.4
 213.4
 6.7
 24.6
 213.4
 213.4
 2.7
 12.2
 213.4
 213.4
 42.3
(48 rows)

SELECT coalesce(null,t3, 'c') from test_bccf;
 coalesce 
----------
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
 c
 c
 b
 b
(48 rows)

SELECT coalesce(null,t4, 'hello') from test_bccf;
 coalesce 
----------
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
 hello
 hello
 asdf
 sdf
(48 rows)

SELECT coalesce(null,t1,t2) from test_bccf;
 coalesce 
----------
 1
 
 1
 3
 4
 
 5
 6
 7
 
 1
 1
 1
 
 11
 10
 11
 
 13
 12
 9
 
 8
 7
 123
 
 51
 73
 84
 
 5
 6
 7
 
 1
 2
 1
 
 13
 10
 11
 
 13
 12
 9
 
 8
 7
(48 rows)

SELECT coalesce(null,t2,t1) from test_bccf;
 coalesce 
----------
 3
 
 1
 2
 6.1
 
 5
 6
 9
 
 1
 4
 7.1
 
 11
 6
 14.6
 
 13
 2
 2.2
 
 8
 2.3
 3
 
 51
 72
 96.1
 
 5
 6.7
 7
 
 1
 4
 7.1
 
 13
 6.7
 24.6
 
 13
 2.7
 12.2
 
 8
 42.3
(48 rows)

----------------IfNULL function------------------------
set dolphin.b_compatibility_mode to on;
select ifnull(null, null);
 ifnull 
--------
 
(1 row)

select ifnull(null, 'other');
 ifnull 
--------
 other
(1 row)

select ifnull('something','other');
  ifnull   
-----------
 something
(1 row)

select ifnull(null,321);
 ifnull 
--------
 321
(1 row)

select ifnull(123,'321');
 ifnull 
--------
 123
(1 row)

select ifnull(123::int2,321::int2);
 ifnull 
--------
    123
(1 row)

select ifnull(123::int4,321::int4);
 ifnull 
--------
    123
(1 row)

select ifnull(123::int8,321::int8);
 ifnull 
--------
    123
(1 row)

select ifnull(123::float4,321::float4);
 ifnull 
--------
    123
(1 row)

select ifnull(123::float8,321::float8);
 ifnull 
--------
    123
(1 row)

select ifnull('2001-01-01 01:01:01.3654'::date,'2012-08-02 15:57:54.6365'::date);
   ifnull   
------------
 2001-01-01
(1 row)

select ifnull('2001-01-01 01:01:01.3654'::timestamp,'2012-08-02 15:57:54.6365'::timestamp);
         ifnull         
------------------------
 2001-01-01 01:01:01-08
(1 row)

--ifnull(unknown, int)
SELECT ifnull('j', 1);
 ifnull 
--------
 j
(1 row)

--ifnull(int, unknown)
SELECT ifnull(1, 'k');
 ifnull 
--------
 1
(1 row)

SELECT ifnull(1, '6');
 ifnull 
--------
 1
(1 row)

--ifnull(char, int)
SELECT ifnull('o'::char, 1);
 ifnull 
--------
 o
(1 row)

--ifnull(int, char)
SELECT ifnull(1, 'o'::char);
 ifnull 
--------
 1
(1 row)

--ifnull(text, int2)
SELECT ifnull('hello!'::text, '100'::int2);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100'::int2, 'hello!'::text);
 ifnull 
--------
 100
(1 row)

--ifnull(text, int4)
SELECT ifnull('hello!'::text, '100'::int4);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100'::int4, 'hello!'::text);
 ifnull 
--------
 100
(1 row)

--ifnull(text, int8)
SELECT ifnull('hello!'::text, '100'::int8);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100'::int8, 'hello!'::text);
 ifnull 
--------
 100
(1 row)

--ifnull(text, float4)
SELECT ifnull('hello!'::text, '100.001'::float4);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100.001'::float4, 'hello!'::text);
 ifnull  
---------
 100.001
(1 row)

--ifnull(text, float8)
SELECT ifnull('hello!'::text, '100.001'::float8);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100.001'::float8, 'hello!'::text);
 ifnull  
---------
 100.001
(1 row)

--ifnull(text, number)
SELECT ifnull('hello!'::text, '100.001'::numeric);
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100.001'::numeric, 'hello!'::text);
 ifnull 
--------
 100
(1 row)

--null
SELECT ifnull('j', '');
 ifnull 
--------
 j
(1 row)

SELECT ifnull('j', null);
 ifnull 
--------
 j
(1 row)

SELECT ifnull('', 'k');
 ifnull 
--------
 
(1 row)

SELECT ifnull(null, 'k');
 ifnull 
--------
 k
(1 row)

SELECT ifnull(''::text, '100'::int2);
 ifnull 
--------
 
(1 row)

SELECT ifnull(''::int2, 'hello!'::text);
WARNING:  invalid input syntax for type smallint: ""
LINE 1: SELECT ifnull(''::int2, 'hello!'::text);
                      ^
CONTEXT:  referenced column: ifnull
 ifnull 
--------
 0
(1 row)

SELECT ifnull('hello!'::text, ''::int2);
WARNING:  invalid input syntax for type smallint: ""
LINE 1: SELECT ifnull('hello!'::text, ''::int2);
                                      ^
CONTEXT:  referenced column: ifnull
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100'::int2, ''::text);
 ifnull 
--------
 100
(1 row)

SELECT ifnull(''::text, '100.001'::float8);
 ifnull 
--------
 
(1 row)

SELECT ifnull('100.001'::float8, ''::text);
 ifnull  
---------
 100.001
(1 row)

SELECT ifnull(''::text, '100.001'::numeric);
 ifnull 
--------
 
(1 row)

SELECT ifnull(''::numeric, 'hello!'::text);
WARNING:  invalid input syntax for numeric: ""
LINE 1: SELECT ifnull(''::numeric, 'hello!'::text);
                      ^
CONTEXT:  referenced column: ifnull
 ifnull 
--------
 0
(1 row)

SELECT ifnull('hello!'::text, ''::numeric);
WARNING:  invalid input syntax for numeric: ""
LINE 1: SELECT ifnull('hello!'::text, ''::numeric);
                                      ^
CONTEXT:  referenced column: ifnull
 ifnull 
--------
 hello!
(1 row)

SELECT ifnull('100.001'::numeric, ''::text);
 ifnull 
--------
 100
(1 row)

select ifnull(t1,t2) from test_bccf;
 ifnull 
--------
      1
       
      1
      3
      4
       
      5
      6
      7
       
      1
      1
      1
       
     11
     10
     11
       
     13
     12
      9
       
      8
      7
    123
       
     51
     73
     84
       
      5
      6
      7
       
      1
      2
      1
       
     13
     10
     11
       
     13
     12
      9
       
      8
      7
(48 rows)

select ifnull(t1,t3) from test_bccf;
 ifnull 
--------
 1
 c
 1
 3
 4
 c
 5
 6
 7
 c
 1
 1
 1
 c
 11
 10
 11
 c
 13
 12
 9
 c
 8
 7
 123
 c
 51
 73
 84
 c
 5
 6
 7
 c
 1
 2
 1
 c
 13
 10
 11
 c
 13
 12
 9
 c
 8
 7
(48 rows)

select ifnull(t1,t4) from test_bccf;
 ifnull 
--------
 1
 
 1
 3
 4
 
 5
 6
 7
 
 1
 1
 1
 
 11
 10
 11
 
 13
 12
 9
 
 8
 7
 123
 
 51
 73
 84
 
 5
 6
 7
 
 1
 2
 1
 
 13
 10
 11
 
 13
 12
 9
 
 8
 7
(48 rows)

select ifnull(t3,t4) from test_bccf;
 ifnull 
--------
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
 
 c
 b
 b
(48 rows)

reset dolphin.b_compatibility_mode;
----------------ISNULL expression------------------------
--null
SELECT isnull(null);
 ?column? 
----------
 t
(1 row)

SELECT isnull('');
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::text);
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::char);
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::int2);
WARNING:  invalid input syntax for type smallint: ""
LINE 1: SELECT isnull(''::int2);
                      ^
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::int4);
WARNING:  invalid input syntax for type integer: ""
LINE 1: SELECT isnull(''::int4);
                      ^
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::int8);
WARNING:  invalid input syntax for type bigint: ""
LINE 1: SELECT isnull(''::int8);
                      ^
 ?column? 
----------
 f
(1 row)

SELECT isnull(''::numeric);
WARNING:  invalid input syntax for numeric: ""
LINE 1: SELECT isnull(''::numeric);
                      ^
 ?column? 
----------
 f
(1 row)

SELECT isnull('j');
 ?column? 
----------
 f
(1 row)

SELECT isnull('hello!'::text);
 ?column? 
----------
 f
(1 row)

SELECT isnull('100'::int2);
 ?column? 
----------
 f
(1 row)

SELECT isnull('100.001'::float8);
 ?column? 
----------
 f
(1 row)

SELECT isnull('100.001'::numeric);
 ?column? 
----------
 f
(1 row)

select * from test_bccf where isnull(t1) order by 1, 2;
 t1 | t2 | t3 | t4 
----+----+----+----
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
(12 rows)

select * from test_bccf where isnull(t2) order by 1, 2;
 t1 | t2 | t3 |  t4  
----+----+----+------
  1 |    | b  | asdf
  1 |    | b  | asdf
  1 |    | b  | asdf
  5 |    | b  | asdf
  5 |    | b  | asdf
  7 |    |    | 
  8 |    | b  | asdf
  8 |    | b  | asdf
 11 |    | b  | asdf
 13 |    | b  | asdf
 13 |    | b  | asdf
 13 |    | b  | asdf
 51 |    | b  | asdf
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
(25 rows)

select * from test_bccf where isnull(t3) order by 1, 2;
 t1  |  t2  | t3 | t4 
-----+------+----+----
   1 |    3 |    | 
   1 |  7.1 |    | 
   1 |  7.1 |    | 
   4 |  6.1 |    | 
   7 |    9 |    | 
   7 |      |    | 
   9 |  2.2 |    | 
   9 | 12.2 |    | 
  11 | 14.6 |    | 
  11 | 24.6 |    | 
  84 | 96.1 |    | 
 123 |    3 |    | 
(12 rows)

select * from test_bccf where isnull(t4) order by 1, 2;
 t1  |  t2  | t3 | t4 
-----+------+----+----
   1 |    3 |    | 
   1 |  7.1 |    | 
   1 |  7.1 |    | 
   4 |  6.1 |    | 
   7 |    9 |    | 
   7 |      |    | 
   9 |  2.2 |    | 
   9 | 12.2 |    | 
  11 | 14.6 |    | 
  11 | 24.6 |    | 
  84 | 96.1 |    | 
 123 |    3 |    | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
     |      | c  | 
(24 rows)

select * from test_bccf where isnull(t1) and t2 is not NULL order by 1, 2;
 t1 | t2 | t3 | t4 
----+----+----+----
(0 rows)

select * from test_bccf where isnull(t2) and t3 is not NULL order by 1, 2;
 t1 | t2 | t3 |  t4  
----+----+----+------
  1 |    | b  | asdf
  1 |    | b  | asdf
  1 |    | b  | asdf
  5 |    | b  | asdf
  5 |    | b  | asdf
  8 |    | b  | asdf
  8 |    | b  | asdf
 11 |    | b  | asdf
 13 |    | b  | asdf
 13 |    | b  | asdf
 13 |    | b  | asdf
 51 |    | b  | asdf
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
    |    | c  | 
(24 rows)

select * from test_bccf where isnull(t3) and t4 is not NULL order by 1, 2;
 t1 | t2 | t3 | t4 
----+----+----+----
(0 rows)

select * from test_bccf where isnull(t4) and t1 is not NULL order by 1, 2;
 t1  |  t2  | t3 | t4 
-----+------+----+----
   1 |    3 |    | 
   1 |  7.1 |    | 
   1 |  7.1 |    | 
   4 |  6.1 |    | 
   7 |    9 |    | 
   7 |      |    | 
   9 |  2.2 |    | 
   9 | 12.2 |    | 
  11 | 14.6 |    | 
  11 | 24.6 |    | 
  84 | 96.1 |    | 
 123 |    3 |    | 
(12 rows)

----------------STRCMP expression------------------------
select strcmp(null, null);
 strcmp 
--------
       
(1 row)

select strcmp(null, 'other');
 strcmp 
--------
       
(1 row)

select strcmp('other', null);
 strcmp 
--------
       
(1 row)

select strcmp('something','other');
 strcmp 
--------
      1
(1 row)

select strcmp('something','something');
 strcmp 
--------
      0
(1 row)

select strcmp(null, 321);
 strcmp 
--------
       
(1 row)

select strcmp(321, null);
 strcmp 
--------
       
(1 row)

select strcmp(321, 321);
 strcmp 
--------
      0
(1 row)

select strcmp(321, 123);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::int2);
 strcmp 
--------
       
(1 row)

select strcmp(321::int2, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::int2, 321::int2);
 strcmp 
--------
      0
(1 row)

select strcmp(321::int2, 123::int2);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::int4);
 strcmp 
--------
       
(1 row)

select strcmp(321::int4, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::int4, 321::int4);
 strcmp 
--------
      0
(1 row)

select strcmp(321::int4, 123::int4);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::int8);
 strcmp 
--------
       
(1 row)

select strcmp(321::int8, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::int8, 321::int8);
 strcmp 
--------
      0
(1 row)

select strcmp(321::int8, 123::int8);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::float4);
 strcmp 
--------
       
(1 row)

select strcmp(321::float4, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::float4, 321::float4);
 strcmp 
--------
      0
(1 row)

select strcmp(321::float4, 123::float4);
 strcmp 
--------
      1
(1 row)

select strcmp(null, 321::float8);
 strcmp 
--------
       
(1 row)

select strcmp(321::float8, null);
 strcmp 
--------
       
(1 row)

select strcmp(321::float8, 321::float8);
 strcmp 
--------
      0
(1 row)

select strcmp(321::float8, 123::float8);
 strcmp 
--------
      1
(1 row)

select strcmp(null,'something'::text);
 strcmp 
--------
       
(1 row)

select strcmp('something'::text,null);
 strcmp 
--------
       
(1 row)

select strcmp('something'::text,'something'::text);
 strcmp 
--------
      0
(1 row)

select strcmp('something'::text,'other'::text);
 strcmp 
--------
      1
(1 row)

select strcmp(null, '2001-01-01 01:01:01.3654'::date);
 strcmp 
--------
       
(1 row)

select strcmp('2001-01-01 01:01:01.3654'::date, null);
 strcmp 
--------
       
(1 row)

select strcmp('2001-01-01 01:01:01.3654'::date, '2001-01-01 01:01:01.3654'::date);
 strcmp 
--------
      0
(1 row)

select strcmp('2001-01-01 01:01:01.3654'::date, '1999-01-01 01:01:01.3654'::date);
 strcmp 
--------
      1
(1 row)

SELECT strcmp(t1, 12) from test_bccf;
 strcmp 
--------
     -1
       
     -1
      1
      1
       
      1
      1
      1
       
     -1
     -1
     -1
       
     -1
     -1
     -1
       
      1
      0
      1
       
      1
      1
      1
       
      1
      1
      1
       
      1
      1
      1
       
     -1
      1
     -1
       
      1
     -1
     -1
       
      1
      0
      1
       
      1
      1
(48 rows)

SELECT strcmp(t2, 213.4) from test_bccf;
 strcmp 
--------
      1
       
       
     -1
      1
       
       
      1
      1
       
       
      1
      1
       
       
      1
     -1
       
       
     -1
     -1
       
       
     -1
      1
       
       
      1
      1
       
       
      1
       
       
       
      1
      1
       
       
      1
      1
       
       
     -1
     -1
       
       
      1
(48 rows)

SELECT strcmp(t3, 'c') from test_bccf;
 strcmp 
--------
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
       
      0
     -1
     -1
(48 rows)

SELECT strcmp(t4, 'hello') from test_bccf;
 strcmp 
--------
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
       
       
     -1
      1
(48 rows)

SELECT strcmp(t1,t2) from test_bccf;
 strcmp 
--------
     -1
       
       
      1
     -1
       
       
      0
     -1
       
       
     -1
     -1
       
       
     -1
     -1
       
       
     -1
      1
       
       
      1
     -1
       
       
      1
     -1
       
       
     -1
       
       
       
     -1
     -1
       
       
     -1
     -1
       
       
     -1
      1
       
       
      1
(48 rows)

SELECT strcmp(t2,t1) from test_bccf;
 strcmp 
--------
      1
       
       
     -1
      1
       
       
      0
      1
       
       
      1
      1
       
       
      1
      1
       
       
      1
     -1
       
       
     -1
      1
       
       
     -1
      1
       
       
      1
       
       
       
      1
      1
       
       
      1
      1
       
       
      1
     -1
       
       
     -1
(48 rows)

----------------interval expression------------------------
select interval(null);
ERROR:  syntax error at or near ")"
LINE 1: select interval(null);
                            ^
select interval(null, 123);
 interval 
----------
       -1
(1 row)

select interval(null, 123.45);
 interval 
----------
       -1
(1 row)

select interval(123,null);
 interval 
----------
        1
(1 row)

select interval(123,null,17,43.123);
 interval 
----------
        3
(1 row)

select interval(123.213,null,17,43.123);
 interval 
----------
        3
(1 row)

select interval(100, '10e2');
 interval 
----------
        0
(1 row)

select interval(100, '   10e1');
 interval 
----------
        1
(1 row)

select interval(100, '   10e1', '      10Eeasd');
 interval 
----------
        2
(1 row)

select interval(10e3, '   10e1', '      10E1easd    ', '2e10');
 interval 
----------
        2
(1 row)

select interval(0, '   wa');
 interval 
----------
        1
(1 row)

select interval(0, '   wa', '  e1212');
 interval 
----------
        2
(1 row)

select interval(0, '   abiusdhiw');
 interval 
----------
        1
(1 row)

select interval(0, '   abiusdhiw', '   kqiwjoiqh  ');
 interval 
----------
        2
(1 row)

select interval(0, '   1e12abiusdhiw');
 interval 
----------
        0
(1 row)

select interval(0, '   e13fsdsda');
 interval 
----------
        1
(1 row)

select interval(0, '1e13fsdsda');
 interval 
----------
        0
(1 row)

select interval(100, '1e1fsdsda');
 interval 
----------
        1
(1 row)

select interval('+12', 121);
 interval 
----------
        0
(1 row)

select interval('+12', 12);
 interval 
----------
        1
(1 row)

select interval('+12', 0);
 interval 
----------
        1
(1 row)

select interval('-12', 0);
 interval 
----------
        0
(1 row)

select interval('-12.2', 0);
 interval 
----------
        0
(1 row)

select interval('-.2', 0);
 interval 
----------
        0
(1 row)

select interval('-.2', -100);
 interval 
----------
        1
(1 row)

select interval('-.2E2', -100);
 interval 
----------
        1
(1 row)

select interval('-.2E4', -100);
 interval 
----------
        0
(1 row)

select interval('..', 21);
 interval 
----------
        0
(1 row)

select interval('.21.', 21);
 interval 
----------
        0
(1 row)

select interval('.21.', 0);
 interval 
----------
        1
(1 row)

select interval('+.21.', 0);
 interval 
----------
        1
(1 row)

select interval('-.21.', 0);
 interval 
----------
        0
(1 row)

select interval('-.21.', -1);
 interval 
----------
        1
(1 row)

select interval('-..21.', -1);
 interval 
----------
        1
(1 row)

select interval('...', -1);
 interval 
----------
        1
(1 row)

select interval('...', -1);
 interval 
----------
        1
(1 row)

select interval(123::int2,null);
 interval 
----------
        1
(1 row)

select interval(123::int4,null);
 interval 
----------
        1
(1 row)

select interval(123::int8,null);
 interval 
----------
        1
(1 row)

select interval(123,123.23);
 interval 
----------
        0
(1 row)

select interval(123,123.23::int);
 interval 
----------
        1
(1 row)

select interval(null, '2001-01-01 01:01:01.3654'::date);
 interval 
----------
       -1
(1 row)

select interval('2001-01-01 01:01:01.3654'::date, null);
 interval 
----------
        1
(1 row)

select interval('2001-01-01 01:01:01.3654'::date, '2001-01-01 01:01:01.3654'::date);
 interval 
----------
        1
(1 row)

select interval('2001-01-01 01:01:01.3654'::date, '1999-01-01 01:01:01.3654'::date);
 interval 
----------
        1
(1 row)

select interval('2022-12-12'::timestamp,123);
 interval 
----------
        1
(1 row)

select interval('2022-12-12'::timestamp,'2022-12-12'::timestamp);
 interval 
----------
        1
(1 row)

select interval(123,'2022-12-12'::timestamp);
 interval 
----------
        0
(1 row)

select interval(1,' ');
 interval 
----------
        1
(1 row)

select interval(b'1',' ');
 interval 
----------
        1
(1 row)

select interval('a',' ');
 interval 
----------
        1
(1 row)

select interval(false,' ');
 interval 
----------
        1
(1 row)

select interval(' ',true);
 interval 
----------
        0
(1 row)

select interval(' ',b'1');
 interval 
----------
        0
(1 row)

select interval(' ','a');
 interval 
----------
        1
(1 row)

select interval(' ',12);
 interval 
----------
        0
(1 row)

select interval(t1, t2) from test_bccf;
 interval 
----------
        0
       -1
        1
        1
        0
       -1
        1
        1
        0
       -1
        1
        0
        0
       -1
        1
        1
        0
       -1
        1
        1
        1
       -1
        1
        1
        1
       -1
        1
        1
        0
       -1
        1
        0
        1
       -1
        1
        0
        0
       -1
        1
        1
        0
       -1
        1
        1
        0
       -1
        1
        0
(48 rows)

select interval(t2, t1) from test_bccf;
 interval 
----------
        1
       -1
       -1
        0
        1
       -1
       -1
        1
        1
       -1
       -1
        1
        1
       -1
       -1
        0
        1
       -1
       -1
        0
        0
       -1
       -1
        0
        0
       -1
       -1
        0
        1
       -1
       -1
        1
       -1
       -1
       -1
        1
        1
       -1
       -1
        0
        1
       -1
       -1
        0
        1
       -1
       -1
        1
(48 rows)

drop table test_bccf;
--Type Conversion Test--
set dolphin.b_compatibility_mode to on;
drop table if exists typeset;
NOTICE:  table "typeset" does not exist, skipping
create table typeset (
	tyint TINYINT not null,
	smint SMALLINT not null,
	anint INT not null,
	bgint BIGINT not null,
	dcmal DECIMAL not null,
	nmric NUMERIC not null,
	flt   FLOAT not null,
	bt    BIT(8) not null,
	dt    DATE not null,
	tmstp TIMESTAMP not null,
	tm    TIME not null,
	ch    CHAR(30) not null,
	vch   VARCHAR(30) not null,
	blb   BLOB not null,
	txt   TEXT not null,
	bin   binary,
	vbin  varbinary(50),
	bit   bit(64),
	cset   set('123','124','125')
);
NOTICE:  CREATE TABLE will create implicit set "typeset_cset_set" for column "typeset.cset"
insert into typeset values (
127, 127, 127, 127, 127.234, 127.32, 127.213,
b'01111111', '2001-04-19','2001-04-19', '22:23:44',
'2001-04-19 22:23:44', '2001-04-19 22:23:44', '1233454212',
'2001-04-19 22:23:44', '1', '2001-04-19 22:23:44',0b111111111,'124'
);
select coalesce(tyint, smint) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(tyint, anint) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(tyint, bgint) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(tyint, dcmal) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(tyint, nmric) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(tyint, flt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(tyint, bt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(tyint, dt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(tyint, tmstp) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(tyint, tm) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(tyint, ch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(tyint, vch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(tyint, blb) from typeset;
 coalesce 
----------
 \x313237
(1 row)

select coalesce(tyint, txt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(smint, anint) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(smint, bgint) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(smint, dcmal) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(smint, nmric) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(smint, flt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(smint, bt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(smint, dt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(smint, tmstp) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(smint, tm) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(smint, ch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(smint, vch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(smint, blb) from typeset;
 coalesce 
----------
 \x313237
(1 row)

select coalesce(smint, txt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(anint, bgint) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(anint, dcmal) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(anint, nmric) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(anint, flt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(anint, bt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(anint, dt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(anint, tmstp) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(anint, tm) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(anint, ch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(anint, vch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(anint, blb) from typeset;
 coalesce 
----------
 \x313237
(1 row)

select coalesce(anint, txt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(bgint, dcmal) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(bgint, nmric) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(bgint, flt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(bgint, bt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(bgint, dt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(bgint, tmstp) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(bgint, tm) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(bgint, ch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(bgint, vch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(bgint, blb) from typeset;
 coalesce 
----------
 \x313237
(1 row)

select coalesce(bgint, txt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(dcmal, nmric) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(dcmal, flt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(dcmal, bt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(dcmal, dt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(dcmal, tmstp) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(dcmal, tm) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(dcmal, ch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(dcmal, vch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(dcmal, blb) from typeset;
 coalesce 
----------
 \x313237
(1 row)

select coalesce(dcmal, txt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(nmric, flt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(nmric, bt) from typeset;
 coalesce 
----------
      127
(1 row)

select coalesce(nmric, dt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(nmric, tmstp) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(nmric, tm) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(nmric, ch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(nmric, vch) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(nmric, blb) from typeset;
 coalesce 
----------
 \x313237
(1 row)

select coalesce(nmric, txt) from typeset;
 coalesce 
----------
 127
(1 row)

select coalesce(flt, bt) from typeset;
     coalesce      
-------------------
 127.2129974365234
(1 row)

select coalesce(flt, dt) from typeset;
 coalesce 
----------
 127.213
(1 row)

select coalesce(flt, tmstp) from typeset;
 coalesce 
----------
 127.213
(1 row)

select coalesce(flt, tm) from typeset;
 coalesce 
----------
 127.213
(1 row)

select coalesce(flt, ch) from typeset;
 coalesce 
----------
 127.213
(1 row)

select coalesce(flt, vch) from typeset;
 coalesce 
----------
 127.213
(1 row)

select coalesce(flt, blb) from typeset;
     coalesce     
------------------
 \x3132372e323133
(1 row)

select coalesce(flt, txt) from typeset;
 coalesce 
----------
 127.213
(1 row)

select coalesce(bt, dt) from typeset;
 coalesce 
----------
 \x7f
(1 row)

select coalesce(bt, tmstp) from typeset;
 coalesce 
----------
 \x7f
(1 row)

select coalesce(bt, tm) from typeset;
 coalesce 
----------
 \x7f
(1 row)

select coalesce(bt, ch) from typeset;
 coalesce 
----------
 \x7f
(1 row)

select coalesce(bt, vch) from typeset;
 coalesce 
----------
 \x7f
(1 row)

select coalesce(bt, blb) from typeset;
 coalesce 
----------
 \x7f
(1 row)

select coalesce(bt, txt) from typeset;
 coalesce 
----------
 \x7f
(1 row)

select coalesce(dt, tmstp) from typeset;
      coalesce       
---------------------
 2001-04-19 00:00:00
(1 row)

select coalesce(dt, tm) from typeset;
      coalesce       
---------------------
 2001-04-19 00:00:00
(1 row)

select coalesce(dt, ch) from typeset;
  coalesce  
------------
 2001-04-19
(1 row)

select coalesce(dt, vch) from typeset;
  coalesce  
------------
 2001-04-19
(1 row)

select coalesce(dt, blb) from typeset;
        coalesce        
------------------------
 \x323030312d30342d3139
(1 row)

select coalesce(dt, txt) from typeset;
  coalesce  
------------
 2001-04-19
(1 row)

select coalesce(tmstp, tm) from typeset;
      coalesce       
---------------------
 2001-04-19 00:00:00
(1 row)

select coalesce(tmstp, ch) from typeset;
        coalesce        
------------------------
 2001-04-19 00:00:00-07
(1 row)

select coalesce(tmstp, vch) from typeset;
        coalesce        
------------------------
 2001-04-19 00:00:00-07
(1 row)

select coalesce(tmstp, blb) from typeset;
                    coalesce                    
------------------------------------------------
 \x323030312d30342d31392030303a30303a30302d3037
(1 row)

select coalesce(tmstp, txt) from typeset;
        coalesce        
------------------------
 2001-04-19 00:00:00-07
(1 row)

select coalesce(tm, ch) from typeset;
 coalesce 
----------
 22:23:44
(1 row)

select coalesce(tm, vch) from typeset;
 coalesce 
----------
 22:23:44
(1 row)

select coalesce(tm, blb) from typeset;
      coalesce      
--------------------
 \x32323a32333a3434
(1 row)

select coalesce(tm, txt) from typeset;
 coalesce 
----------
 22:23:44
(1 row)

select coalesce(ch, vch) from typeset;
            coalesce            
--------------------------------
 2001-04-19 22:23:44           
(1 row)

select coalesce(ch, blb) from typeset;
                            coalesce                            
----------------------------------------------------------------
 \x323030312d30342d31392032323a32333a34342020202020202020202020
(1 row)

select coalesce(ch, txt) from typeset;
            coalesce            
--------------------------------
 2001-04-19 22:23:44           
(1 row)

select coalesce(vch, blb) from typeset;
                 coalesce                 
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select coalesce(vch, txt) from typeset;
      coalesce       
---------------------
 2001-04-19 22:23:44
(1 row)

select coalesce(blb, txt) from typeset;
        coalesce        
------------------------
 \x31323333343534323132
(1 row)

select pg_typeof(coalesce(tyint, smint)) from typeset;
 pg_typeof 
-----------
 smallint
(1 row)

select pg_typeof(coalesce(tyint, anint)) from typeset;
 pg_typeof 
-----------
 integer
(1 row)

select pg_typeof(coalesce(tyint, bgint)) from typeset;
 pg_typeof 
-----------
 bigint
(1 row)

select pg_typeof(coalesce(tyint, dcmal)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(tyint, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(tyint, flt)) from typeset;
 pg_typeof 
-----------
 real
(1 row)

select pg_typeof(coalesce(tyint, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(tyint, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tyint, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tyint, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tyint, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tyint, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tyint, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(tyint, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(smint, anint)) from typeset;
 pg_typeof 
-----------
 integer
(1 row)

select pg_typeof(coalesce(smint, bgint)) from typeset;
 pg_typeof 
-----------
 bigint
(1 row)

select pg_typeof(coalesce(smint, dcmal)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(smint, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(smint, flt)) from typeset;
 pg_typeof 
-----------
 real
(1 row)

select pg_typeof(coalesce(smint, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(smint, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(smint, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(smint, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(smint, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(smint, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(smint, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(smint, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(anint, bgint)) from typeset;
 pg_typeof 
-----------
 bigint
(1 row)

select pg_typeof(coalesce(anint, dcmal)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(anint, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(anint, flt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(coalesce(anint, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(anint, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(anint, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(anint, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(anint, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(anint, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(anint, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(anint, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(bgint, dcmal)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(bgint, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(bgint, flt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(coalesce(bgint, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(bgint, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(bgint, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(bgint, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(bgint, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(bgint, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(bgint, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(bgint, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(dcmal, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(dcmal, flt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(coalesce(dcmal, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(dcmal, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(dcmal, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(dcmal, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(dcmal, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(dcmal, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(dcmal, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(dcmal, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(nmric, flt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(coalesce(nmric, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(coalesce(nmric, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(nmric, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(nmric, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(nmric, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(nmric, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(nmric, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(nmric, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(flt, bt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(coalesce(flt, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(flt, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(flt, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(flt, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(flt, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(flt, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(flt, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(bt, dt)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(bt, tmstp)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(bt, tm)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(bt, ch)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(bt, vch)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(bt, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(bt, txt)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(dt, tmstp)) from typeset;
          pg_typeof          
-----------------------------
 timestamp without time zone
(1 row)

select pg_typeof(coalesce(dt, tm)) from typeset;
          pg_typeof          
-----------------------------
 timestamp without time zone
(1 row)

select pg_typeof(coalesce(dt, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(dt, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(dt, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(dt, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tmstp, tm)) from typeset;
          pg_typeof          
-----------------------------
 timestamp without time zone
(1 row)

select pg_typeof(coalesce(tmstp, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tmstp, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tmstp, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(tmstp, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tm, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tm, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(tm, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(tm, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(ch, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(ch, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(ch, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(vch, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(coalesce(vch, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(coalesce(blb, txt)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select ifnull(tyint, smint) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(tyint, anint) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(tyint, bgint) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(tyint, dcmal) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(tyint, nmric) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(tyint, flt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(tyint, bt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(tyint, dt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(tyint, tmstp) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(tyint, tm) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(tyint, ch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(tyint, vch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(tyint, blb) from typeset;
  ifnull  
----------
 \x313237
(1 row)

select ifnull(tyint, txt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(smint, anint) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(smint, bgint) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(smint, dcmal) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(smint, nmric) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(smint, flt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(smint, bt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(smint, dt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(smint, tmstp) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(smint, tm) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(smint, ch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(smint, vch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(smint, blb) from typeset;
  ifnull  
----------
 \x313237
(1 row)

select ifnull(smint, txt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(anint, bgint) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(anint, dcmal) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(anint, nmric) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(anint, flt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(anint, bt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(anint, dt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(anint, tmstp) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(anint, tm) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(anint, ch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(anint, vch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(anint, blb) from typeset;
  ifnull  
----------
 \x313237
(1 row)

select ifnull(anint, txt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(bgint, dcmal) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(bgint, nmric) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(bgint, flt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(bgint, bt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(bgint, dt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(bgint, tmstp) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(bgint, tm) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(bgint, ch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(bgint, vch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(bgint, blb) from typeset;
  ifnull  
----------
 \x313237
(1 row)

select ifnull(bgint, txt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(dcmal, nmric) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(dcmal, flt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(dcmal, bt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(dcmal, dt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(dcmal, tmstp) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(dcmal, tm) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(dcmal, ch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(dcmal, vch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(dcmal, blb) from typeset;
  ifnull  
----------
 \x313237
(1 row)

select ifnull(dcmal, txt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(nmric, flt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(nmric, bt) from typeset;
 ifnull 
--------
    127
(1 row)

select ifnull(nmric, dt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(nmric, tmstp) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(nmric, tm) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(nmric, ch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(nmric, vch) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(nmric, blb) from typeset;
  ifnull  
----------
 \x313237
(1 row)

select ifnull(nmric, txt) from typeset;
 ifnull 
--------
 127
(1 row)

select ifnull(flt, bt) from typeset;
      ifnull       
-------------------
 127.2129974365234
(1 row)

select ifnull(flt, dt) from typeset;
 ifnull  
---------
 127.213
(1 row)

select ifnull(flt, tmstp) from typeset;
 ifnull  
---------
 127.213
(1 row)

select ifnull(flt, tm) from typeset;
 ifnull  
---------
 127.213
(1 row)

select ifnull(flt, ch) from typeset;
 ifnull  
---------
 127.213
(1 row)

select ifnull(flt, vch) from typeset;
 ifnull  
---------
 127.213
(1 row)

select ifnull(flt, blb) from typeset;
      ifnull      
------------------
 \x3132372e323133
(1 row)

select ifnull(flt, txt) from typeset;
 ifnull  
---------
 127.213
(1 row)

select ifnull(bt, dt) from typeset;
 ifnull 
--------
 \x7f
(1 row)

select ifnull(bt, tmstp) from typeset;
 ifnull 
--------
 \x7f
(1 row)

select ifnull(bt, tm) from typeset;
 ifnull 
--------
 \x7f
(1 row)

select ifnull(bt, ch) from typeset;
 ifnull 
--------
 \x7f
(1 row)

select ifnull(bt, vch) from typeset;
 ifnull 
--------
 \x7f
(1 row)

select ifnull(bt, blb) from typeset;
 ifnull 
--------
 \x7f
(1 row)

select ifnull(bt, txt) from typeset;
 ifnull 
--------
 \x7f
(1 row)

select ifnull(dt, tmstp) from typeset;
       ifnull        
---------------------
 2001-04-19 00:00:00
(1 row)

select ifnull(dt, tm) from typeset;
       ifnull        
---------------------
 2001-04-19 00:00:00
(1 row)

select ifnull(dt, ch) from typeset;
   ifnull   
------------
 2001-04-19
(1 row)

select ifnull(dt, vch) from typeset;
   ifnull   
------------
 2001-04-19
(1 row)

select ifnull(dt, blb) from typeset;
         ifnull         
------------------------
 \x323030312d30342d3139
(1 row)

select ifnull(dt, txt) from typeset;
   ifnull   
------------
 2001-04-19
(1 row)

select ifnull(tmstp, tm) from typeset;
       ifnull        
---------------------
 2001-04-19 00:00:00
(1 row)

select ifnull(tmstp, ch) from typeset;
         ifnull         
------------------------
 2001-04-19 00:00:00-07
(1 row)

select ifnull(tmstp, vch) from typeset;
         ifnull         
------------------------
 2001-04-19 00:00:00-07
(1 row)

select ifnull(tmstp, blb) from typeset;
                     ifnull                     
------------------------------------------------
 \x323030312d30342d31392030303a30303a30302d3037
(1 row)

select ifnull(tmstp, txt) from typeset;
         ifnull         
------------------------
 2001-04-19 00:00:00-07
(1 row)

select ifnull(tm, ch) from typeset;
  ifnull  
----------
 22:23:44
(1 row)

select ifnull(tm, vch) from typeset;
  ifnull  
----------
 22:23:44
(1 row)

select ifnull(tm, blb) from typeset;
       ifnull       
--------------------
 \x32323a32333a3434
(1 row)

select ifnull(tm, txt) from typeset;
  ifnull  
----------
 22:23:44
(1 row)

select ifnull(ch, vch) from typeset;
             ifnull             
--------------------------------
 2001-04-19 22:23:44           
(1 row)

select ifnull(ch, blb) from typeset;
                             ifnull                             
----------------------------------------------------------------
 \x323030312d30342d31392032323a32333a34342020202020202020202020
(1 row)

select ifnull(ch, txt) from typeset;
             ifnull             
--------------------------------
 2001-04-19 22:23:44           
(1 row)

select ifnull(vch, blb) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vch, txt) from typeset;
       ifnull        
---------------------
 2001-04-19 22:23:44
(1 row)

select ifnull(blb, txt) from typeset;
         ifnull         
------------------------
 \x31323333343534323132
(1 row)

select ifnull(bin, smint) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, anint) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, bgint) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, dcmal) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, nmric) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, flt) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, bt) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, dt) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, tmstp) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, tm) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, ch) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, vch) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, blb) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(bin, txt) from typeset;
 ifnull 
--------
 \x31
(1 row)

select ifnull(vbin, smint) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, anint) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, bgint) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, dcmal) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, nmric) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, flt) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, bt) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, dt) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, tmstp) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, tm) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, ch) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, vch) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, blb) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select ifnull(vbin, txt) from typeset;
                  ifnull                  
------------------------------------------
 \x323030312d30342d31392032323a32333a3434
(1 row)

select pg_typeof(ifnull(tyint, smint)) from typeset;
 pg_typeof 
-----------
 smallint
(1 row)

select pg_typeof(ifnull(tyint, anint)) from typeset;
 pg_typeof 
-----------
 integer
(1 row)

select pg_typeof(ifnull(tyint, bgint)) from typeset;
 pg_typeof 
-----------
 bigint
(1 row)

select pg_typeof(ifnull(tyint, dcmal)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(tyint, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(tyint, flt)) from typeset;
 pg_typeof 
-----------
 real
(1 row)

select pg_typeof(ifnull(tyint, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(tyint, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tyint, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tyint, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tyint, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tyint, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tyint, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(tyint, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(smint, anint)) from typeset;
 pg_typeof 
-----------
 integer
(1 row)

select pg_typeof(ifnull(smint, bgint)) from typeset;
 pg_typeof 
-----------
 bigint
(1 row)

select pg_typeof(ifnull(smint, dcmal)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(smint, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(smint, flt)) from typeset;
 pg_typeof 
-----------
 real
(1 row)

select pg_typeof(ifnull(smint, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(smint, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(smint, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(smint, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(smint, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(smint, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(smint, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(smint, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(anint, bgint)) from typeset;
 pg_typeof 
-----------
 bigint
(1 row)

select pg_typeof(ifnull(anint, dcmal)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(anint, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(anint, flt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(ifnull(anint, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(anint, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(anint, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(anint, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(anint, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(anint, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(anint, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(anint, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(bgint, dcmal)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(bgint, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(bgint, flt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(ifnull(bgint, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(bgint, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(bgint, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(bgint, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(bgint, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(bgint, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(bgint, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bgint, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(dcmal, nmric)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(dcmal, flt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(ifnull(dcmal, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(dcmal, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(dcmal, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(dcmal, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(dcmal, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(dcmal, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(dcmal, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(dcmal, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(nmric, flt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(ifnull(nmric, bt)) from typeset;
 pg_typeof 
-----------
 number
(1 row)

select pg_typeof(ifnull(nmric, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(nmric, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(nmric, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(nmric, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(nmric, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(nmric, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(nmric, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(flt, bt)) from typeset;
    pg_typeof     
------------------
 double precision
(1 row)

select pg_typeof(ifnull(flt, dt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(flt, tmstp)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(flt, tm)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(flt, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(flt, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(flt, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(flt, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(bt, dt)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bt, tmstp)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bt, tm)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bt, ch)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bt, vch)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bt, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bt, txt)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(dt, tmstp)) from typeset;
          pg_typeof          
-----------------------------
 timestamp without time zone
(1 row)

select pg_typeof(ifnull(dt, tm)) from typeset;
          pg_typeof          
-----------------------------
 timestamp without time zone
(1 row)

select pg_typeof(ifnull(dt, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(dt, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(dt, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(dt, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tmstp, tm)) from typeset;
          pg_typeof          
-----------------------------
 timestamp without time zone
(1 row)

select pg_typeof(ifnull(tmstp, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tmstp, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tmstp, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(tmstp, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tm, ch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tm, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(tm, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(tm, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(ch, vch)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(ch, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(ch, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(vch, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(vch, txt)) from typeset;
 pg_typeof 
-----------
 text
(1 row)

select pg_typeof(ifnull(blb, txt)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bin, smint)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, anint)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, bgint)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, dcmal)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, nmric)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, flt)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, bt)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, dt)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, tmstp)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, tm)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, ch)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, vch)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(bin, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(bin, txt)) from typeset;
 pg_typeof 
-----------
 longblob
(1 row)

select pg_typeof(ifnull(vbin, smint)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, anint)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, bgint)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, dcmal)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, nmric)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, flt)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, bt)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, dt)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, tmstp)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, tm)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, ch)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, vch)) from typeset;
  pg_typeof  
-------------
 `varbinary`
(1 row)

select pg_typeof(ifnull(vbin, blb)) from typeset;
 pg_typeof 
-----------
 blob
(1 row)

select pg_typeof(ifnull(vbin, txt)) from typeset;
 pg_typeof 
-----------
 longblob
(1 row)

reset dolphin.b_compatibility_mode;
select interval(tyint, smint) from typeset;
 interval 
----------
        1
(1 row)

select interval(tyint, anint) from typeset;
 interval 
----------
        1
(1 row)

select interval(tyint, bgint) from typeset;
 interval 
----------
        1
(1 row)

select interval(tyint, dcmal) from typeset;
 interval 
----------
        1
(1 row)

select interval(tyint, nmric) from typeset;
 interval 
----------
        1
(1 row)

select interval(tyint, flt) from typeset;
 interval 
----------
        0
(1 row)

select interval(tyint, bt) from typeset;
 interval 
----------
        1
(1 row)

select interval(tyint, dt) from typeset;
 interval 
----------
        0
(1 row)

select interval(tyint, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(tyint, tm) from typeset;
 interval 
----------
        0
(1 row)

select interval(tyint, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(tyint, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(tyint, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(tyint, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(smint, anint) from typeset;
 interval 
----------
        1
(1 row)

select interval(smint, bgint) from typeset;
 interval 
----------
        1
(1 row)

select interval(smint, dcmal) from typeset;
 interval 
----------
        1
(1 row)

select interval(smint, nmric) from typeset;
 interval 
----------
        1
(1 row)

select interval(smint, flt) from typeset;
 interval 
----------
        0
(1 row)

select interval(smint, bt) from typeset;
 interval 
----------
        1
(1 row)

select interval(smint, dt) from typeset;
 interval 
----------
        0
(1 row)

select interval(smint, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(smint, tm) from typeset;
 interval 
----------
        0
(1 row)

select interval(smint, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(smint, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(smint, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(smint, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(anint, bgint) from typeset;
 interval 
----------
        1
(1 row)

select interval(anint, dcmal) from typeset;
 interval 
----------
        1
(1 row)

select interval(anint, nmric) from typeset;
 interval 
----------
        1
(1 row)

select interval(anint, flt) from typeset;
 interval 
----------
        0
(1 row)

select interval(anint, bt) from typeset;
 interval 
----------
        1
(1 row)

select interval(anint, dt) from typeset;
 interval 
----------
        0
(1 row)

select interval(anint, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(anint, tm) from typeset;
 interval 
----------
        0
(1 row)

select interval(anint, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(anint, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(anint, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(anint, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(bgint, dcmal) from typeset;
 interval 
----------
        1
(1 row)

select interval(bgint, nmric) from typeset;
 interval 
----------
        1
(1 row)

select interval(bgint, flt) from typeset;
 interval 
----------
        0
(1 row)

select interval(bgint, bt) from typeset;
 interval 
----------
        1
(1 row)

select interval(bgint, dt) from typeset;
 interval 
----------
        0
(1 row)

select interval(bgint, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(bgint, tm) from typeset;
 interval 
----------
        0
(1 row)

select interval(bgint, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(bgint, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(bgint, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(bgint, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(dcmal, nmric) from typeset;
 interval 
----------
        1
(1 row)

select interval(dcmal, flt) from typeset;
 interval 
----------
        0
(1 row)

select interval(dcmal, bt) from typeset;
 interval 
----------
        1
(1 row)

select interval(dcmal, dt) from typeset;
 interval 
----------
        0
(1 row)

select interval(dcmal, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(dcmal, tm) from typeset;
 interval 
----------
        0
(1 row)

select interval(dcmal, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(dcmal, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(dcmal, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(dcmal, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(nmric, flt) from typeset;
 interval 
----------
        0
(1 row)

select interval(nmric, bt) from typeset;
 interval 
----------
        1
(1 row)

select interval(nmric, dt) from typeset;
 interval 
----------
        0
(1 row)

select interval(nmric, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(nmric, tm) from typeset;
 interval 
----------
        0
(1 row)

select interval(nmric, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(nmric, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(nmric, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(nmric, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(flt, bt) from typeset;
 interval 
----------
        1
(1 row)

select interval(flt, dt) from typeset;
 interval 
----------
        0
(1 row)

select interval(flt, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(flt, tm) from typeset;
 interval 
----------
        0
(1 row)

select interval(flt, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(flt, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(flt, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(flt, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(bt, dt) from typeset;
 interval 
----------
        0
(1 row)

select interval(bt, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(bt, tm) from typeset;
 interval 
----------
        0
(1 row)

select interval(bt, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(bt, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(bt, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(bt, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(dt, tmstp) from typeset;
 interval 
----------
        0
(1 row)

select interval(dt, tm) from typeset;
 interval 
----------
        1
(1 row)

select interval(dt, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(dt, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(dt, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(dt, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(tmstp, tm) from typeset;
 interval 
----------
        1
(1 row)

select interval(tmstp, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(tmstp, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(tmstp, blb) from typeset;
 interval 
----------
        1
(1 row)

select interval(tmstp, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(tm, ch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(tm, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(tm, blb) from typeset;
 interval 
----------
        0
(1 row)

select interval(tm, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(ch, vch) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(ch, blb) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(ch, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44           "
CONTEXT:  referenced column: interval
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(vch, blb) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        0
(1 row)

select interval(vch, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

select interval(blb, txt) from typeset;
WARNING:  invalid input syntax for type double precision: "2001-04-19 22:23:44"
CONTEXT:  referenced column: interval
 interval 
----------
        1
(1 row)

set dolphin.b_compatibility_mode to on; 
select strcmp(tyint, smint) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(tyint, anint) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(tyint, bgint) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(tyint, dcmal) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(tyint, nmric) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(tyint, flt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tyint, bt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tyint, dt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tyint, tmstp) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tyint, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tyint, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tyint, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tyint, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(tyint, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(smint, anint) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(smint, bgint) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(smint, dcmal) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(smint, nmric) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(smint, flt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(smint, bt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(smint, dt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(smint, tmstp) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(smint, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(smint, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(smint, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(smint, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(smint, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(anint, bgint) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(anint, dcmal) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(anint, nmric) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(anint, flt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(anint, bt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(anint, dt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(anint, tmstp) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(anint, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(anint, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(anint, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(anint, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(anint, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bgint, dcmal) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(bgint, nmric) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(bgint, flt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bgint, bt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bgint, dt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bgint, tmstp) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bgint, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bgint, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bgint, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bgint, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(bgint, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dcmal, nmric) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(dcmal, flt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dcmal, bt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dcmal, dt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dcmal, tmstp) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dcmal, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dcmal, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dcmal, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dcmal, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(dcmal, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(nmric, flt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(nmric, bt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(nmric, dt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(nmric, tmstp) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(nmric, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(nmric, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(nmric, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(nmric, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(nmric, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(flt, bt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(flt, dt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(flt, tmstp) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(flt, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(flt, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(flt, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(flt, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(flt, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(bt, dt) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(bt, tmstp) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(bt, tm) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(bt, ch) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(bt, vch) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(bt, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(bt, txt) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(dt, tmstp) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dt, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dt, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dt, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(dt, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(dt, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tmstp, tm) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tmstp, ch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tmstp, vch) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tmstp, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(tmstp, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tm, ch) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(tm, vch) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(tm, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(tm, txt) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(ch, vch) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(ch, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(ch, txt) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(vch, blb) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(vch, txt) from typeset;
 strcmp 
--------
      0
(1 row)

select strcmp(blb, txt) from typeset;
 strcmp 
--------
     -1
(1 row)

select strcmp(tyint, cset) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp(tyint, bit) from typeset;
 strcmp 
--------
      1
(1 row)

select strcmp('123   ','123');
 strcmp 
--------
      0
(1 row)

create table t1 (a int, b bigint unsigned);
create table t2 (c int);
insert into t1 (a, b) values (1,4572794622775114594), (2,18196094287899841997),
(3,11120436154190595086);
insert into t2 (c) values (1), (2), (3);
select case t1.a when 0 then 0 else t1.b end from t1 order by a;
          b           
----------------------
 4572794622775114594
 18196094287899841997
 11120436154190595086
(3 rows)

select t1.a, (case t1.a when 0 then 0 else t1.b end) d from t1
join t2 on t1.a=t2.c order by d;
 a |          d           
---+----------------------
 1 | 4572794622775114594
 3 | 11120436154190595086
 2 | 18196094287899841997
(3 rows)

drop table t1;
drop table t2;
drop schema db_test_condition cascade;
NOTICE:  drop cascades to 2 other objects
DETAIL:  drop cascades to type typeset_cset_set
drop cascades to table typeset
reset current_schema;
