create schema db_b_parser3;
set current_schema to 'db_b_parser3';
--测试点一：验证lcase函数
select lcase('ABc'), lcase('哈哈'), lcase('123456'),lcase('哈市&%%￥#'),lcase(null);
 lcase | lcase | lcase  |   lcase    | lcase 
-------+-------+--------+------------+-------
 abc   | 哈哈  | 123456 | 哈市&%%￥# | 
(1 row)

--测试点二：验证lower函数
select lower('ABc'), lower('哈哈'), lower('123456'),lower('哈市&%%￥#'),lower(null);
 lower | lower | lower  |   lower    | lower 
-------+-------+--------+------------+-------
 abc   | 哈哈  | 123456 | 哈市&%%￥# | 
(1 row)

--测试点三：验证ucase函数
select ucase('ABc'), ucase('哈哈'), ucase('123456'),ucase('哈市&%%￥#'),ucase(null);
 ucase | ucase | ucase  |   ucase    | ucase 
-------+-------+--------+------------+-------
 ABC   | 哈哈  | 123456 | 哈市&%%￥# | 
(1 row)

select upper('ABc'), upper('哈哈'), upper('123456'),upper('哈市&%%￥#'),upper(null);
 upper | upper | upper  |   upper    | upper 
-------+-------+--------+------------+-------
 ABC   | 哈哈  | 123456 | 哈市&%%￥# | 
(1 row)

--测试点四：验证rand和random_bytes函数
select rand(18446744073709551615) = rand(18446744073709551616);
WARNING:  Truncated incorrect DECIMAL value
 ?column? 
----------
 t
(1 row)

select rand(-9223372036854775808) = rand(-9223372036854775809);
WARNING:  Truncated incorrect DECIMAL value
 ?column? 
----------
 t
(1 row)

select rand(0) = rand(4294967296);
 ?column? 
----------
 t
(1 row)

select rand(1) = rand(4294967297);
 ?column? 
----------
 t
(1 row)

select rand(0) = rand(null);
 ?column? 
----------
 t
(1 row)

select random_bytes(null);
 random_bytes 
--------------
 
(1 row)

select random_bytes(0);
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: random_bytes
select random_bytes(1);
 random_bytes 
--------------
--?.*
(1 row)

select random_bytes(1024);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           random_bytes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--?.*
(1 row)

select random_bytes(1025);
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: random_bytes
set dolphin.b_compatibility_mode to on;
CREATE TABLE test_type_table
(
    `int1` tinyint,
    `uint1` tinyint unsigned,
    `int2` smallint,
    `uint2` smallint unsigned,
    `int4` integer,
    `uint4` integer unsigned,
    `int8` bigint,
    `uint8` bigint unsigned,
    `float4` float4,
    `float8` float8,
    `numeric` decimal(20, 6),
    `bit1` bit(1),
    `bit64` bit(64),
    `boolean` boolean,
    `date` date,
    `time` time,
    `time(4)` time(4),
    `datetime` datetime,
    `datetime(4)` datetime(4) default '2022-11-11 11:11:11',
    `timestamp` timestamp,
    `timestamp(4)` timestamp(4) default '2022-11-11 11:11:11',
    `year` year,
    `char` char(100),
    `varchar` varchar(100),
    `binary` binary(100),
    `varbinary` varbinary(100),
    `tinyblob` tinyblob,
    `blob` blob,
    `mediumblob` mediumblob,
    `longblob` longblob,
    `text` text,
    `enum_t` enum('a', 'b', 'c'),
    `set_t` set('a', 'b', 'c'),
    `json` json
);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_set_t_set" for column "test_type_table.set_t"
insert into test_type_table values(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,b'1', b'111', true,'2023-02-05', '19:10:50', '19:10:50.3456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023-02-05 19:10:50', '2023-02-05 19:10:50.456', '2023','1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a', '1.23a','a', 'a,c',json_object('a', 1, 'b', 2));
select
rand(`int1`)=rand(cast(`int1` as signed)),
rand(`uint1`)=rand(cast(`uint1` as signed)),
rand(`int2`)=rand(cast(`int2` as signed)),
rand(`uint2`)=rand(cast(`uint2` as signed)),
rand(`int4`)=rand(cast(`int4` as signed)),
rand(`uint4`)=rand(cast(`uint4` as signed)),
rand(`int8`)=rand(cast(`int8` as signed)),
rand(`uint8`)=rand(cast(`uint8` as signed)),
rand(`float4`)=rand(cast(`float4` as signed)),
rand(`float8`)=rand(cast(`float8` as signed)),
rand(`numeric`)=rand(cast(`numeric` as signed)),
--rand(`bit1`)=rand(cast(`bit1` as signed)),
--rand(`bit64`)=rand(cast(`bit64` as signed)),
rand(`boolean`)=rand(cast(`boolean` as signed)),
rand(`date`)=rand(cast(`date` as signed)),
--rand(`time`)=rand(cast(`time` as signed)),
--rand(`time(4)`)=rand(cast(`time(4)` as signed)),
rand(`datetime`)=rand(cast(`datetime` as signed)),
rand(`datetime(4)`)=rand(cast(`datetime(4)` as signed)),
rand(`timestamp`)=rand(cast(`timestamp` as signed)),
rand(`timestamp(4)`)=rand(cast(`timestamp(4)` as signed)),
rand(`year`)=rand(cast(`year` as int4)),
--rand(`char`)=rand(cast(`char` as int4)),
--rand(`varchar`)=rand(cast(`varchar` as int4)),
rand(`binary`)=rand(cast(`binary` as signed)),
rand(`varbinary`)=rand(cast(`varbinary` as signed)),
rand(`tinyblob`)=rand(cast(`tinyblob` as signed)),
rand(`blob`)=rand(cast(`blob` as signed)),
rand(`mediumblob`)=rand(cast(`mediumblob` as signed)),
rand(`longblob`)=rand(cast(`longblob` as signed)),
--rand(`text`)=rand(cast(`text` as int4)),
rand(`enum_t`)=rand(cast(`enum_t` as float8)),
rand(`set_t`)=rand(cast(`set_t` as signed)),
rand(`json`)=rand(cast(`json` as float8))
from test_type_table;
WARNING:  invalid input syntax for type bigint: "\x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
WARNING:  invalid input syntax for type bigint: "\x312e3233610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type bigint: "\x312e323361"
WARNING:  invalid input syntax for type double precision: "{"a": 1, "b": 2}"
WARNING:  invalid input syntax for type double precision: "{"a": 1, "b": 2}"
 ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? | ?column? 
----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------
 t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t        | t
(1 row)

select
length(random_bytes(`int1`)::binary),
length(random_bytes(`uint1`)::binary),
length(random_bytes(`int2`)::binary),
length(random_bytes(`uint2`)::binary),
length(random_bytes(`int4`)::binary),
length(random_bytes(`uint4`)::binary),
length(random_bytes(`int8`)::binary),
length(random_bytes(`uint8`)::binary),
length(random_bytes(`float4`)::binary),
length(random_bytes(`float8`)::binary),
length(random_bytes(`numeric`)::binary),
length(random_bytes(`bit1`)::binary),
length(random_bytes(`bit64`)::binary),
length(random_bytes(`boolean`)::binary),
length(random_bytes(`char`)::binary),
length(random_bytes(`varchar`)::binary),
--length(random_bytes(`binary`)::binary),
--length(random_bytes(`varbinary`)::binary),
--length(random_bytes(`tinyblob`)::binary),
--length(random_bytes(`blob`)::binary),
--length(random_bytes(`mediumblob`)::binary),
--length(random_bytes(`longblob`)::binary),
length(random_bytes(`text`)::binary),
length(random_bytes(`enum_t`)::binary),
length(random_bytes(`set_t`)::binary)
from test_type_table;
WARNING:  invalid input syntax for type bigint: "1.23a                                                                                               "
CONTEXT:  referenced column: length
WARNING:  invalid input syntax for type bigint: "1.23a"
CONTEXT:  referenced column: length
WARNING:  invalid input syntax for type bigint: "1.23a"
CONTEXT:  referenced column: length
 length | length | length | length | length | length | length | length | length | length | length | length | length | length | length | length | length | length | length 
--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------
      1 |      1 |      1 |      1 |      1 |      1 |      1 |      1 |      1 |      1 |      1 |      1 |      7 |      1 |      1 |      1 |      1 |      1 |      5
(1 row)

--error, cause value out of range
select length(random_bytes(`date`)::binary) from test_type_table;
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
select length(random_bytes(`time`)::binary) from test_type_table;
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
select length(random_bytes(`time(4)`)::binary) from test_type_table;
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
select length(random_bytes(`datetime`)::binary) from test_type_table;
WARNING:  integer out of range
CONTEXT:  referenced column: length
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
select length(random_bytes(`datetime(4)`)::binary) from test_type_table;
WARNING:  integer out of range
CONTEXT:  referenced column: length
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
select length(random_bytes(`timestamp`)::binary) from test_type_table;
WARNING:  integer out of range
CONTEXT:  referenced column: length
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
select length(random_bytes(`timestamp(4)`)::binary) from test_type_table;
WARNING:  integer out of range
CONTEXT:  referenced column: length
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
select length(random_bytes(`year`)::binary)from test_type_table;
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
select length(random_bytes(`json`)::binary)from test_type_table;
WARNING:  invalid input syntax for type double precision: "{"a": 1, "b": 2}"
CONTEXT:  referenced column: length
ERROR:  length value is out of range in 'random_bytes'
CONTEXT:  referenced column: length
drop table test_type_table;
reset dolphin.b_compatibility_mode;
--hex number
select 0x123 = x'123';
 ?column? 
----------
 t
(1 row)

select 0x123;
   ?column?   
--------------
 000100100011
(1 row)

select 0xfe = x'FE';
 ?column? 
----------
 t
(1 row)

select 0xFE = x'fe';
 ?column? 
----------
 t
(1 row)

select 0xG123; --equal to select 0 xG123;
 xG123 
-------
     0
(1 row)

select 0x123G; --equal to select 0x123 G;
      G       
--------------
 000100100011
(1 row)

select 0x; --equal to select 0 x;
 x 
---
 0
(1 row)

--测试点五：验证truncate函数
select truncate(111.28);--返回111
ERROR:  function truncate(number) does not exist
LINE 1: select truncate(111.28);
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: truncate
select truncate(111.28,0);--返回111
 truncate 
----------
      111
(1 row)

select truncate(111.28,1);--返回111.2
 truncate 
----------
    111.2
(1 row)

select truncate(111.28,5);
 truncate  
-----------
 111.28000
(1 row)

select truncate(111.28,500);
                                                                                                                                                                                                                                                         truncate                                                                                                                                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 111.28000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(1 row)

select truncate(111.28,-1);--返回110
 truncate 
----------
      110
(1 row)

select truncate(111.28,-4);--返回0
 truncate 
----------
        0
(1 row)

select  trunc(111.28),  trunc(111.28,0),  trunc(111.28,1),   trunc(111.28,5),   trunc(111.28,500),   trunc(111.28,-1),    trunc(111.28,-4);
 trunc | trunc | trunc |   trunc   |                                                                                                                                                                                                                                                          trunc                                                                                                                                                                                                                                                           | trunc | trunc 
-------+-------+-------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+-------
   111 |   111 | 111.2 | 111.28000 | 111.28000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 |   110 |     0
(1 row)

--测试点六：验证current_date
--测试点一：验证:=操作符
--step4:建表;expect:创建成功
drop table if exists tb_db_b_parser0003;
NOTICE:  table "tb_db_b_parser0003" does not exist, skipping
create table tb_db_b_parser0003(a1 int, a2 int);
insert into tb_db_b_parser0003 select generate_series(1,5);
--step5:使用:=(赋值)操作符修改a1列值;
update tb_db_b_parser0003 set a1 := 11;
--step6:使用:=(赋值)操作符同时修改a1,a2列值;
update tb_db_b_parser0003 set (a1,a2) := (12,13);
--step7:使用:=(赋值)操作符,修改参数值;
show io_limits; --默认是0
 io_limits 
-----------
 0
(1 row)

set io_limits := 100;
--alter system set设置参数值
alter system set pagewriter_thread_num := 5;
NOTICE:  please restart the database for the POSTMASTER level parameter to take effect.
--测试点二：验证div操作符
select 8div3;--8
 div3 
------
    8
(1 row)

select 8 div3;--结果为8
 div3 
------
    8
(1 row)

select 8 div 3;
 div 
-----
   2
(1 row)

select 8 div 0;
 div 
-----
    
(1 row)

select 8div 3, 8div 3div2, 8div 3div 2;
 div | div2 | div 
-----+------+-----
   2 |    2 |   1
(1 row)

select 8 div;
ERROR:  syntax error at or near ";"
LINE 1: select 8 div;
                    ^
select 8 as div;
 div 
-----
   8
(1 row)

select div 1;
ERROR:  syntax error at or near "1"
LINE 1: select div 1;
                   ^
-- without binary as numeric
select '-12.3abc' div null;
WARNING:  invalid input syntax for type numeric: "\x2d31322e33616263"
CONTEXT:  PL/pgSQL function "div"("binary","binary") line 4 during statement block local variable initialization
referenced column: div
 div 
-----
    
(1 row)

select '-12.3abc' div -100.1;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' div -100.1;
               ^
CONTEXT:  referenced column: div
 div 
-----
   0
(1 row)

select '-12.3abc' div 0;
WARNING:  invalid input syntax for type numeric: "\x2d31322e33616263"
CONTEXT:  PL/pgSQL function "div"("binary",double precision) line 4 during statement block local variable initialization
referenced column: div
 div 
-----
    
(1 row)

select '-12.3abc' div 5;
WARNING:  invalid input syntax for type numeric: "\x2d31322e33616263"
CONTEXT:  PL/pgSQL function "div"("binary",double precision) line 4 during statement block local variable initialization
referenced column: div
 div 
-----
   0
(1 row)

select '-12.3abc' div 158.3;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' div 158.3;
               ^
CONTEXT:  referenced column: div
 div 
-----
   0
(1 row)

select '-12.3abc' div -8.222e4;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' div -8.222e4;
               ^
CONTEXT:  referenced column: div
 div 
-----
   0
(1 row)

select '-12.3abc' div true;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' div true;
               ^
CONTEXT:  referenced column: div
 div 
-----
 -12
(1 row)

select '-12.3abc' div false;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' div false;
               ^
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select '-12.3abc' div 'null';
WARNING:  invalid input syntax for type numeric: "\x2d31322e33616263"
CONTEXT:  PL/pgSQL function "div"("binary","binary") line 4 during statement block local variable initialization
referenced column: div
WARNING:  invalid input syntax for type numeric: "\x6e756c6c"
CONTEXT:  PL/pgSQL function "div"("binary","binary") line 4 during statement block local variable initialization
referenced column: div
 div 
-----
    
(1 row)

select 123456 div 5 div 4;
 div  
------
 6172
(1 row)

select 8 div 1 where 100 div 3 div 4 = 0;
 div 
-----
(0 rows)

select 8 div 3 where 100 div 3 div 4 > 0;
 div 
-----
   2
(1 row)

set dolphin.b_compatibility_mode to on;
create table tmp_res(a int);
create table div_test(
c1 int1,
c2 int2,
c3 int4,
c4 int8,
c5 uint1,
c6 uint2,
c7 uint4,
c8 uint8,
c9 float,
c10 double,
c11 numeric,
c12 bit,
c13 binary,
c14 interval,
c15 json);
insert into div_test values(0,0,0,0,0,0,0,0,0,0,0,b'0',0,0,'{"0":"0"}');
-- strict mode only, no warning and error
set dolphin.sql_mode = 'sql_mode_strict';
select c1/c1 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c2 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c3 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c4 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c5 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c6 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c7 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c8 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c9 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c10 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c11 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c12 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c13 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c14 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c15 from div_test;
WARNING:  invalid input syntax for type double precision: "{"0":"0"}"
 ?column? 
----------
         
(1 row)

select c1 mod c1 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c2 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c3 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c4 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c5 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c6 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c7 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c8 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c9 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c10 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c11 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c12 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c13 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, `binary`) does not exist
LINE 1: select c1 mod c13 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
select c1 mod c14 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c15 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, json) does not exist
LINE 1: select c1 mod c15 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
select c1 div c1 from div_test;
 div 
-----
    
(1 row)

select c1 div c2 from div_test;
 div 
-----
    
(1 row)

select c1 div c3 from div_test;
 div 
-----
    
(1 row)

select c1 div c4 from div_test;
 div 
-----
    
(1 row)

select c1 div c5 from div_test;
 div 
-----
    
(1 row)

select c1 div c6 from div_test;
 div 
-----
    
(1 row)

select c1 div c7 from div_test;
 div 
-----
    
(1 row)

select c1 div c8 from div_test;
 div 
-----
    
(1 row)

select c1 div c9 from div_test;
 div 
-----
    
(1 row)

select c1 div c10 from div_test;
 div 
-----
    
(1 row)

select c1 div c11 from div_test;
 div 
-----
    
(1 row)

select c1 div c12 from div_test;
 div 
-----
    
(1 row)

select c1 div c13 from div_test;
WARNING:  invalid input syntax for type numeric: "\x30"
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
 div 
-----
    
(1 row)

select c1 div c14 from div_test;
 div 
-----
    
(1 row)

select c1 div c15 from div_test;
ERROR:  function pg_catalog.div(tinyint, json) does not exist
LINE 1: select c1 div c15 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: div
insert into tmp_res select c1/c1 from div_test;
insert into tmp_res select c1/c2 from div_test;
insert into tmp_res select c1/c3 from div_test;
insert into tmp_res select c1/c4 from div_test;
insert into tmp_res select c1/c5 from div_test;
insert into tmp_res select c1/c6 from div_test;
insert into tmp_res select c1/c7 from div_test;
insert into tmp_res select c1/c8 from div_test;
insert into tmp_res select c1/c9 from div_test;
insert into tmp_res select c1/c10 from div_test;
insert into tmp_res select c1/c11 from div_test;
insert into tmp_res select c1/c12 from div_test;
insert into tmp_res select c1/c13 from div_test;
insert into tmp_res select c1/c14 from div_test;
insert into tmp_res select c1/c15 from div_test;
ERROR:  invalid input syntax for type double precision: "{"0":"0"}"
CONTEXT:  referenced column: a
insert into tmp_res select c1 mod c1 from div_test;
insert into tmp_res select c1 mod c2 from div_test;
insert into tmp_res select c1 mod c3 from div_test;
insert into tmp_res select c1 mod c4 from div_test;
insert into tmp_res select c1 mod c5 from div_test;
insert into tmp_res select c1 mod c6 from div_test;
insert into tmp_res select c1 mod c7 from div_test;
insert into tmp_res select c1 mod c8 from div_test;
insert into tmp_res select c1 mod c9 from div_test;
insert into tmp_res select c1 mod c10 from div_test;
insert into tmp_res select c1 mod c11 from div_test;
insert into tmp_res select c1 mod c12 from div_test;
insert into tmp_res select c1 mod c13 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, `binary`) does not exist
LINE 1: insert into tmp_res select c1 mod c13 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
insert into tmp_res select c1 mod c14 from div_test;
insert into tmp_res select c1 mod c15 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, json) does not exist
LINE 1: insert into tmp_res select c1 mod c15 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
insert into tmp_res select c1 div c1 from div_test;
insert into tmp_res select c1 div c2 from div_test;
insert into tmp_res select c1 div c3 from div_test;
insert into tmp_res select c1 div c4 from div_test;
insert into tmp_res select c1 div c5 from div_test;
insert into tmp_res select c1 div c6 from div_test;
insert into tmp_res select c1 div c7 from div_test;
insert into tmp_res select c1 div c8 from div_test;
insert into tmp_res select c1 div c9 from div_test;
insert into tmp_res select c1 div c10 from div_test;
insert into tmp_res select c1 div c11 from div_test;
insert into tmp_res select c1 div c12 from div_test;
insert into tmp_res select c1 div c13 from div_test;
ERROR:  invalid input syntax for type numeric: "\x30"
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
insert into tmp_res select c1 div c14 from div_test;
insert into tmp_res select c1 div c15 from div_test;
ERROR:  function pg_catalog.div(tinyint, json) does not exist
LINE 1: insert into tmp_res select c1 div c15 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: div
-- non-strict mode and non-err_division_by_zero, no warning and error
set dolphin.sql_mode = '';
select c1/c1 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c2 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c3 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c4 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c5 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c6 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c7 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c8 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c9 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c10 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c11 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c12 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c13 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c14 from div_test;
 ?column? 
----------
         
(1 row)

select c1/c15 from div_test;
WARNING:  invalid input syntax for type double precision: "{"0":"0"}"
 ?column? 
----------
         
(1 row)

select c1 mod c1 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c2 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c3 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c4 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c5 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c6 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c7 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c8 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c9 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c10 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c11 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c12 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c13 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, `binary`) does not exist
LINE 1: select c1 mod c13 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
select c1 mod c14 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c15 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, json) does not exist
LINE 1: select c1 mod c15 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
select c1 div c1 from div_test;
 div 
-----
    
(1 row)

select c1 div c2 from div_test;
 div 
-----
    
(1 row)

select c1 div c3 from div_test;
 div 
-----
    
(1 row)

select c1 div c4 from div_test;
 div 
-----
    
(1 row)

select c1 div c5 from div_test;
 div 
-----
    
(1 row)

select c1 div c6 from div_test;
 div 
-----
    
(1 row)

select c1 div c7 from div_test;
 div 
-----
    
(1 row)

select c1 div c8 from div_test;
 div 
-----
    
(1 row)

select c1 div c9 from div_test;
 div 
-----
    
(1 row)

select c1 div c10 from div_test;
 div 
-----
    
(1 row)

select c1 div c11 from div_test;
 div 
-----
    
(1 row)

select c1 div c12 from div_test;
 div 
-----
    
(1 row)

select c1 div c13 from div_test;
WARNING:  invalid input syntax for type numeric: "\x30"
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
 div 
-----
    
(1 row)

select c1 div c14 from div_test;
 div 
-----
    
(1 row)

select c1 div c15 from div_test;
ERROR:  function pg_catalog.div(tinyint, json) does not exist
LINE 1: select c1 div c15 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: div
insert into tmp_res select c1/c1 from div_test;
insert into tmp_res select c1/c2 from div_test;
insert into tmp_res select c1/c3 from div_test;
insert into tmp_res select c1/c4 from div_test;
insert into tmp_res select c1/c5 from div_test;
insert into tmp_res select c1/c6 from div_test;
insert into tmp_res select c1/c7 from div_test;
insert into tmp_res select c1/c8 from div_test;
insert into tmp_res select c1/c9 from div_test;
insert into tmp_res select c1/c10 from div_test;
insert into tmp_res select c1/c11 from div_test;
insert into tmp_res select c1/c12 from div_test;
insert into tmp_res select c1/c13 from div_test;
insert into tmp_res select c1/c14 from div_test;
insert into tmp_res select c1/c15 from div_test;
WARNING:  invalid input syntax for type double precision: "{"0":"0"}"
CONTEXT:  referenced column: a
insert into tmp_res select c1 mod c1 from div_test;
insert into tmp_res select c1 mod c2 from div_test;
insert into tmp_res select c1 mod c3 from div_test;
insert into tmp_res select c1 mod c4 from div_test;
insert into tmp_res select c1 mod c5 from div_test;
insert into tmp_res select c1 mod c6 from div_test;
insert into tmp_res select c1 mod c7 from div_test;
insert into tmp_res select c1 mod c8 from div_test;
insert into tmp_res select c1 mod c9 from div_test;
insert into tmp_res select c1 mod c10 from div_test;
insert into tmp_res select c1 mod c11 from div_test;
insert into tmp_res select c1 mod c12 from div_test;
insert into tmp_res select c1 mod c13 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, `binary`) does not exist
LINE 1: insert into tmp_res select c1 mod c13 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
insert into tmp_res select c1 mod c14 from div_test;
insert into tmp_res select c1 mod c15 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, json) does not exist
LINE 1: insert into tmp_res select c1 mod c15 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
insert into tmp_res select c1 div c1 from div_test;
insert into tmp_res select c1 div c2 from div_test;
insert into tmp_res select c1 div c3 from div_test;
insert into tmp_res select c1 div c4 from div_test;
insert into tmp_res select c1 div c5 from div_test;
insert into tmp_res select c1 div c6 from div_test;
insert into tmp_res select c1 div c7 from div_test;
insert into tmp_res select c1 div c8 from div_test;
insert into tmp_res select c1 div c9 from div_test;
insert into tmp_res select c1 div c10 from div_test;
insert into tmp_res select c1 div c11 from div_test;
insert into tmp_res select c1 div c12 from div_test;
insert into tmp_res select c1 div c13 from div_test;
WARNING:  invalid input syntax for type numeric: "\x30"
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
insert into tmp_res select c1 div c14 from div_test;
insert into tmp_res select c1 div c15 from div_test;
ERROR:  function pg_catalog.div(tinyint, json) does not exist
LINE 1: insert into tmp_res select c1 div c15 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: div
-- strict mode and err_division_by_zero, select warning, insert error
set dolphin.sql_mode = 'sql_mode_strict,ERROR_FOR_DIVISION_BY_ZERO';
select c1/c1 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c2 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c3 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c4 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c5 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c6 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c7 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c8 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c9 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c10 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c11 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c12 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c13 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c14 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c15 from div_test;
WARNING:  invalid input syntax for type double precision: "{"0":"0"}"
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1 mod c1 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c2 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c3 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c4 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c5 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c6 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c7 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c8 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c9 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c10 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c11 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c12 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c13 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, `binary`) does not exist
LINE 1: select c1 mod c13 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
select c1 mod c14 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c15 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, json) does not exist
LINE 1: select c1 mod c15 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
select c1 div c1 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c2 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c3 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c4 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c5 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c6 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c7 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c8 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c9 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c10 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c11 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c12 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c13 from div_test;
WARNING:  invalid input syntax for type numeric: "\x30"
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
WARNING:  division by zero
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
 div 
-----
    
(1 row)

select c1 div c14 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c15 from div_test;
ERROR:  function pg_catalog.div(tinyint, json) does not exist
LINE 1: select c1 div c15 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: div
insert into tmp_res select c1/c1 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c2 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c3 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c4 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c5 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c6 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c7 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c8 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c9 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c10 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c11 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c12 from div_test;
ERROR:  division by zero
insert into tmp_res select c1/c13 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c14 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c15 from div_test;
ERROR:  invalid input syntax for type double precision: "{"0":"0"}"
CONTEXT:  referenced column: a
insert into tmp_res select c1 mod c1 from div_test;
insert into tmp_res select c1 mod c2 from div_test;
insert into tmp_res select c1 mod c3 from div_test;
insert into tmp_res select c1 mod c4 from div_test;
insert into tmp_res select c1 mod c5 from div_test;
insert into tmp_res select c1 mod c6 from div_test;
insert into tmp_res select c1 mod c7 from div_test;
insert into tmp_res select c1 mod c8 from div_test;
insert into tmp_res select c1 mod c9 from div_test;
insert into tmp_res select c1 mod c10 from div_test;
insert into tmp_res select c1 mod c11 from div_test;
insert into tmp_res select c1 mod c12 from div_test;
insert into tmp_res select c1 mod c13 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, `binary`) does not exist
LINE 1: insert into tmp_res select c1 mod c13 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
insert into tmp_res select c1 mod c14 from div_test;
insert into tmp_res select c1 mod c15 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, json) does not exist
LINE 1: insert into tmp_res select c1 mod c15 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
insert into tmp_res select c1 div c1 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c2 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c3 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c4 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c5 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c6 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c7 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c8 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c9 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c10 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c11 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c12 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: div
insert into tmp_res select c1 div c13 from div_test;
ERROR:  invalid input syntax for type numeric: "\x30"
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
insert into tmp_res select c1 div c14 from div_test;
ERROR:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c15 from div_test;
ERROR:  function pg_catalog.div(tinyint, json) does not exist
LINE 1: insert into tmp_res select c1 div c15 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: div
-- non-strict mode and err_division_by_zero, select warning, insert warning
set dolphin.sql_mode = 'ERROR_FOR_DIVISION_BY_ZERO';
select c1/c1 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c2 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c3 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c4 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c5 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c6 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c7 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c8 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c9 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c10 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c11 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c12 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c13 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c14 from div_test;
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1/c15 from div_test;
WARNING:  invalid input syntax for type double precision: "{"0":"0"}"
WARNING:  division by zero
 ?column? 
----------
         
(1 row)

select c1 mod c1 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c2 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c3 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c4 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c5 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c6 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c7 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c8 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c9 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c10 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c11 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c12 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c13 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, `binary`) does not exist
LINE 1: select c1 mod c13 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
select c1 mod c14 from div_test;
 b_mod 
-------
      
(1 row)

select c1 mod c15 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, json) does not exist
LINE 1: select c1 mod c15 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
select c1 div c1 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c2 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c3 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c4 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c5 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c6 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c7 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c8 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c9 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c10 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c11 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c12 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c13 from div_test;
WARNING:  invalid input syntax for type numeric: "\x30"
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
WARNING:  division by zero
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
 div 
-----
    
(1 row)

select c1 div c14 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
 div 
-----
    
(1 row)

select c1 div c15 from div_test;
ERROR:  function pg_catalog.div(tinyint, json) does not exist
LINE 1: select c1 div c15 from div_test;
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: div
insert into tmp_res select c1/c1 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c2 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c3 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c4 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c5 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c6 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c7 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c8 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c9 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c10 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c11 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c12 from div_test;
WARNING:  division by zero
insert into tmp_res select c1/c13 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c14 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1/c15 from div_test;
WARNING:  invalid input syntax for type double precision: "{"0":"0"}"
CONTEXT:  referenced column: a
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 mod c1 from div_test;
insert into tmp_res select c1 mod c2 from div_test;
insert into tmp_res select c1 mod c3 from div_test;
insert into tmp_res select c1 mod c4 from div_test;
insert into tmp_res select c1 mod c5 from div_test;
insert into tmp_res select c1 mod c6 from div_test;
insert into tmp_res select c1 mod c7 from div_test;
insert into tmp_res select c1 mod c8 from div_test;
insert into tmp_res select c1 mod c9 from div_test;
insert into tmp_res select c1 mod c10 from div_test;
insert into tmp_res select c1 mod c11 from div_test;
insert into tmp_res select c1 mod c12 from div_test;
insert into tmp_res select c1 mod c13 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, `binary`) does not exist
LINE 1: insert into tmp_res select c1 mod c13 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
insert into tmp_res select c1 mod c14 from div_test;
insert into tmp_res select c1 mod c15 from div_test;
ERROR:  function pg_catalog.b_mod(tinyint, json) does not exist
LINE 1: insert into tmp_res select c1 mod c15 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: b_mod
insert into tmp_res select c1 div c1 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c2 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c3 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c4 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c5 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c6 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c7 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c8 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c9 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c10 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c11 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c12 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: div
insert into tmp_res select c1 div c13 from div_test;
WARNING:  invalid input syntax for type numeric: "\x30"
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
WARNING:  division by zero
CONTEXT:  PL/pgSQL function `div`(double precision,`binary`) line 4 during statement block local variable initialization
referenced column: div
insert into tmp_res select c1 div c14 from div_test;
WARNING:  division by zero
CONTEXT:  referenced column: a
insert into tmp_res select c1 div c15 from div_test;
ERROR:  function pg_catalog.div(tinyint, json) does not exist
LINE 1: insert into tmp_res select c1 div c15 from div_test;
                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CONTEXT:  referenced column: div
select count(*) from tmp_res;
 count 
-------
   137
(1 row)

select count(*) from tmp_res where a is null;
 count 
-------
   137
(1 row)

drop table tmp_res;
drop table div_test;
--测试点三：验证mod操作符
select 8mod3;--返回mod3 8
 mod3 
------
    8
(1 row)

select 8 mod3;--返回mod3 8
 mod3 
------
    8
(1 row)

select 8 mod 3; 
 b_mod 
-------
     2
(1 row)

select 8 mod 0;
 b_mod 
-------
      
(1 row)

select 8mod 3, 8mod 3mod2, 8mod 3mod 2;
 b_mod | mod2 | b_mod 
-------+------+-------
     2 |    2 |     0
(1 row)

select 8 mod;--返回8
ERROR:  syntax error at or near ";"
LINE 1: select 8 mod;
                    ^
select 8 as mod;--返回mod 8
 mod 
-----
   8
(1 row)

select mod 1;
ERROR:  syntax error at or near "1"
LINE 1: select mod 1;
                   ^
select '-12.3abc' mod null;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod null;
               ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
      
(1 row)

select '-12.3abc' mod -100.1;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod -100.1;
               ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
 -12.3
(1 row)

select '-12.3abc' mod 0;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod 0;
               ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
      
(1 row)

select '-12.3abc' mod 5;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod 5;
               ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
  -2.3
(1 row)

select '-12.3abc' mod 158.3;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod 158.3;
               ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
 -12.3
(1 row)

select '-12.3abc' mod -8.222e4;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod -8.222e4;
               ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
 -12.3
(1 row)

select '-12.3abc' mod true;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod true;
               ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
  -0.3
(1 row)

select '-12.3abc' mod false;
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod false;
               ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
      
(1 row)

select '-12.3abc' mod 'null';
WARNING:  invalid input syntax for type numeric: "-12.3abc"
LINE 1: select '-12.3abc' mod 'null';
               ^
CONTEXT:  referenced column: b_mod
WARNING:  invalid input syntax for type numeric: "null"
LINE 1: select '-12.3abc' mod 'null';
                              ^
CONTEXT:  referenced column: b_mod
 b_mod 
-------
      
(1 row)

select 123456 mod 5 mod 4;
 b_mod 
-------
     1
(1 row)

select 8 mod 1 where 100 mod 3 mod 4 = 0;
 b_mod 
-------
(0 rows)

select 8 mod 3 where 100 mod 3 mod 4 > 0;
 b_mod 
-------
     2
(1 row)

--测试点四：验证xor操作符
select xor1;
ERROR:  column "xor1" does not exist
LINE 1: select xor1;
               ^
CONTEXT:  referenced column: xor1
select 1 xor 1;
 xor 
-----
   0
(1 row)

select 1 xor null;
 xor 
-----
    
(1 row)

select null xor 1;
 xor 
-----
    
(1 row)

select 1 xor 0;
 xor 
-----
   1
(1 row)

select '-12.3abc' xor null;
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
select '-12.3abc' xor -100.1;
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
select '-12.3abc' xor 0;
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
select '-12.3abc' xor 5;
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
select '-12.3abc' xor 158.3;
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
select '-12.3abc' xor -8.222e4;
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
select '-12.3abc' xor true;
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
select '-12.3abc' xor false;
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
select '-12.3abc' xor 'null';
ERROR:  invalid input syntax for type int16: "-12.3abc"
DETAIL:  text contain invalid character
CONTEXT:  referenced column: xor
SQL function "xor" statement 1
referenced column: xor
create table t1 (a int, b varchar(20));
insert into t1 values(1, 'true');
select a = 1 xor b = 'true' from t1;
 xor 
-----
   0
(1 row)

select acos(11);
 acos 
------
     
(1 row)

select acos(1.000001);
 acos 
------
     
(1 row)

select acos(-1.000001);
 acos 
------
     
(1 row)

drop schema db_b_parser3 cascade;
NOTICE:  drop cascades to 2 other objects
DETAIL:  drop cascades to table tb_db_b_parser0003
drop cascades to table t1
reset current_schema;
