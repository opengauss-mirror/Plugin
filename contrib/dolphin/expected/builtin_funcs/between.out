create schema db_between;
set current_schema to 'db_between';
select 2 between 2 and 23;
 b_between_and 
---------------
 t
(1 row)

select 2.1 between 2.1 and 12.3;
 b_between_and 
---------------
 t
(1 row)

select true between false and true;
 b_between_and 
---------------
 t
(1 row)

select 'abc' between 'abc' and 'deg';
 b_between_and 
---------------
 t
(1 row)

select 11 between 1.1 and 12.5;
 b_between_and 
---------------
 t
(1 row)

select true between 0 and 12;
 b_between_and 
---------------
 t
(1 row)

select true between 0.9 and 12.6;
 b_between_and 
---------------
 t
(1 row)

select true between '0.5' and '12.3';
 b_between_and 
---------------
 t
(1 row)

select true between 'a0.5' and '12.3aa';
 b_between_and 
---------------
 t
(1 row)

select 1 between 'a0.5' and '12.3aa';
 b_between_and 
---------------
 t
(1 row)

select 1 between '0.5' and '12.3';
 b_between_and 
---------------
 t
(1 row)

select 1 between 0 and '12.3';
 b_between_and 
---------------
 t
(1 row)

select 1.1 between 0 and '12.3';
 b_between_and 
---------------
 t
(1 row)

select 1.1 between 0.3 and '12.3a';
 b_between_and 
---------------
 t
(1 row)

select '1a' between 'B' and '12.3b';
 b_between_and 
---------------
 f
(1 row)

select 'a2.2a' between 2.1 and '4';
 b_between_and 
---------------
 f
(1 row)

select 12.7 between '11@#&%*' and '19.9hd';
 b_between_and 
---------------
 t
(1 row)

select 'a2.2a' between 0 and B'101';
 b_between_and 
---------------
 t
(1 row)

select 'a2.2a' between 1 and B'101';
 b_between_and 
---------------
 f
(1 row)

select '2.2' between 1 and B'101';
 b_between_and 
---------------
 t
(1 row)

select 2.2 between 1 and B'101';
 b_between_and 
---------------
 t
(1 row)

select B'001' between 1 and B'101';
 b_between_and 
---------------
 t
(1 row)

select '©12gdja12' between '©11.1a' and 15.4;
 b_between_and 
---------------
 t
(1 row)

select B'001' between 0.1 and true;
 b_between_and 
---------------
 t
(1 row)

select 2022-06-07 between 2022-06-06 and 2022-06-10;
 b_between_and 
---------------
 f
(1 row)

select b'1111111111111111111111111' between 0 and 999999999;
 b_between_and 
---------------
 t
(1 row)

select 0 between '测' and '15.2';
 b_between_and 
---------------
 t
(1 row)

select 1 between '测1' and '1';
 b_between_and 
---------------
 t
(1 row)

select 1 between '1测' and '1';
 b_between_and 
---------------
 t
(1 row)

select 'xyzhi'::text between 'xyzhi'::text and 'xyzhi'::text;
 b_between_and 
---------------
 t
(1 row)

select 'xyzhi'::text between 'xyzhi'::text and 'xyzhi';
 b_between_and 
---------------
 t
(1 row)

select 'xyzhi'::text between 'xyzhi' and 'xyzhi'::text;
 b_between_and 
---------------
 t
(1 row)

select repeat('Pg', 4) between 0 and 'PgPgPgPg';
 b_between_and 
---------------
 t
(1 row)

select replace('mm','mm',1) between 0 and 1;
 b_between_and 
---------------
 t
(1 row)

select lpad('hi', 5, 'xyza') between 'xyzhi' and 10;
 b_between_and 
---------------
 t
(1 row)

select 11 between '' and 0;
 b_between_and 
---------------
 f
(1 row)

select '' between 34 and 110;
 b_between_and 
---------------
 f
(1 row)

select 11 between 66 and '';
 b_between_and 
---------------
 f
(1 row)

select '2023-01-01 12:30:00'::datetime between '2023-06-28 11:30:30'::datetime and '2023-07-28 17:30:30'::datetime;
 b_between_and 
---------------
 f
(1 row)

select '2023-01-01 00:00:00' between date_add(now(),interval-30 minute) and now();
 b_between_and 
---------------
 f
(1 row)

select '2023-01-01 12:30:00'::time between '2023-06-28 11:30:30'::time and '2023-07-28 17:30:30'::time;
 b_between_and 
---------------
 t
(1 row)

select '12:30:00'::time between '11:30:30'::time and '2023-07-28 17:30:30'::time;
 b_between_and 
---------------
 t
(1 row)

select '12:30:00' between '12:30:30' and '17:30:30';
 b_between_and 
---------------
 f
(1 row)

select 1 between 0 and cast(18446744073709551615 as unsigned);
 b_between_and 
---------------
 t
(1 row)

select cast(0 as unsigned) between -1 and 1;
 b_between_and 
---------------
 t
(1 row)

select cast(0 as unsigned) between 0 and -1;
 b_between_and 
---------------
 f
(1 row)

select 1.5::numeric between 0::numeric and 2::numeric;
 b_between_and 
---------------
 t
(1 row)

select 0.5::float between 0::float and 2::float;
 b_between_and 
---------------
 t
(1 row)

select b'11' between 1::float and 2.5::decimal;
 b_between_and 
---------------
 t
(1 row)

select 100 between '-Inf'::float and '+Inf'::float;
WARNING:  value out of range: overflow
LINE 1: select 100 between '-Inf'::float and '+Inf'::float;
                           ^
CONTEXT:  referenced column: b_between_and
WARNING:  value out of range: overflow
LINE 1: select 100 between '-Inf'::float and '+Inf'::float;
                                             ^
CONTEXT:  referenced column: b_between_and
WARNING:  value out of range: overflow
LINE 1: select 100 between '-Inf'::float and '+Inf'::float;
                           ^
CONTEXT:  referenced column: b_between_and
WARNING:  value out of range: overflow
LINE 1: select 100 between '-Inf'::float and '+Inf'::float;
                                             ^
CONTEXT:  referenced column: b_between_and
 b_between_and 
---------------
 t
(1 row)

select 2 between symmetric 23 and 2;
 b_sym_between_and 
-------------------
 t
(1 row)

select 2.1 between symmetric 12.3 and 2.0;
 b_sym_between_and 
-------------------
 t
(1 row)

select true between symmetric true and false;
 b_sym_between_and 
-------------------
 t
(1 row)

select 'abc' between symmetric 'deg' and 'abc';
 b_sym_between_and 
-------------------
 t
(1 row)

select (sqrt(81) between log10(100) and 20)+('2' between log2(4) and sqrt(4));
 ?column? 
----------
        2
(1 row)

select (sqrt(81) between log10(100) and 20)-('22' between log2(4) and sqrt(4));
 ?column? 
----------
        1
(1 row)

select sqrt(1000) > 3.14 and sqrt(2000) <= 4 between sqrt(1212) <= 3 and sqrt(5757) = sqrt(5757);
 ?column? 
----------
 t
(1 row)

drop table if exists t_between_and_0015;
NOTICE:  table "t_between_and_0015" does not exist, skipping
create table t_between_and_0015(c_0015_nn numeric);
insert into t_between_and_0015 values(0.123),(21.215),(12.5),(268/7),(5.0001),(-11.111);
select c_0015_nn from t_between_and_0015 where abs(c_0015_nn) between 10 and 20 and c_0015_nn is not null order by c_0015_nn;
 c_0015_nn 
-----------
       -11
        13
(2 rows)

select c_0015_nn from t_between_and_0015 where abs(c_0015_nn) not between 10 and 20 and c_0015_nn is not null order by c_0015_nn;
 c_0015_nn 
-----------
         0
         5
        21
        38
(4 rows)

drop table t_between_and_0015;
drop table if exists t_between_and_0007;
NOTICE:  table "t_between_and_0007" does not exist, skipping
create table t_between_and_0007(
c_id int(11) not null,
c_name varchar(255) not null,
c_age int(11) not null,
c_create_time datetime default null,
c_birthday date default null,
primary key (c_id));
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "t_between_and_0007_pkey" for table "t_between_and_0007"
insert into t_between_and_0007(c_id,c_name,c_age,c_create_time,c_birthday) values
(1,'andy',17,'2021-02-01 00:00:00','2021-01-30'),
(2,'ben',18,'2021-02-01 00:00:01','20210711'),
(3,'cindy',16,'2021-02-01 12:01:54','2021-02-01'),
(4,'davc_id',18,'2021-02-01 23:59:59','2021-02-02'),
(5,'cindy2',18,'2021-02-02 00:00:00','2021-january-03'),
(6,'cindy3',17,'2021-02-02 00:00:01','2021-august-08'),
(7,'cindy4',19,'2021-11-22 12:19:33','2021-02-28');
select * from t_between_and_0007;
 c_id | c_name  | c_age |    c_create_time    | c_birthday 
------+---------+-------+---------------------+------------
    1 | andy    |    17 | 2021-02-01 00:00:00 | 2021-01-30
    2 | ben     |    18 | 2021-02-01 00:00:01 | 2021-07-11
    3 | cindy   |    16 | 2021-02-01 12:01:54 | 2021-02-01
    4 | davc_id |    18 | 2021-02-01 23:59:59 | 2021-02-02
    5 | cindy2  |    18 | 2021-02-02 00:00:00 | 2021-01-03
    6 | cindy3  |    17 | 2021-02-02 00:00:01 | 2021-08-08
    7 | cindy4  |    19 | 2021-11-22 12:19:33 | 2021-02-28
(7 rows)

select * from t_between_and_0007 where c_birthday between 20210201::date and 20210202::date;
 c_id | c_name  | c_age |    c_create_time    | c_birthday 
------+---------+-------+---------------------+------------
    3 | cindy   |    16 | 2021-02-01 12:01:54 | 2021-02-01
    4 | davc_id |    18 | 2021-02-01 23:59:59 | 2021-02-02
(2 rows)

select * from t_between_and_0007 where c_create_time between 20210115::datetime and 20210215::datetime;
 c_id | c_name  | c_age |    c_create_time    | c_birthday 
------+---------+-------+---------------------+------------
    1 | andy    |    17 | 2021-02-01 00:00:00 | 2021-01-30
    2 | ben     |    18 | 2021-02-01 00:00:01 | 2021-07-11
    3 | cindy   |    16 | 2021-02-01 12:01:54 | 2021-02-01
    4 | davc_id |    18 | 2021-02-01 23:59:59 | 2021-02-02
    5 | cindy2  |    18 | 2021-02-02 00:00:00 | 2021-01-03
    6 | cindy3  |    17 | 2021-02-02 00:00:01 | 2021-08-08
(6 rows)

select * from t_between_and_0007 where c_create_time between 20210201::datetime and 20210201::datetime;
 c_id | c_name | c_age |    c_create_time    | c_birthday 
------+--------+-------+---------------------+------------
    1 | andy   |    17 | 2021-02-01 00:00:00 | 2021-01-30
(1 row)

select * from t_between_and_0007 where c_create_time between 20210201::datetime and 20210202::datetime;
 c_id | c_name  | c_age |    c_create_time    | c_birthday 
------+---------+-------+---------------------+------------
    1 | andy    |    17 | 2021-02-01 00:00:00 | 2021-01-30
    2 | ben     |    18 | 2021-02-01 00:00:01 | 2021-07-11
    3 | cindy   |    16 | 2021-02-01 12:01:54 | 2021-02-01
    4 | davc_id |    18 | 2021-02-01 23:59:59 | 2021-02-02
    5 | cindy2  |    18 | 2021-02-02 00:00:00 | 2021-01-03
(5 rows)

select * from t_between_and_0007 where c_create_time between 20210115::timestamp and 20210215::timestamp;
 c_id | c_name  | c_age |    c_create_time    | c_birthday 
------+---------+-------+---------------------+------------
    1 | andy    |    17 | 2021-02-01 00:00:00 | 2021-01-30
    2 | ben     |    18 | 2021-02-01 00:00:01 | 2021-07-11
    3 | cindy   |    16 | 2021-02-01 12:01:54 | 2021-02-01
    4 | davc_id |    18 | 2021-02-01 23:59:59 | 2021-02-02
    5 | cindy2  |    18 | 2021-02-02 00:00:00 | 2021-01-03
    6 | cindy3  |    17 | 2021-02-02 00:00:01 | 2021-08-08
(6 rows)

select * from t_between_and_0007 where c_create_time between 20210201::timestamp and 20210201::timestamp;
 c_id | c_name | c_age |    c_create_time    | c_birthday 
------+--------+-------+---------------------+------------
    1 | andy   |    17 | 2021-02-01 00:00:00 | 2021-01-30
(1 row)

select * from t_between_and_0007 where c_create_time between 20210201::timestamp and 20210202::timestamp;
 c_id | c_name  | c_age |    c_create_time    | c_birthday 
------+---------+-------+---------------------+------------
    1 | andy    |    17 | 2021-02-01 00:00:00 | 2021-01-30
    2 | ben     |    18 | 2021-02-01 00:00:01 | 2021-07-11
    3 | cindy   |    16 | 2021-02-01 12:01:54 | 2021-02-01
    4 | davc_id |    18 | 2021-02-01 23:59:59 | 2021-02-02
    5 | cindy2  |    18 | 2021-02-02 00:00:00 | 2021-01-03
(5 rows)

create table t_between_and_0023(
c_id serial,
c_title char(4),
c_fname varchar(32),
c_lname varchar(32) not null,
c_addressline varchar(64),
c_town varchar(32),
c_zipcode char(10) not null,
c_phone varchar(16));
NOTICE:  CREATE TABLE will create implicit sequence "t_between_and_0023_c_id_seq" for serial column "t_between_and_0023.c_id"
insert into t_between_and_0023(c_title, c_fname, c_lname, c_addressline, c_town, c_zipcode, c_phone)values
('miss','jenny','stones','27 rowan avenue','highc_town','nt2 1aq','023 9876'),
('mr','andrew','stones','52 the willows','lowc_town','lt5 7ra','876 3527'),
('miss','alex','matthew','4 the street','nicec_town','nt2 2tx','010 4567'),
('mr','adrian','matthew','the barn','yuleville','yv67 2wr','487 3871'),
('mr','simon','cozens','7 shady lane','oakenham','oa3 6qw','514 5926'),
('mr','neil','matthew','5 pasture lane','nicec_town','nt3 7rt','267 1232'),
('mr','richard','stones','34 holly way','bingham','bg4 2we','342 5982'),
('mrs','christine','hickman','36 queen street','histon','ht3 5em','342 5432'),
('mr','mike','howard','86 dysart street','tibsville','tb3 7fg','505 5482'),
('mr','dave','jones','54 vale rise','bingham','bg3 8gd','342 8264'),
('mr','richard','neill','42 thatched way','winersby','wb3 6gq','505 6482');
select * from t_between_and_0023;
 c_id | c_title |  c_fname  | c_lname |  c_addressline   |   c_town   | c_zipcode  | c_phone  
------+---------+-----------+---------+------------------+------------+------------+----------
    1 | miss    | jenny     | stones  | 27 rowan avenue  | highc_town | nt2 1aq    | 023 9876
    2 | mr      | andrew    | stones  | 52 the willows   | lowc_town  | lt5 7ra    | 876 3527
    3 | miss    | alex      | matthew | 4 the street     | nicec_town | nt2 2tx    | 010 4567
    4 | mr      | adrian    | matthew | the barn         | yuleville  | yv67 2wr   | 487 3871
    5 | mr      | simon     | cozens  | 7 shady lane     | oakenham   | oa3 6qw    | 514 5926
    6 | mr      | neil      | matthew | 5 pasture lane   | nicec_town | nt3 7rt    | 267 1232
    7 | mr      | richard   | stones  | 34 holly way     | bingham    | bg4 2we    | 342 5982
    8 | mrs     | christine | hickman | 36 queen street  | histon     | ht3 5em    | 342 5432
    9 | mr      | mike      | howard  | 86 dysart street | tibsville  | tb3 7fg    | 505 5482
   10 | mr      | dave      | jones   | 54 vale rise     | bingham    | bg3 8gd    | 342 8264
   11 | mr      | richard   | neill   | 42 thatched way  | winersby   | wb3 6gq    | 505 6482
(11 rows)

select distinct c_town from t_between_and_0023 where c_town between 'b' and 'n' order by c_town;
   c_town   
------------
 bingham
 highc_town
 histon
 lowc_town
(4 rows)

select distinct c_town from t_between_and_0023 where c_town between 'b' and 'nz' order by c_town;
   c_town   
------------
 bingham
 highc_town
 histon
 lowc_town
 nicec_town
(5 rows)

drop table t_between_and_0023;
drop table if exists test_collate;
NOTICE:  table "test_collate" does not exist, skipping
create table test_collate(c1 text, c2 text, c3 text)charset 'utf8' collate 'utf8_unicode_ci';
insert into test_collate values
('t','T','T'),
('T','t','t'),
('TT','tT','Tt');
select c1 between c2 and c3 from test_collate ;
 b_between_and 
---------------
 t
 t
 t
(3 rows)

drop table test_collate;
drop table if exists test_nocollate;
NOTICE:  table "test_nocollate" does not exist, skipping
create table test_nocollate(c1 text, c2 text, c3 text);
insert into test_nocollate values
('t','T','T'),
('T','t','t'),
('TT','tT','Tt');
select c1 between c2 and c3 from test_nocollate ;
 b_between_and 
---------------
 f
 f
 f
(3 rows)

drop table test_nocollate;
-- test with openGauss unique datatype
select '2'::money between '1' and '5'::money;
 b_between_and 
---------------
 t
(1 row)

select '2' not between '1'::money and '5'::money;
 b_not_between_and 
-------------------
 f
(1 row)

select '2' between SYMMETRIC '5' and '1'::money;
 b_sym_between_and 
-------------------
 t
(1 row)

select '2'::money not between SYMMETRIC '5' and '1';
 b_not_sym_between_and 
-----------------------
 f
(1 row)

-- test with 3 arg has same type
set enable_seqscan to off;
set enable_bitmapscan to off;
create table t_b1(a int1, b int2, c int4, d float, e double, f numeric, g text, h varchar(10), i char(10));
create index i_t_b1_a on t_b1(a);
create index i_t_b1_b on t_b1(b);
create index i_t_b1_c on t_b1(c);
create index i_t_b1_d on t_b1(d);
create index i_t_b1_e on t_b1(e);
create index i_t_b1_f on t_b1(f);
create index i_t_b1_g on t_b1(g);
create index i_t_b1_h on t_b1(h);
create index i_t_b1_i on t_b1(i);
analyze t_b1;
explain (costs off) select * from t_b1 where a between 1 and 2;
              QUERY PLAN               
---------------------------------------
 [Bypass]
 Index Scan using i_t_b1_a on t_b1
   Index Cond: ((a >= 1) AND (a <= 2))
(3 rows)

explain (costs off) select * from t_b1 where b between 1 and 2;
              QUERY PLAN               
---------------------------------------
 [Bypass]
 Index Scan using i_t_b1_b on t_b1
   Index Cond: ((b >= 1) AND (b <= 2))
(3 rows)

explain (costs off) select * from t_b1 where c between 1 and 2;
              QUERY PLAN               
---------------------------------------
 [Bypass]
 Index Scan using i_t_b1_c on t_b1
   Index Cond: ((c >= 1) AND (c <= 2))
(3 rows)

explain (costs off) select * from t_b1 where d between 1 and 2;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 [Bypass]
 Index Scan using i_t_b1_d on t_b1
   Index Cond: ((d >= 1::double precision) AND (d <= 2::double precision))
(3 rows)

explain (costs off) select * from t_b1 where e between 1 and 2;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 [Bypass]
 Index Scan using i_t_b1_e on t_b1
   Index Cond: ((e >= 1::double precision) AND (e <= 2::double precision))
(3 rows)

explain (costs off) select * from t_b1 where f between 1 and 2;
                       QUERY PLAN                        
---------------------------------------------------------
 [Bypass]
 Index Scan using i_t_b1_f on t_b1
   Index Cond: ((f >= 1::numeric) AND (f <= 2::numeric))
(3 rows)

explain (costs off) select * from t_b1 where g between '1' and '2';
                      QUERY PLAN                       
-------------------------------------------------------
 [Bypass]
 Index Scan using i_t_b1_g on t_b1
   Index Cond: ((g >= '1'::text) AND (g <= '2'::text))
(3 rows)

explain (costs off) select * from t_b1 where h between '1' and '2';
                              QUERY PLAN                               
-----------------------------------------------------------------------
 [Bypass]
 Index Scan using i_t_b1_h on t_b1
   Index Cond: (((h)::text >= '1'::text) AND ((h)::text <= '2'::text))
(3 rows)

explain (costs off) select * from t_b1 where i between '1' and '2';
                        QUERY PLAN                         
-----------------------------------------------------------
 [Bypass]
 Index Scan using i_t_b1_i on t_b1
   Index Cond: ((i >= '1'::bpchar) AND (i <= '2'::bpchar))
(3 rows)

-- test the cmp of time and date
select date'2018-12-31' between time'23:56:59' and timestamp'2018-12-31 23:56:59';
 b_between_and 
---------------
 f
(1 row)

select date'2018-12-31' not between time'23:56:59' and timestamp'2018-12-31 23:56:59';
 b_not_between_and 
-------------------
 t
(1 row)

select date'2018-12-31' between symmetric time'23:56:59' and timestamp'2018-12-31 23:56:59';
 b_sym_between_and 
-------------------
 f
(1 row)

select date'2018-12-31' not between symmetric time'23:56:59' and timestamp'2018-12-31 23:56:59';
 b_not_sym_between_and 
-----------------------
 t
(1 row)

select time'23:56:59' between date'2018-12-31' and timestamp'2018-12-31 23:56:59';
 b_between_and 
---------------
 f
(1 row)

select time'23:56:59' not between date'2018-12-31' and timestamp'2018-12-31 23:56:59';
 b_not_between_and 
-------------------
 t
(1 row)

select time'23:56:59' between datetime'2018-12-31' and timestamptz'2018-12-31 23:56:59';
 b_between_and 
---------------
 f
(1 row)

select time'23:56:59' not between datetime'2018-12-31' and timestamptz'2018-12-31 23:56:59';
 b_not_between_and 
-------------------
 t
(1 row)

-- test the cmp of number and date/time/datetime
select period_add(202201,2) between '2022-01-01' and date'2022-03-31';
 b_between_and 
---------------
 t
(1 row)

select sec_to_time(4396) between sec_to_time(4395) and 4396;
 b_between_and 
---------------
 f
(1 row)

select 10 between to_days('0000-01-01') and date'0000-01-04';
 b_between_and 
---------------
 t
(1 row)

select 10 between to_days('0000-01-01') and time'12:30:00';
 b_between_and 
---------------
 t
(1 row)

select 10 between to_days('0000-01-01') and datetime'0000-01-04 12:30:00';
 b_between_and 
---------------
 t
(1 row)

select 10 between to_days('0000-01-01') and timestamp'0000-01-04 12:30:00';
 b_between_and 
---------------
 t
(1 row)

select 102 between '0000-01-01' and date'0000-01-03';
 b_between_and 
---------------
 t
(1 row)

select 102 between time'00:01:01' and date'0000-01-03';
 b_between_and 
---------------
 t
(1 row)

select 102 between date'0000-01-01' and timestamp'0000-01-03 00:00:00';
 b_between_and 
---------------
 t
(1 row)

drop schema db_between cascade;
NOTICE:  drop cascades to 2 other objects
DETAIL:  drop cascades to table t_between_and_0007
drop cascades to table t_b1
reset current_schema;
