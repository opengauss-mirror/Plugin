create schema db_test_varlena;
set current_schema to 'db_test_varlena';
set dolphin.b_compatibility_mode = on;
set dolphin.sql_mode = 'sql_mode_strict,sql_mode_full_group,pipes_as_concat,ansi_quotes,no_zero_date';
create table test_type_table
(
    `int1` tinyint,
    `uint1` tinyint unsigned,
    `int2` smallint,
    `uint2` smallint unsigned,
    `int4` integer,
    `uint4` integer unsigned,
    `int8` bigint,
    `uint8` bigint unsigned,
    `float4` float4,
    `float8` float8,
    `numeric` decimal(20, 6),
    `bit1` bit(1),
    `bit64` bit(64),
    `boolean` boolean,
    `date` date,
    `time` time,
    `time4` time(4),
    `datetime` datetime,
    `datetime4` datetime(4) default '2023-12-30 12:00:12',
    `timestamp` timestamp,
    `timestamp4` timestamp(4) default '2023-12-30 12:00:12',
    `year` year,
    `char` char(100),
    `varchar` varchar(100),
    `binary` binary(100),
    `varbinary` varbinary(100),
    `tinyblob` tinyblob,
    `blob` blob,
    `mediumblob` mediumblob,
    `longblob` longblob,
    `text` text,
    `enum_t` enum('a', 'b', 'c'),
    `set_t` set('a', 'b', 'c'),
    `json` json
);
NOTICE:  CREATE TABLE will create implicit set "test_type_table_set_t_set" for column "test_type_table.set_t"
insert into test_type_table values
    (
        1, 1, 1, 1, 1, 1, 1, 1, 1.0, 1.0, 3.14259,
        1, 10101100, 1,
        '2024-01-11', '11:47:58', '11:47:58.7896', '2024-01-11 11:49:25', '2024-01-11 11:49:25.1234', '2024-01-11 11:49:25', '2024-01-11 11:49:25.1234', '2024',
        '62.345*67-89', '62.345*67-89',
        '67890 - 12345 = 55545', '67890 - 12345 = 55545',
        '67890 - 12345 = 55545', '67890 - 12345 = 55545', '67890 - 12345 = 55545', '67890 - 12345 = 55545',
        '67890 - 12345 = 55545',
        'b',
        'a,b',
        json_object('a', 2, 'b', 3)
    );
insert into test_type_table values
    (
        127, 255, 32767, 65535, 0x7FFFFFFF, 0xFFFFFFFF, 0x7FFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFF, 3.402823, 1.79769313486231, 3.141592654,
        1, 0xFFFFFFFFFFFFFFFF, 1,
        '2222-02-22', '11:59:58', '11:59:58.9999', '2222-02-22 11:59:58', '2222-02-22 11:59:58.9999', '2038-01-19 03:14:07', '2038-01-19 03:14:07.9999', '2155',
        'Today is a good day.  ', 'Today is a good day.  ',
        'Today is a good day.  ', 'Today is a good day.  ',
        'Today is a good day.  ', 'Today is a good day.  ', 'Today is a good day.  ', 'Today is a good day.  ',
        'Today is a good day.  ',
        'b',
        'a,b',
        json_object('a', 2, 'b', 3)
    );
insert into test_type_table values
    (
        -127, 0, -32768, 0, -2147483648, 0, -9223372036854775808, 0,
        -1234.567890, -1002345.78456892, -99999999999999.999999,
        0, 0x01, 0,
        '1999-09-19', '00:00:01', '00:00:01.0001', '1999-09-19 00:00:0001', '1999-09-19 00:00:01.0001', '1970-07-07 00:00:59', '1970-07-07 00:00:59.0001', '1999',
        '', '', '', '',
        '', '', '', '',
        '',
        'a', 'a,b,c',
        json_object('a', 0)
    );
\x
-- strict select
SELECT
    concat(`int1`, `uint1`),
    concat(`uint1`, `boolean`),
    concat(`int2`, `time4`),
    concat(`uint2`, `datetime4`),
    concat(`int4`, `varchar`),
    concat(`uint4`, `binary`),
    concat(`int8`, `enum_t`),
    concat(`uint8`, `blob`),
    concat(`float4`, `json`),
    concat(`float8`, `bit1`),
    concat(`numeric`, `set_t`),
    concat(`bit1`, `char`),
    concat(`bit64`, `text`),
    concat(`boolean`, `datetime`),
    concat(`date`, `mediumblob`),
    concat(`time`, `longblob`),
    concat(`time4`, `text`),
    concat(`datetime`, `varbinary`),
    concat(`datetime4`, `binary`),
    concat(`timestamp`, `json`),
    concat(`timestamp4`, `bit64`),
    concat(`year`, `int4`),
    concat(`char`, `bit64`),
    concat(`varchar`, `varbinary`),
    concat(`binary`, `boolean`),
    concat(`varbinary`, `varchar`),
    concat(`tinyblob`, `varchar`),
    concat(`blob`, `varchar`),
    concat(`mediumblob`, `varchar`),
    concat(`longblob`, `varchar`),
    concat(`text`, `varchar`),
    concat(`enum_t`, `varchar`),
    concat(`set_t`, `varchar`),
    concat(`json`, `varchar`)
FROM test_type_table;
-[ RECORD 1 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat | 11
concat | 11
concat | 111:47:58.7896
concat | 12024-01-11 11:49:25.1234
concat | 162.345*67-89
concat | \x313637383930202d203132333435203d20353535343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 1b
concat | \x313637383930202d203132333435203d203535353435
concat | 1{"a": 2, "b": 3}
concat | \x3101
concat | 3.142590a,b
concat | \x0136322e3334352a36372d3839
concat | \x00000000009a216c3637383930202d203132333435203d203535353435
concat | 12024-01-11 11:49:25
concat | \x323032342d30312d31313637383930202d203132333435203d203535353435
concat | \x31313a34373a35383637383930202d203132333435203d203535353435
concat | 11:47:58.789667890 - 12345 = 55545
concat | \x323032342d30312d31312031313a34393a32353637383930202d203132333435203d203535353435
concat | \x323032342d30312d31312031313a34393a32352e313233343637383930202d203132333435203d20353535343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 2024-01-11 11:49:25-08{"a": 2, "b": 3}
concat | \x323032342d30312d31312031313a34393a32352e313233342d303800000000009a216c
concat | 20241
concat | \x36322e3334352a36372d383900000000009a216c
concat | \x36322e3334352a36372d38393637383930202d203132333435203d203535353435
concat | \x3637383930202d203132333435203d2035353534350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000031
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | 67890 - 12345 = 5554562.345*67-89
concat | b62.345*67-89
concat | a,b62.345*67-89
concat | {"a": 2, "b": 3}62.345*67-89
-[ RECORD 2 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat | 127255
concat | 2551
concat | 3276711:59:58.9999
concat | 655352222-02-22 11:59:58.9999
concat | 2147483647Today is a good day.  
concat | \x34323934393637323935546f646179206973206120676f6f64206461792e2020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 9223372036854775807b
concat | \x3138343436373434303733373039353531363135546f646179206973206120676f6f64206461792e2020
concat | 3.40282{"a": 2, "b": 3}
concat | \x312e373937363933313334383632333101
concat | 3.141593a,b
concat | \x01546f646179206973206120676f6f64206461792e
concat | \xffffffffffffffff546f646179206973206120676f6f64206461792e2020
concat | 12222-02-22 11:59:58
concat | \x323232322d30322d3232546f646179206973206120676f6f64206461792e2020
concat | \x31313a35393a3538546f646179206973206120676f6f64206461792e2020
concat | 11:59:58.9999Today is a good day.  
concat | \x323232322d30322d32322031313a35393a3538546f646179206973206120676f6f64206461792e2020
concat | \x323232322d30322d32322031313a35393a35382e39393939546f646179206973206120676f6f64206461792e2020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 2038-01-19 03:14:07-08{"a": 2, "b": 3}
concat | \x323033382d30312d31392030333a31343a30372e393939392d3038ffffffffffffffff
concat | 21552147483647
concat | \x546f646179206973206120676f6f64206461792effffffffffffffff
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000031
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | Today is a good day.  Today is a good day.  
concat | bToday is a good day.  
concat | a,bToday is a good day.  
concat | {"a": 2, "b": 3}Today is a good day.  
-[ RECORD 3 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat | -1270
concat | 00
concat | -3276800:00:01.0001
concat | 01999-09-19 00:00:01.0001
concat | -2147483648
concat | \x3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | -9223372036854775808a
concat | \x30
concat | -1234.57{"a": 0}
concat | \x2d313030323334352e373834353638393200
concat | -99999999999999.999999a,b,c
concat | \x00
concat | \x0000000000000001
concat | 01999-09-19 00:00:01
concat | \x313939392d30392d3139
concat | \x30303a30303a3031
concat | 00:00:01.0001
concat | \x313939392d30392d31392030303a30303a3031
concat | \x313939392d30392d31392030303a30303a30312e3030303100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 1970-07-07 00:00:59-07{"a": 0}
concat | \x313937302d30372d30372030303a30303a35392e303030312d30370000000000000001
concat | 1999-2147483648
concat | \x0000000000000001
concat | \x
concat | \x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030
concat | \x
concat | \x
concat | \x
concat | \x
concat | \x
concat | 
concat | a
concat | a,b,c
concat | {"a": 0}

SELECT
    concat_ws('-', `int1`, `uint1`),
    concat_ws('-', `uint1`, `boolean`),
    concat_ws('-', `int2`, `time4`),
    concat_ws('-', `uint2`, `datetime4`),
    concat_ws('-', `int4`, `varchar`),
    concat_ws('-', `uint4`, `binary`),
    concat_ws('-', `int8`, `enum_t`),
    concat_ws('-', `uint8`, `blob`),
    concat_ws('-', `float4`, `json`),
    concat_ws('-', `float8`, `bit1`),
    concat_ws('-', `numeric`, `set_t`),
    concat_ws('-', `bit1`, `char`),
    concat_ws('-', `bit64`, `text`),
    concat_ws('-', `boolean`, `datetime`),
    concat_ws('-', `date`, `mediumblob`),
    concat_ws('-', `time`, `longblob`),
    concat_ws('-', `time4`, `text`),
    concat_ws('-', `datetime`, `varbinary`),
    concat_ws('-', `datetime4`, `binary`),
    concat_ws('-', `timestamp`, `json`),
    concat_ws('-', `timestamp4`, `bit64`),
    concat_ws('-', `year`, `int4`),
    concat_ws('-', `char`, `bit64`),
    concat_ws('-', `varchar`, `varbinary`),
    concat_ws('-', `binary`, `boolean`),
    concat_ws('-', `varbinary`, `varchar`),
    concat_ws('-', `tinyblob`, `varchar`),
    concat_ws('-', `blob`, `varchar`),
    concat_ws('-', `mediumblob`, `varchar`),
    concat_ws('-', `longblob`, `varchar`),
    concat_ws('-', `text`, `varchar`),
    concat_ws('-', `enum_t`, `varchar`),
    concat_ws('-', `set_t`, `varchar`),
    concat_ws('-', `json`, `varchar`)
FROM test_type_table;
-[ RECORD 1 ]-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat_ws | 1-1
concat_ws | 1-1
concat_ws | 1-11:47:58.7896
concat_ws | 1-2024-01-11 11:49:25.1234
concat_ws | 1-62.345*67-89
concat_ws | \x312d3637383930202d203132333435203d20353535343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 1-b
concat_ws | \x312d3637383930202d203132333435203d203535353435
concat_ws | 1-{"a": 2, "b": 3}
concat_ws | \x312d01
concat_ws | 3.142590-a,b
concat_ws | \x012d36322e3334352a36372d3839
concat_ws | \x00000000009a216c2d3637383930202d203132333435203d203535353435
concat_ws | 1-2024-01-11 11:49:25
concat_ws | \x323032342d30312d31312d3637383930202d203132333435203d203535353435
concat_ws | \x31313a34373a35382d3637383930202d203132333435203d203535353435
concat_ws | 11:47:58.7896-67890 - 12345 = 55545
concat_ws | \x323032342d30312d31312031313a34393a32352d3637383930202d203132333435203d203535353435
concat_ws | \x323032342d30312d31312031313a34393a32352e313233342d3637383930202d203132333435203d20353535343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 2024-01-11 11:49:25-08-{"a": 2, "b": 3}
concat_ws | \x323032342d30312d31312031313a34393a32352e313233342d30382d00000000009a216c
concat_ws | 2024-1
concat_ws | \x36322e3334352a36372d38392d00000000009a216c
concat_ws | \x36322e3334352a36372d38392d3637383930202d203132333435203d203535353435
concat_ws | \x3637383930202d203132333435203d203535353435000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d31
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | 67890 - 12345 = 55545-62.345*67-89
concat_ws | b-62.345*67-89
concat_ws | a,b-62.345*67-89
concat_ws | {"a": 2, "b": 3}-62.345*67-89
-[ RECORD 2 ]-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat_ws | 127-255
concat_ws | 255-1
concat_ws | 32767-11:59:58.9999
concat_ws | 65535-2222-02-22 11:59:58.9999
concat_ws | 2147483647-Today is a good day.  
concat_ws | \x343239343936373239352d546f646179206973206120676f6f64206461792e2020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 9223372036854775807-b
concat_ws | \x31383434363734343037333730393535313631352d546f646179206973206120676f6f64206461792e2020
concat_ws | 3.40282-{"a": 2, "b": 3}
concat_ws | \x312e37393736393331333438363233312d01
concat_ws | 3.141593-a,b
concat_ws | \x012d546f646179206973206120676f6f64206461792e
concat_ws | \xffffffffffffffff2d546f646179206973206120676f6f64206461792e2020
concat_ws | 1-2222-02-22 11:59:58
concat_ws | \x323232322d30322d32322d546f646179206973206120676f6f64206461792e2020
concat_ws | \x31313a35393a35382d546f646179206973206120676f6f64206461792e2020
concat_ws | 11:59:58.9999-Today is a good day.  
concat_ws | \x323232322d30322d32322031313a35393a35382d546f646179206973206120676f6f64206461792e2020
concat_ws | \x323232322d30322d32322031313a35393a35382e393939392d546f646179206973206120676f6f64206461792e2020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 2038-01-19 03:14:07-08-{"a": 2, "b": 3}
concat_ws | \x323033382d30312d31392030333a31343a30372e393939392d30382dffffffffffffffff
concat_ws | 2155-2147483647
concat_ws | \x546f646179206973206120676f6f64206461792e2dffffffffffffffff
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d31
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | Today is a good day.  -Today is a good day.  
concat_ws | b-Today is a good day.  
concat_ws | a,b-Today is a good day.  
concat_ws | {"a": 2, "b": 3}-Today is a good day.  
-[ RECORD 3 ]-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat_ws | -127-0
concat_ws | 0-0
concat_ws | -32768-00:00:01.0001
concat_ws | 0-1999-09-19 00:00:01.0001
concat_ws | -2147483648-
concat_ws | \x302d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | -9223372036854775808-a
concat_ws | \x302d
concat_ws | -1234.57-{"a": 0}
concat_ws | \x2d313030323334352e37383435363839322d00
concat_ws | -99999999999999.999999-a,b,c
concat_ws | \x002d
concat_ws | \x00000000000000012d
concat_ws | 0-1999-09-19 00:00:01
concat_ws | \x313939392d30392d31392d
concat_ws | \x30303a30303a30312d
concat_ws | 00:00:01.0001-
concat_ws | \x313939392d30392d31392030303a30303a30312d
concat_ws | \x313939392d30392d31392030303a30303a30312e303030312d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 1970-07-07 00:00:59-07-{"a": 0}
concat_ws | \x313937302d30372d30372030303a30303a35392e303030312d30372d0000000000000001
concat_ws | 1999--2147483648
concat_ws | \x2d0000000000000001
concat_ws | \x2d
concat_ws | \x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d30
concat_ws | \x2d
concat_ws | \x2d
concat_ws | \x2d
concat_ws | \x2d
concat_ws | \x2d
concat_ws | -
concat_ws | a-
concat_ws | a,b,c-
concat_ws | {"a": 0}-

set dolphin.sql_mode = 'sql_mode_full_group,pipes_as_concat,ansi_quotes';
SELECT
    concat(`int1`, `uint1`),
    concat(`uint1`, `boolean`),
    concat(`int2`, `time4`),
    concat(`uint2`, `datetime4`),
    concat(`int4`, `varchar`),
    concat(`uint4`, `binary`),
    concat(`int8`, `enum_t`),
    concat(`uint8`, `blob`),
    concat(`float4`, `json`),
    concat(`float8`, `bit1`),
    concat(`numeric`, `set_t`),
    concat(`bit1`, `char`),
    concat(`bit64`, `text`),
    concat(`boolean`, `datetime`),
    concat(`date`, `mediumblob`),
    concat(`time`, `longblob`),
    concat(`time4`, `text`),
    concat(`datetime`, `varbinary`),
    concat(`datetime4`, `binary`),
    concat(`timestamp`, `json`),
    concat(`timestamp4`, `bit64`),
    concat(`year`, `int4`),
    concat(`char`, `bit64`),
    concat(`varchar`, `varbinary`),
    concat(`binary`, `boolean`),
    concat(`varbinary`, `varchar`),
    concat(`tinyblob`, `varchar`),
    concat(`blob`, `varchar`),
    concat(`mediumblob`, `varchar`),
    concat(`longblob`, `varchar`),
    concat(`text`, `varchar`),
    concat(`enum_t`, `varchar`),
    concat(`set_t`, `varchar`),
    concat(`json`, `varchar`)
FROM test_type_table;
-[ RECORD 1 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat | 11
concat | 11
concat | 111:47:58.7896
concat | 12024-01-11 11:49:25.1234
concat | 162.345*67-89
concat | \x313637383930202d203132333435203d20353535343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 1b
concat | \x313637383930202d203132333435203d203535353435
concat | 1{"a": 2, "b": 3}
concat | \x3101
concat | 3.142590a,b
concat | \x0136322e3334352a36372d3839
concat | \x00000000009a216c3637383930202d203132333435203d203535353435
concat | 12024-01-11 11:49:25
concat | \x323032342d30312d31313637383930202d203132333435203d203535353435
concat | \x31313a34373a35383637383930202d203132333435203d203535353435
concat | 11:47:58.789667890 - 12345 = 55545
concat | \x323032342d30312d31312031313a34393a32353637383930202d203132333435203d203535353435
concat | \x323032342d30312d31312031313a34393a32352e313233343637383930202d203132333435203d20353535343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 2024-01-11 11:49:25-08{"a": 2, "b": 3}
concat | \x323032342d30312d31312031313a34393a32352e313233342d303800000000009a216c
concat | 20241
concat | \x36322e3334352a36372d383900000000009a216c
concat | \x36322e3334352a36372d38393637383930202d203132333435203d203535353435
concat | \x3637383930202d203132333435203d2035353534350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000031
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | \x3637383930202d203132333435203d20353535343536322e3334352a36372d3839
concat | 67890 - 12345 = 5554562.345*67-89
concat | b62.345*67-89
concat | a,b62.345*67-89
concat | {"a": 2, "b": 3}62.345*67-89
-[ RECORD 2 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat | 127255
concat | 2551
concat | 3276711:59:58.9999
concat | 655352222-02-22 11:59:58.9999
concat | 2147483647Today is a good day.  
concat | \x34323934393637323935546f646179206973206120676f6f64206461792e2020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 9223372036854775807b
concat | \x3138343436373434303733373039353531363135546f646179206973206120676f6f64206461792e2020
concat | 3.40282{"a": 2, "b": 3}
concat | \x312e373937363933313334383632333101
concat | 3.141593a,b
concat | \x01546f646179206973206120676f6f64206461792e
concat | \xffffffffffffffff546f646179206973206120676f6f64206461792e2020
concat | 12222-02-22 11:59:58
concat | \x323232322d30322d3232546f646179206973206120676f6f64206461792e2020
concat | \x31313a35393a3538546f646179206973206120676f6f64206461792e2020
concat | 11:59:58.9999Today is a good day.  
concat | \x323232322d30322d32322031313a35393a3538546f646179206973206120676f6f64206461792e2020
concat | \x323232322d30322d32322031313a35393a35382e39393939546f646179206973206120676f6f64206461792e2020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 2038-01-19 03:14:07-08{"a": 2, "b": 3}
concat | \x323033382d30312d31392030333a31343a30372e393939392d3038ffffffffffffffff
concat | 21552147483647
concat | \x546f646179206973206120676f6f64206461792effffffffffffffff
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000031
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | \x546f646179206973206120676f6f64206461792e2020546f646179206973206120676f6f64206461792e2020
concat | Today is a good day.  Today is a good day.  
concat | bToday is a good day.  
concat | a,bToday is a good day.  
concat | {"a": 2, "b": 3}Today is a good day.  
-[ RECORD 3 ]------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat | -1270
concat | 00
concat | -3276800:00:01.0001
concat | 01999-09-19 00:00:01.0001
concat | -2147483648
concat | \x3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | -9223372036854775808a
concat | \x30
concat | -1234.57{"a": 0}
concat | \x2d313030323334352e373834353638393200
concat | -99999999999999.999999a,b,c
concat | \x00
concat | \x0000000000000001
concat | 01999-09-19 00:00:01
concat | \x313939392d30392d3139
concat | \x30303a30303a3031
concat | 00:00:01.0001
concat | \x313939392d30392d31392030303a30303a3031
concat | \x313939392d30392d31392030303a30303a30312e3030303100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat | 1970-07-07 00:00:59-07{"a": 0}
concat | \x313937302d30372d30372030303a30303a35392e303030312d30370000000000000001
concat | 1999-2147483648
concat | \x0000000000000001
concat | \x
concat | \x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030
concat | \x
concat | \x
concat | \x
concat | \x
concat | \x
concat | 
concat | a
concat | a,b,c
concat | {"a": 0}

SELECT
    concat_ws('-', `int1`, `uint1`),
    concat_ws('-', `uint1`, `boolean`),
    concat_ws('-', `int2`, `time4`),
    concat_ws('-', `uint2`, `datetime4`),
    concat_ws('-', `int4`, `varchar`),
    concat_ws('-', `uint4`, `binary`),
    concat_ws('-', `int8`, `enum_t`),
    concat_ws('-', `uint8`, `blob`),
    concat_ws('-', `float4`, `json`),
    concat_ws('-', `float8`, `bit1`),
    concat_ws('-', `numeric`, `set_t`),
    concat_ws('-', `bit1`, `char`),
    concat_ws('-', `bit64`, `text`),
    concat_ws('-', `boolean`, `datetime`),
    concat_ws('-', `date`, `mediumblob`),
    concat_ws('-', `time`, `longblob`),
    concat_ws('-', `time4`, `text`),
    concat_ws('-', `datetime`, `varbinary`),
    concat_ws('-', `datetime4`, `binary`),
    concat_ws('-', `timestamp`, `json`),
    concat_ws('-', `timestamp4`, `bit64`),
    concat_ws('-', `year`, `int4`),
    concat_ws('-', `char`, `bit64`),
    concat_ws('-', `varchar`, `varbinary`),
    concat_ws('-', `binary`, `boolean`),
    concat_ws('-', `varbinary`, `varchar`),
    concat_ws('-', `tinyblob`, `varchar`),
    concat_ws('-', `blob`, `varchar`),
    concat_ws('-', `mediumblob`, `varchar`),
    concat_ws('-', `longblob`, `varchar`),
    concat_ws('-', `text`, `varchar`),
    concat_ws('-', `enum_t`, `varchar`),
    concat_ws('-', `set_t`, `varchar`),
    concat_ws('-', `json`, `varchar`)
FROM test_type_table;
-[ RECORD 1 ]-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat_ws | 1-1
concat_ws | 1-1
concat_ws | 1-11:47:58.7896
concat_ws | 1-2024-01-11 11:49:25.1234
concat_ws | 1-62.345*67-89
concat_ws | \x312d3637383930202d203132333435203d20353535343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 1-b
concat_ws | \x312d3637383930202d203132333435203d203535353435
concat_ws | 1-{"a": 2, "b": 3}
concat_ws | \x312d01
concat_ws | 3.142590-a,b
concat_ws | \x012d36322e3334352a36372d3839
concat_ws | \x00000000009a216c2d3637383930202d203132333435203d203535353435
concat_ws | 1-2024-01-11 11:49:25
concat_ws | \x323032342d30312d31312d3637383930202d203132333435203d203535353435
concat_ws | \x31313a34373a35382d3637383930202d203132333435203d203535353435
concat_ws | 11:47:58.7896-67890 - 12345 = 55545
concat_ws | \x323032342d30312d31312031313a34393a32352d3637383930202d203132333435203d203535353435
concat_ws | \x323032342d30312d31312031313a34393a32352e313233342d3637383930202d203132333435203d20353535343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 2024-01-11 11:49:25-08-{"a": 2, "b": 3}
concat_ws | \x323032342d30312d31312031313a34393a32352e313233342d30382d00000000009a216c
concat_ws | 2024-1
concat_ws | \x36322e3334352a36372d38392d00000000009a216c
concat_ws | \x36322e3334352a36372d38392d3637383930202d203132333435203d203535353435
concat_ws | \x3637383930202d203132333435203d203535353435000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d31
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | \x3637383930202d203132333435203d2035353534352d36322e3334352a36372d3839
concat_ws | 67890 - 12345 = 55545-62.345*67-89
concat_ws | b-62.345*67-89
concat_ws | a,b-62.345*67-89
concat_ws | {"a": 2, "b": 3}-62.345*67-89
-[ RECORD 2 ]-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat_ws | 127-255
concat_ws | 255-1
concat_ws | 32767-11:59:58.9999
concat_ws | 65535-2222-02-22 11:59:58.9999
concat_ws | 2147483647-Today is a good day.  
concat_ws | \x343239343936373239352d546f646179206973206120676f6f64206461792e2020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 9223372036854775807-b
concat_ws | \x31383434363734343037333730393535313631352d546f646179206973206120676f6f64206461792e2020
concat_ws | 3.40282-{"a": 2, "b": 3}
concat_ws | \x312e37393736393331333438363233312d01
concat_ws | 3.141593-a,b
concat_ws | \x012d546f646179206973206120676f6f64206461792e
concat_ws | \xffffffffffffffff2d546f646179206973206120676f6f64206461792e2020
concat_ws | 1-2222-02-22 11:59:58
concat_ws | \x323232322d30322d32322d546f646179206973206120676f6f64206461792e2020
concat_ws | \x31313a35393a35382d546f646179206973206120676f6f64206461792e2020
concat_ws | 11:59:58.9999-Today is a good day.  
concat_ws | \x323232322d30322d32322031313a35393a35382d546f646179206973206120676f6f64206461792e2020
concat_ws | \x323232322d30322d32322031313a35393a35382e393939392d546f646179206973206120676f6f64206461792e2020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 2038-01-19 03:14:07-08-{"a": 2, "b": 3}
concat_ws | \x323033382d30312d31392030333a31343a30372e393939392d30382dffffffffffffffff
concat_ws | 2155-2147483647
concat_ws | \x546f646179206973206120676f6f64206461792e2dffffffffffffffff
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d31
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | \x546f646179206973206120676f6f64206461792e20202d546f646179206973206120676f6f64206461792e2020
concat_ws | Today is a good day.  -Today is a good day.  
concat_ws | b-Today is a good day.  
concat_ws | a,b-Today is a good day.  
concat_ws | {"a": 2, "b": 3}-Today is a good day.  
-[ RECORD 3 ]-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
concat_ws | -127-0
concat_ws | 0-0
concat_ws | -32768-00:00:01.0001
concat_ws | 0-1999-09-19 00:00:01.0001
concat_ws | -2147483648-
concat_ws | \x302d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | -9223372036854775808-a
concat_ws | \x302d
concat_ws | -1234.57-{"a": 0}
concat_ws | \x2d313030323334352e37383435363839322d00
concat_ws | -99999999999999.999999-a,b,c
concat_ws | \x002d
concat_ws | \x00000000000000012d
concat_ws | 0-1999-09-19 00:00:01
concat_ws | \x313939392d30392d31392d
concat_ws | \x30303a30303a30312d
concat_ws | 00:00:01.0001-
concat_ws | \x313939392d30392d31392030303a30303a30312d
concat_ws | \x313939392d30392d31392030303a30303a30312e303030312d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
concat_ws | 1970-07-07 00:00:59-07-{"a": 0}
concat_ws | \x313937302d30372d30372030303a30303a35392e303030312d30372d0000000000000001
concat_ws | 1999--2147483648
concat_ws | \x2d0000000000000001
concat_ws | \x2d
concat_ws | \x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d30
concat_ws | \x2d
concat_ws | \x2d
concat_ws | \x2d
concat_ws | \x2d
concat_ws | \x2d
concat_ws | -
concat_ws | a-
concat_ws | a,b,c-
concat_ws | {"a": 0}-

\x
-- test result type
SELECT
    pg_typeof(concat(`int1`, `uint1`)),
    pg_typeof(concat(`uint1`, `boolean`)),
    pg_typeof(concat(`int2`, `time4`)),
    pg_typeof(concat(`uint2`, `datetime4`)),
    pg_typeof(concat(`int4`, `varchar`)),
    pg_typeof(concat(`uint4`, `binary`)),
    pg_typeof(concat(`int8`, `enum_t`)),
    pg_typeof(concat(`uint8`, `blob`)),
    pg_typeof(concat(`float4`, `json`)),
    pg_typeof(concat(`float8`, `bit1`)),
    pg_typeof(concat(`numeric`, `set_t`)),
    pg_typeof(concat(`bit1`, `char`)),
    pg_typeof(concat(`bit64`, `text`)),
    pg_typeof(concat(`boolean`, `datetime`)),
    pg_typeof(concat(`date`, `mediumblob`)),
    pg_typeof(concat(`time`, `longblob`)),
    pg_typeof(concat(`time4`, `text`)),
    pg_typeof(concat(`datetime`, `varbinary`)),
    pg_typeof(concat(`datetime4`, `binary`)),
    pg_typeof(concat(`timestamp`, `json`)),
    pg_typeof(concat(`timestamp4`, `bit64`)),
    pg_typeof(concat(`year`, `int4`)),
    pg_typeof(concat(`char`, `bit64`)),
    pg_typeof(concat(`varchar`, `varbinary`)),
    pg_typeof(concat(`binary`, `boolean`)),
    pg_typeof(concat(`varbinary`, `varchar`)),
    pg_typeof(concat(`tinyblob`, `varchar`)),
    pg_typeof(concat(`blob`, `varchar`)),
    pg_typeof(concat(`mediumblob`, `varchar`)),
    pg_typeof(concat(`longblob`, `varchar`)),
    pg_typeof(concat(`text`, `varchar`)),
    pg_typeof(concat(`enum_t`, `varchar`)),
    pg_typeof(concat(`set_t`, `varchar`)),
    pg_typeof(concat(`json`, `varchar`))
FROM test_type_table;
 pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------
 text      | text      | text      | text      | text      | blob      | text      | blob      | text      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | text      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | text      | text      | text      | text
 text      | text      | text      | text      | text      | blob      | text      | blob      | text      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | text      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | text      | text      | text      | text
 text      | text      | text      | text      | text      | blob      | text      | blob      | text      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | text      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | text      | text      | text      | text
(3 rows)

SELECT
    pg_typeof(concat_ws('-', `int1`, `uint1`)),
    pg_typeof(concat_ws('-', `uint1`, `boolean`)),
    pg_typeof(concat_ws('-', `int2`, `time4`)),
    pg_typeof(concat_ws('-', `uint2`, `datetime4`)),
    pg_typeof(concat_ws('-', `int4`, `varchar`)),
    pg_typeof(concat_ws('-', `uint4`, `binary`)),
    pg_typeof(concat_ws('-', `int8`, `enum_t`)),
    pg_typeof(concat_ws('-', `uint8`, `blob`)),
    pg_typeof(concat_ws('-', `float4`, `json`)),
    pg_typeof(concat_ws('-', `float8`, `bit1`)),
    pg_typeof(concat_ws('-', `numeric`, `set_t`)),
    pg_typeof(concat_ws('-', `bit1`, `char`)),
    pg_typeof(concat_ws('-', `bit64`, `text`)),
    pg_typeof(concat_ws('-', `boolean`, `datetime`)),
    pg_typeof(concat_ws('-', `date`, `mediumblob`)),
    pg_typeof(concat_ws('-', `time`, `longblob`)),
    pg_typeof(concat_ws('-', `time4`, `text`)),
    pg_typeof(concat_ws('-', `datetime`, `varbinary`)),
    pg_typeof(concat_ws('-', `datetime4`, `binary`)),
    pg_typeof(concat_ws('-', `timestamp`, `json`)),
    pg_typeof(concat_ws('-', `timestamp4`, `bit64`)),
    pg_typeof(concat_ws('-', `year`, `int4`)),
    pg_typeof(concat_ws('-', `char`, `bit64`)),
    pg_typeof(concat_ws('-', `varchar`, `varbinary`)),
    pg_typeof(concat_ws('-', `binary`, `boolean`)),
    pg_typeof(concat_ws('-', `varbinary`, `varchar`)),
    pg_typeof(concat_ws('-', `tinyblob`, `varchar`)),
    pg_typeof(concat_ws('-', `blob`, `varchar`)),
    pg_typeof(concat_ws('-', `mediumblob`, `varchar`)),
    pg_typeof(concat_ws('-', `longblob`, `varchar`)),
    pg_typeof(concat_ws('-', `text`, `varchar`)),
    pg_typeof(concat_ws('-', `enum_t`, `varchar`)),
    pg_typeof(concat_ws('-', `set_t`, `varchar`)),
    pg_typeof(concat_ws('-', `json`, `varchar`))
FROM test_type_table;
 pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof | pg_typeof 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------
 text      | text      | text      | text      | text      | blob      | text      | blob      | text      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | text      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | text      | text      | text      | text
 text      | text      | text      | text      | text      | blob      | text      | blob      | text      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | text      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | text      | text      | text      | text
 text      | text      | text      | text      | text      | blob      | text      | blob      | text      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | blob      | text      | blob      | text      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | blob      | text      | text      | text      | text
(3 rows)

-- test sql_mode pad_char_to_full_length
set dolphin.sql_mode = 'pad_char_to_full_length';
select concat(`char`, `int2`) from test_type_table;
                                                   concat                                                   
------------------------------------------------------------------------------------------------------------
 62.345*67-89                                                                                        1
 Today is a good day.                                                                                32767
                                                                                                     -32768
(3 rows)

select concat_ws('-', `char`, `int2`) from test_type_table;
                                                  concat_ws                                                  
-------------------------------------------------------------------------------------------------------------
 62.345*67-89                                                                                        -1
 Today is a good day.                                                                                -32767
                                                                                                     --32768
(3 rows)

drop table test_type_table;
-- test bit type
create table bit_test (`bit1` bit(1), `bit6` bit(6), `bit8` bit(8), `bit15` bit(15), `bit16` bit(16));
insert into bit_test values (1, 0x33, 0xA6, 0x6E00, 0xCC00);
insert into bit_test values (0, 0x2F, 0xF0, 0x006E, 0x00CC);
set dolphin.sql_mode = 'sql_mode_strict,sql_mode_full_group,pipes_as_concat,ansi_quotes,no_zero_date,pad_char_to_full_length';
select concat(`bit1`, 'openGauss'), concat(`bit6`, 'openGauss'), concat(`bit8`, 'openGauss'), concat(`bit15`, 'openGauss'), concat(`bit16`, 'openGauss') from bit_test;
         concat         |         concat         |         concat         |          concat          |          concat          
------------------------+------------------------+------------------------+--------------------------+--------------------------
 \x016f70656e4761757373 | \x336f70656e4761757373 | \xa66f70656e4761757373 | \x6e006f70656e4761757373 | \xcc006f70656e4761757373
 \x006f70656e4761757373 | \x2f6f70656e4761757373 | \xf06f70656e4761757373 | \x006e6f70656e4761757373 | \x00cc6f70656e4761757373
(2 rows)

select concat_ws('-', `bit1`, 'openGauss'), concat_ws('-', `bit6`, 'openGauss'), concat_ws('-', `bit8`, 'openGauss'), concat_ws('-', `bit15`, 'openGauss'), concat_ws('-', `bit16`, 'openGauss') from bit_test;
        concat_ws         |        concat_ws         |        concat_ws         |         concat_ws          |         concat_ws          
--------------------------+--------------------------+--------------------------+----------------------------+----------------------------
 \x012d6f70656e4761757373 | \x332d6f70656e4761757373 | \xa62d6f70656e4761757373 | \x6e002d6f70656e4761757373 | \xcc002d6f70656e4761757373
 \x002d6f70656e4761757373 | \x2f2d6f70656e4761757373 | \xf02d6f70656e4761757373 | \x006e2d6f70656e4761757373 | \x00cc2d6f70656e4761757373
(2 rows)

set dolphin.sql_mode = 'sql_mode_full_group,pipes_as_concat,ansi_quotes,pad_char_to_full_length';
select concat(`bit1`, 'openGauss'), concat(`bit6`, 'openGauss'), concat(`bit8`, 'openGauss'), concat(`bit15`, 'openGauss'), concat(`bit16`, 'openGauss') from bit_test;
         concat         |         concat         |         concat         |          concat          |          concat          
------------------------+------------------------+------------------------+--------------------------+--------------------------
 \x016f70656e4761757373 | \x336f70656e4761757373 | \xa66f70656e4761757373 | \x6e006f70656e4761757373 | \xcc006f70656e4761757373
 \x006f70656e4761757373 | \x2f6f70656e4761757373 | \xf06f70656e4761757373 | \x006e6f70656e4761757373 | \x00cc6f70656e4761757373
(2 rows)

select concat_ws('-', `bit1`, 'openGauss'), concat_ws('-', `bit6`, 'openGauss'), concat_ws('-', `bit8`, 'openGauss'), concat_ws('-', `bit15`, 'openGauss'), concat_ws('-', `bit16`, 'openGauss') from bit_test;
        concat_ws         |        concat_ws         |        concat_ws         |         concat_ws          |         concat_ws          
--------------------------+--------------------------+--------------------------+----------------------------+----------------------------
 \x012d6f70656e4761757373 | \x332d6f70656e4761757373 | \xa62d6f70656e4761757373 | \x6e002d6f70656e4761757373 | \xcc002d6f70656e4761757373
 \x002d6f70656e4761757373 | \x2f2d6f70656e4761757373 | \xf02d6f70656e4761757373 | \x006e2d6f70656e4761757373 | \x00cc2d6f70656e4761757373
(2 rows)

drop table bit_test;
create table t1(a text);
explain(costs off) select * from t1 where a like concat('%', '1', '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::bool, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::"char", '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::name, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::int1, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::int2, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::int4, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::int8, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::int16, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::text, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::oid, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::clob, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '{"a":1}'::json, '%');
             QUERY PLAN             
------------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%{"a":1}%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::xml, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::varchar, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::varbit, '%')::text;
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::cstring, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '{"a":1}'::jsonb, '%');
             QUERY PLAN              
-------------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%{"a": 1}%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::nvarchar2, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::year, '%');
           QUERY PLAN            
---------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%2001%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::uint1, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::uint2, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::uint4, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::uint8, '%');
          QUERY PLAN          
------------------------------
 Seq Scan on t1
   Filter: (a ~~ '%1%'::text)
(2 rows)

-- some can't do simply func
explain(costs off) select * from t1 where a like concat('%', '1'::money, '%');
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", '$1.00'::money, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::raw, '%');
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", '\x31'::raw, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::bytea, '%');
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", '\x31'::bytea, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '2022-11-11'::date, '%');
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", ('2022-11-11' COLLATE "default")::date, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '2022-11-11 11:11:11'::timestamp, '%');
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", '2022-11-11 11:11:11-08'::timestamp(0) with time zone, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '11:11:11'::time, '%');
                                                  QUERY PLAN                                                  
--------------------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", '11:11:11'::time(0) without time zone, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::numeric, '%');
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", 1::numeric(10,0), '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::bpchar, '%');
                                     QUERY PLAN                                     
------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", '1'::bpchar, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::float4, '%');
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", 1::real, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::float8, '%');
                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ concat('%' COLLATE "default", 1::double precision, '%' COLLATE "default"))
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::binary, '%')::text;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ (concat('%' COLLATE "default", '\x31'::"binary", '%' COLLATE "default"))::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::varbinary, '%')::text;
                                             QUERY PLAN                                              
-----------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ (concat('%' COLLATE "default", '\x31'::varbinary(1), '%' COLLATE "default"))::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::blob, '%')::text;
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ (concat('%' COLLATE "default", '\x31'::blob, '%' COLLATE "default"))::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::tinyblob, '%')::text;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ (concat('%' COLLATE "default", '\x31'::tinyblob, '%' COLLATE "default"))::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::mediumblob, '%')::text;
                                            QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ (concat('%' COLLATE "default", '\x31'::mediumblob, '%' COLLATE "default"))::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::longblob, '%')::text;
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ (concat('%' COLLATE "default", '\x31'::longblob, '%' COLLATE "default"))::text)
(2 rows)

explain(costs off) select * from t1 where a like concat('%', '1'::bit(8), '%')::text;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Seq Scan on t1
   Filter: (a ~~ (concat('%' COLLATE "default", B'00110001'::bit(8), '%' COLLATE "default"))::text)
(2 rows)

drop table t1;
-- test default value & concat_ws
create table concat_ws_t (
    c1 decimal default 16,
    c2 decimal(10, 2) default 17,
    c3 varchar(100) default concat('hello', ' world'),
    c4 varchar(100) default concat_ws('|', 'a', 'b'),
    c5 int default 10.0,
    c6 float default 10
);
insert into concat_ws_t values(c1, c2, c3, c4, c5, c6);
select * from concat_ws_t;
 c1 |  c2   | c3 | c4 | c5 | c6 
----+-------+----+----+----+----
 16 | 17.00 |    |    | 10 | 10
(1 row)

drop table if exists textlen_t;
NOTICE:  table "textlen_t" does not exist, skipping
create table textlen_t(
	c1 int4 default (char_length('10')),
    c2 text default (char_length('10'))
);
insert into textlen_t values (c1, c2);
select * from textlen_t;
 c1 | c2 
----+----
    | 
(1 row)

create table expr_t(
	c1 float default 1,
    c2 varchar(30) default 1,
    c3 int default (100 + 20*2)
);
insert into expr_t values(c1, c2, c3);
insert into expr_t values(default, default, default);
select * from expr_t;
 c1 | c2 | c3  
----+----+-----
  1 | 1  |    
  1 | 1  | 140
(2 rows)

create table func_t(
    c1 varchar(30) default (concat('hello', ' world')),
    c2 varchar(30) default 'hello world'
);
insert into func_t values (c1, c2);
insert into func_t values (default, default);
select * from func_t;
     c1      |     c2      
-------------+-------------
             | hello world
 hello world | hello world
(2 rows)

explain(costs off) select * from func_t where c1 like concat_ws(',', '1', '2');
              QUERY PLAN               
---------------------------------------
 Seq Scan on func_t
   Filter: ((c1)::text ~~ '1,2'::text)
(2 rows)

drop schema db_test_varlena cascade;
NOTICE:  drop cascades to 4 other objects
DETAIL:  drop cascades to table concat_ws_t
drop cascades to table textlen_t
drop cascades to table expr_t
drop cascades to table func_t
reset bytea_output;
reset dolphin.sql_mode;
reset dolphin.b_compatibility_mode;
reset current_schema;
