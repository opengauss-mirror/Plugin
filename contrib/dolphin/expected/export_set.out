create schema export_set;
set current_schema to 'export_set';
-- 测试缺省值
SELECT EXPORT_SET(5,'Y','N',',',5);
 export_set 
------------
 Y,N,Y,N,N
(1 row)

SELECT EXPORT_SET(5,'Y','N',',');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N
(1 row)

SELECT EXPORT_SET(5,'Y','N');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N
(1 row)

-- 测试bit
SELECT EXPORT_SET(b'0101','Y','N',',',b'0101');
 export_set 
------------
 Y,N,Y,N,N
(1 row)

SELECT EXPORT_SET(b'0101','Y','N',',',5);
 export_set 
------------
 Y,N,Y,N,N
(1 row)

SELECT EXPORT_SET(5,'Y','N',',',b'0101');
 export_set 
------------
 Y,N,Y,N,N
(1 row)

SELECT EXPORT_SET(b'0101','Y','N',',');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N
(1 row)

SELECT EXPORT_SET(b'0101','Y','N');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N
(1 row)

-- 测试上界
set dolphin.sql_mode = '';
SELECT EXPORT_SET(9223372036854775807,'Y','N',',',64);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,N
(1 row)

SELECT EXPORT_SET(9223372036854775808,'Y','N',',',64);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(9223372036854775809,'Y','N',',',64);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(18446744073709551615,'Y','N',',',64);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y
(1 row)

SELECT EXPORT_SET(18446744073709551616,'Y','N',',',64);
WARNING:  Truncated incorrect value
CONTEXT:  referenced column: export_set
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,N
(1 row)

-- 测试下界
SELECT EXPORT_SET(-9223372036854775807,'Y','N',',',64);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(-9223372036854775808,'Y','N',',',64);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(-9223372036854775809,'Y','N',',',64);
WARNING:  Truncated incorrect value
CONTEXT:  referenced column: export_set
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(9223372036854775807,'Y','N',',');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,N
(1 row)

SELECT EXPORT_SET(9223372036854775808,'Y','N',',');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(9223372036854775809,'Y','N',',');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(18446744073709551615,'Y','N',',');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y
(1 row)

SELECT EXPORT_SET(18446744073709551616,'Y','N',',');
WARNING:  Truncated incorrect value
CONTEXT:  referenced column: export_set
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,N
(1 row)

SELECT EXPORT_SET(-9223372036854775807,'Y','N',',');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(-9223372036854775808,'Y','N',',');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(-9223372036854775809,'Y','N',',');
WARNING:  Truncated incorrect value
CONTEXT:  referenced column: export_set
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(9223372036854775807,'Y','N');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,N
(1 row)

SELECT EXPORT_SET(9223372036854775808,'Y','N');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(9223372036854775809,'Y','N');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(18446744073709551615,'Y','N');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y
(1 row)

SELECT EXPORT_SET(18446744073709551616,'Y','N');
WARNING:  Truncated incorrect value
CONTEXT:  referenced column: export_set
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,N
(1 row)

SELECT EXPORT_SET(-9223372036854775807,'Y','N');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(-9223372036854775808,'Y','N');
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

SELECT EXPORT_SET(-9223372036854775809,'Y','N');
WARNING:  Truncated incorrect value
CONTEXT:  referenced column: export_set
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y
(1 row)

reset dolphin.sql_mode;
-- 测试长度参数
SELECT EXPORT_SET(5,'Y','N',',',64);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N
(1 row)

SELECT EXPORT_SET(5,'Y','N',',',65);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N
(1 row)

SELECT EXPORT_SET(5,'Y','N',',',-1);
                                                           export_set                                                            
---------------------------------------------------------------------------------------------------------------------------------
 Y,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N
(1 row)

-- 测试字符串
SELECT EXPORT_SET(5,'YYYYYYYYYYYYYYYY','N',',',5);
               export_set                
-----------------------------------------
 YYYYYYYYYYYYYYYY,N,YYYYYYYYYYYYYYYY,N,N
(1 row)

SELECT EXPORT_SET(5,'Y','NNNNNNNNNNNNNNN',',',5);
                     export_set                      
-----------------------------------------------------
 Y,NNNNNNNNNNNNNNN,Y,NNNNNNNNNNNNNNN,NNNNNNNNNNNNNNN
(1 row)

SELECT EXPORT_SET(5,'Y','N',',,,,,,,,,,,,',5);
                      export_set                       
-------------------------------------------------------
 Y,,,,,,,,,,,,N,,,,,,,,,,,,Y,,,,,,,,,,,,N,,,,,,,,,,,,N
(1 row)

select export_set(7,'q',b'111',',',5);
 export_set 
------------
 q,q,q,,
(1 row)

select export_set(7,b'111','111',',',5);
 export_set 
------------
 ,,,111,111
(1 row)

select export_set(7,'q','111',b'111',5);
 export_set 
------------
 qqq111111
(1 row)

select export_set(7,'q',True,',',5);
 export_set 
------------
 q,q,q,1,1
(1 row)

select export_set(7,True,'111',',',5);
  export_set   
---------------
 1,1,1,111,111
(1 row)

select export_set(7,'q','111',False,5);
  export_set   
---------------
 q0q0q01110111
(1 row)

select export_set(7,'q',True,',',5);
 export_set 
------------
 q,q,q,1,1
(1 row)

select export_set(7,True,'111',',',5);
  export_set   
---------------
 1,1,1,111,111
(1 row)

select export_set(7,'q','111',False,5);
  export_set   
---------------
 q0q0q01110111
(1 row)

drop schema export_set cascade;
reset current_schema;
