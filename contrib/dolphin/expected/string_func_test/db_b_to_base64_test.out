drop database if exists to_base64_test;
NOTICE:  database "to_base64_test" does not exist, skipping
create database to_base64_test dbcompatibility 'b';
\c to_base64_test
--测试字符串作为输入，返回base64编码的编码结果
SELECT TO_BASE64('123456');
 to_base64 
-----------
 MTIzNDU2
(1 row)

SELECT TO_BASE64('12345');
 to_base64 
-----------
 MTIzNDU=
(1 row)

SELECT TO_BASE64('1234');
 to_base64 
-----------
 MTIzNA==
(1 row)

SELECT TO_BASE64('to_base64');
  to_base64   
--------------
 dG9fYmFzZTY0
(1 row)

SELECT FROM_BASE64(TO_BASE64('123456'));
 from_base64 
-------------
 123456
(1 row)

SELECT FROM_BASE64(TO_BASE64('to_base64'));
 from_base64 
-------------
 to_base64
(1 row)

--测试数字作为输入，将数字变成字符串后，返回base64编码的编码结果
SELECT TO_BASE64(11111111111111111111111111111111111111);
                      to_base64                       
------------------------------------------------------
 MTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTE=
(1 row)

SELECT TO_BASE64('11111111111111111111111111111111111111');
                      to_base64                       
------------------------------------------------------
 MTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTE=
(1 row)

--测试NULL作为输入，返回空值
SELECT TO_BASE64(NULL);
 to_base64 
-----------
 
(1 row)

--测试bit类型、bool类型、date类型作为输入
SELECT TO_BASE64(b'01100001011000100110001101100100');
 to_base64 
-----------
 YWJjZA==
(1 row)

SELECT TO_BASE64('abcd');
 to_base64 
-----------
 YWJjZA==
(1 row)

SELECT TO_BASE64(0);
 to_base64 
-----------
 MA==
(1 row)

SELECT TO_BASE64(1);
 to_base64 
-----------
 MQ==
(1 row)

SELECT TO_BASE64('0');
 to_base64 
-----------
 MA==
(1 row)

SELECT TO_BASE64('1');
 to_base64 
-----------
 MQ==
(1 row)

SELECT TO_BASE64(FALSE);
 to_base64 
-----------
 MA==
(1 row)

SELECT TO_BASE64(TRUE);
 to_base64 
-----------
 MQ==
(1 row)

SELECT TO_BASE64('2022-10-31');
    to_base64     
------------------
 MjAyMi0xMC0zMQ==
(1 row)

-- 测试table类型作为输入
CREATE TABLE test_base64 (name text);
INSERT INTO test_base64 values('123456'), ('to_base64');
SELECT TO_BASE64(name) from test_base64;
  to_base64   
--------------
 MTIzNDU2
 dG9fYmFzZTY0
(2 rows)

\c postgres
drop database if exists to_base64_test;
