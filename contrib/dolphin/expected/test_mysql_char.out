create schema test_char;
set current_schema to 'test_char';
set dolphin.b_compatibility_mode=1;
set dolphin.sql_mode = '';
---create table
create table testfortext(a text,b int);
create table testforchar(a char(10),b int);
create table testforvarchar(a varchar(10),b int);
---insert data
insert into testfortext values('00100abc',1);
insert into testfortext values('00100abc',0);
insert into testfortext values('00100abc',null);
insert into testfortext values('-1abc',1);
insert into testfortext values('-1abc',0);
insert into testfortext values('-1abc',null);
insert into testfortext values('00200',1);
insert into testfortext values('00200',0);
insert into testfortext values('00200',null);
insert into testfortext values('abc',1);
insert into testfortext values('abc',0);
insert into testfortext values('abc',null);
insert into testfortext values('abc1',1);
insert into testfortext values('abc1',0);
insert into testfortext values('abc1',null);
insert into testfortext values('0.0100abc',1);
insert into testfortext values('0.0100abc',0);
insert into testfortext values('0.0100abc',null);
insert into testforchar values('00100abc',1);
insert into testforchar values('00100abc',0);
insert into testforchar values('00100abc',null);
insert into testforchar values('-1abc',1);
insert into testforchar values('-1abc',0);
insert into testforchar values('-1abc',null);
insert into testforchar values('00200',1);
insert into testforchar values('00200',0);
insert into testforchar values('00200',null);
insert into testforchar values('abc',1);
insert into testforchar values('abc',0);
insert into testforchar values('abc',null);
insert into testforchar values('abc1',1);
insert into testforchar values('abc1',0);
insert into testforchar values('abc1',null);
insert into testforchar values('0.0100abc',1);
insert into testforchar values('0.0100abc',0);
insert into testforchar values('0.0100abc',null);
insert into testforvarchar values('00100abc',1);
insert into testforvarchar values('00100abc',0);
insert into testforvarchar values('00100abc',null);
insert into testforvarchar values('-1abc',1);
insert into testforvarchar values('-1abc',0);
insert into testforvarchar values('-1abc',null);
insert into testforvarchar values('00200',1);
insert into testforvarchar values('00200',0);
insert into testforvarchar values('00200',null);
insert into testforvarchar values('abc',1);
insert into testforvarchar values('abc',0);
insert into testforvarchar values('abc',null);
insert into testforvarchar values('abc1',1);
insert into testforvarchar values('abc1',0);
insert into testforvarchar values('abc1',null);
insert into testforvarchar values('0.0100abc',1);
insert into testforvarchar values('0.0100abc',0);
insert into testforvarchar values('0.0100abc',null);
select a and b from testfortext;
 ?column? 
----------
 t
 f
 
 t
 f
 
 t
 f
 
 f
 f
 f
 f
 f
 f
 t
 f
 
(18 rows)

select a && b from testfortext;
 ?column? 
----------
 t
 f
 
 t
 f
 
 t
 f
 
 f
 f
 f
 f
 f
 f
 t
 f
 
(18 rows)

select a or b from testfortext;
 ?column? 
----------
 t
 t
 t
 t
 t
 t
 t
 t
 t
 t
 f
 
 t
 f
 
 t
 t
 t
(18 rows)

select a || b from testfortext;
 ?column? 
----------
 t
 t
 t
 t
 t
 t
 t
 t
 t
 t
 f
 
 t
 f
 
 t
 t
 t
(18 rows)

select a and b from testforchar;
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
 ?column? 
----------
 t
 f
 
 t
 f
 
 t
 f
 
 f
 f
 f
 f
 f
 f
 t
 f
 
(18 rows)

select a && b from testforchar;
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
 ?column? 
----------
 t
 f
 
 t
 f
 
 t
 f
 
 f
 f
 f
 f
 f
 f
 t
 f
 
(18 rows)

select a or b from testforchar;
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
 ?column? 
----------
 t
 t
 t
 t
 t
 t
 t
 t
 t
 t
 f
 
 t
 f
 
 t
 t
 t
(18 rows)

select a || b from testforchar;
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: 00100abc  
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: -1abc     
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc       
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: abc1      
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc 
 ?column? 
----------
 t
 t
 t
 t
 t
 t
 t
 t
 t
 t
 f
 
 t
 f
 
 t
 t
 t
(18 rows)

select a and b from testforvarchar;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 t
 f
 
 t
 f
 
 t
 f
 
 f
 f
 f
 f
 f
 f
 t
 f
 
(18 rows)

select a && b from testforvarchar;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 t
 f
 
 t
 f
 
 t
 f
 
 f
 f
 f
 f
 f
 f
 t
 f
 
(18 rows)

select a or b from testforvarchar;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 t
 t
 t
 t
 t
 t
 t
 t
 t
 t
 f
 
 t
 f
 
 t
 t
 t
(18 rows)

select a || b from testforvarchar;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: 00100abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: -1abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: abc1
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 t
 t
 t
 t
 t
 t
 t
 t
 t
 t
 f
 
 t
 f
 
 t
 t
 t
(18 rows)

---drop table
drop table testfortext;
drop table testforchar;
drop table testforvarchar;
set dolphin.b_compatibility_mode to on;
create table t1(a varchar(10));
insert into t1 values(1);
select * from t1 where a=true;
 a 
---
 1
(1 row)

create table t2(a char(10));
insert into t2 values(1);
select * from t2 where a=true;
 a 
---
 1
(1 row)

create table t3(a text);
insert into t3 values(1);
select * from t3 where a=true;
 a 
---
 1
(1 row)

drop table t1;
drop table t2;
drop table t3;
select '00100abc' && 1;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
 ?column? 
----------
 t
(1 row)

select '00100abc' && 0;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
 ?column? 
----------
 f
(1 row)

select '00100abc' && null;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
 ?column? 
----------
 
(1 row)

select '-1abc' && 1;
WARNING:  Truncated incorrect DOUBLE value: -1abc
 ?column? 
----------
 t
(1 row)

select '-1abc' && 0;
WARNING:  Truncated incorrect DOUBLE value: -1abc
 ?column? 
----------
 f
(1 row)

select '-1abc' && null;
WARNING:  Truncated incorrect DOUBLE value: -1abc
 ?column? 
----------
 
(1 row)

select '00200' && 1;
 ?column? 
----------
 t
(1 row)

select '00200' && 0;
 ?column? 
----------
 f
(1 row)

select '00200' && null;
 ?column? 
----------
 
(1 row)

select 'abc' && 1;
WARNING:  Truncated incorrect DOUBLE value: abc
 ?column? 
----------
 f
(1 row)

select 'abc' && 0;
WARNING:  Truncated incorrect DOUBLE value: abc
 ?column? 
----------
 f
(1 row)

select 'abc' && null;
WARNING:  Truncated incorrect DOUBLE value: abc
 ?column? 
----------
 f
(1 row)

select 'abc1' && 1;
WARNING:  Truncated incorrect DOUBLE value: abc1
 ?column? 
----------
 f
(1 row)

select 'abc1' && 0;
WARNING:  Truncated incorrect DOUBLE value: abc1
 ?column? 
----------
 f
(1 row)

select 'abc1' && null;
WARNING:  Truncated incorrect DOUBLE value: abc1
 ?column? 
----------
 f
(1 row)

select '0.0100abc' && 1;
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 t
(1 row)

select '0.0100abc' && 0;
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 f
(1 row)

select '0.0100abc' && null;
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 
(1 row)

select '00100abc' || 1;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
 ?column? 
----------
 t
(1 row)

select '00100abc' || 0;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
 ?column? 
----------
 t
(1 row)

select '00100abc' || null;
WARNING:  Truncated incorrect DOUBLE value: 00100abc
 ?column? 
----------
 t
(1 row)

select '-1abc' || 1;
WARNING:  Truncated incorrect DOUBLE value: -1abc
 ?column? 
----------
 t
(1 row)

select '-1abc' || 0;
WARNING:  Truncated incorrect DOUBLE value: -1abc
 ?column? 
----------
 t
(1 row)

select '-1abc' || null;
WARNING:  Truncated incorrect DOUBLE value: -1abc
 ?column? 
----------
 t
(1 row)

select '00200' || 1;
 ?column? 
----------
 t
(1 row)

select '00200' || 0;
 ?column? 
----------
 t
(1 row)

select '00200' || null;
 ?column? 
----------
 t
(1 row)

select 'abc' || 1;
WARNING:  Truncated incorrect DOUBLE value: abc
 ?column? 
----------
 t
(1 row)

select 'abc' || 0;
WARNING:  Truncated incorrect DOUBLE value: abc
 ?column? 
----------
 f
(1 row)

select 'abc' || null;
WARNING:  Truncated incorrect DOUBLE value: abc
 ?column? 
----------
 
(1 row)

select 'abc1' || 1;
WARNING:  Truncated incorrect DOUBLE value: abc1
 ?column? 
----------
 t
(1 row)

select 'abc1' || 0;
WARNING:  Truncated incorrect DOUBLE value: abc1
 ?column? 
----------
 f
(1 row)

select 'abc1' || null;
WARNING:  Truncated incorrect DOUBLE value: abc1
 ?column? 
----------
 
(1 row)

select '0.0100abc' || 1;
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 t
(1 row)

select '0.0100abc' || 0;
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 t
(1 row)

select '0.0100abc' || null;
WARNING:  Truncated incorrect DOUBLE value: 0.0100abc
 ?column? 
----------
 t
(1 row)

select true and 'true' AS false;
WARNING:  Truncated incorrect DOUBLE value: true
CONTEXT:  referenced column: false
 false 
-------
 f
(1 row)

select true and 'false' AS false;
WARNING:  Truncated incorrect DOUBLE value: false
CONTEXT:  referenced column: false
 false 
-------
 f
(1 row)

select true and '1.0 false' AS true;
WARNING:  Truncated incorrect DOUBLE value: 1.0 false
CONTEXT:  referenced column: true
 true 
------
 t
(1 row)

select true and '0.0 true' AS false;
WARNING:  Truncated incorrect DOUBLE value: 0.0 true
CONTEXT:  referenced column: false
 false 
-------
 f
(1 row)

select false or 'true' AS false;
WARNING:  Truncated incorrect DOUBLE value: true
CONTEXT:  referenced column: false
 false 
-------
 f
(1 row)

select false or 'false' AS false;
WARNING:  Truncated incorrect DOUBLE value: false
CONTEXT:  referenced column: false
 false 
-------
 f
(1 row)

select false or '1.0 false' AS true;
WARNING:  Truncated incorrect DOUBLE value: 1.0 false
CONTEXT:  referenced column: true
 true 
------
 t
(1 row)

select false or '0.0 true' AS false;
WARNING:  Truncated incorrect DOUBLE value: 0.0 true
CONTEXT:  referenced column: false
 false 
-------
 f
(1 row)

select true and 'true'::text AS false;
 false 
-------
 f
(1 row)

select true and 'true'::char AS false;
WARNING:  Truncated incorrect DOUBLE value: true
CONTEXT:  referenced column: false
 false 
-------
 f
(1 row)

select true and 'true'::varchar AS false;
WARNING:  Truncated incorrect DOUBLE value: true
CONTEXT:  referenced column: false
 false 
-------
 f
(1 row)

drop schema test_char cascade;
reset current_schema;
