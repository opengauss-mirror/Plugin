create schema test_bit_count;
set current_schema to 'test_bit_count';
-- 测试数字，字符串，二进制输入
SELECT bit_count(29);
 bit_count 
-----------
         4
(1 row)

SELECT bit_count('29');
 bit_count 
-----------
         4
(1 row)

SELECT bit_count(b'101010');
 bit_count 
-----------
         3
(1 row)

-- 测试数字越界（超过64无符号数范围）
select bit_count(18446744073709551614);
 bit_count 
-----------
        63
(1 row)

select bit_count(18446744073709551615);
 bit_count 
-----------
        64
(1 row)

select bit_count(18446744073709551616);
ERROR:  bigint unsigned out of range
CONTEXT:  referenced column: bit_count
select bit_count(-9223372036854775807);
 bit_count 
-----------
         2
(1 row)

select bit_count(-9223372036854775808);
 bit_count 
-----------
         1
(1 row)

select bit_count(-9223372036854775809);
ERROR:  bigint unsigned out of range
CONTEXT:  referenced column: bit_count
-- 测试字符串越界（超过64无符号数范围）
select bit_count('18446744073709551614');
 bit_count 
-----------
        63
(1 row)

select bit_count('18446744073709551615');
 bit_count 
-----------
        64
(1 row)

select bit_count('18446744073709551616');
ERROR:  Incorrect INTEGER value
CONTEXT:  referenced column: bit_count
select bit_count('-9223372036854775807');
 bit_count 
-----------
         2
(1 row)

select bit_count('-9223372036854775808');
 bit_count 
-----------
         1
(1 row)

select bit_count('-9223372036854775809');
ERROR:  Incorrect INTEGER value
CONTEXT:  referenced column: bit_count
set dolphin.sql_mode = '';
select bit_count('18446744073709551614');
 bit_count 
-----------
        63
(1 row)

select bit_count('18446744073709551615');
 bit_count 
-----------
        64
(1 row)

select bit_count('18446744073709551616');
WARNING:  Incorrect INTEGER value
CONTEXT:  referenced column: bit_count
 bit_count 
-----------
        64
(1 row)

select bit_count('-9223372036854775807');
 bit_count 
-----------
         2
(1 row)

select bit_count('-9223372036854775808');
 bit_count 
-----------
         1
(1 row)

select bit_count('-9223372036854775809');
WARNING:  Incorrect INTEGER value
CONTEXT:  referenced column: bit_count
 bit_count 
-----------
         1
(1 row)

select bit_count('1.21');
WARNING:  Incorrect INTEGER value
CONTEXT:  referenced column: bit_count
 bit_count 
-----------
         1
(1 row)

select bit_count('-1.21');
WARNING:  Incorrect INTEGER value
CONTEXT:  referenced column: bit_count
 bit_count 
-----------
        64
(1 row)

-- 测试bit越界（超过64位）
select bit_count(b'111111111111111111111111111111111111111111111111111111111111111');
 bit_count 
-----------
        63
(1 row)

select bit_count(b'1111111111111111111111111111111111111111111111111111111111111111');
 bit_count 
-----------
        64
(1 row)

select bit_count(b'10000000111111111111111111111111111111111111111111111111111111111111111');
 bit_count 
-----------
        64
(1 row)

set dolphin.sql_mode = '';
-- 测试数字越界（超过64无符号数范围）
select bit_count(18446744073709551614);
 bit_count 
-----------
        63
(1 row)

select bit_count(18446744073709551615);
 bit_count 
-----------
        64
(1 row)

select bit_count(18446744073709551616);
WARNING:  bigint unsigned out of range
CONTEXT:  referenced column: bit_count
 bit_count 
-----------
        63
(1 row)

select bit_count(-9223372036854775807);
 bit_count 
-----------
         2
(1 row)

select bit_count(-9223372036854775808);
 bit_count 
-----------
         1
(1 row)

select bit_count(-9223372036854775809);
WARNING:  bigint unsigned out of range
CONTEXT:  referenced column: bit_count
 bit_count 
-----------
         1
(1 row)

-- 测试字符串越界（超过64无符号数范围）
select bit_count('18446744073709551614');
 bit_count 
-----------
        63
(1 row)

select bit_count('18446744073709551615');
 bit_count 
-----------
        64
(1 row)

select bit_count('18446744073709551616');
WARNING:  Incorrect INTEGER value
CONTEXT:  referenced column: bit_count
 bit_count 
-----------
        64
(1 row)

select bit_count('-9223372036854775807');
 bit_count 
-----------
         2
(1 row)

select bit_count('-9223372036854775808');
 bit_count 
-----------
         1
(1 row)

select bit_count('-9223372036854775809');
WARNING:  Incorrect INTEGER value
CONTEXT:  referenced column: bit_count
 bit_count 
-----------
         1
(1 row)

-- 测试bit越界（超过64位）
select bit_count(b'111111111111111111111111111111111111111111111111111111111111111');
 bit_count 
-----------
        63
(1 row)

select bit_count(b'1111111111111111111111111111111111111111111111111111111111111111');
 bit_count 
-----------
        64
(1 row)

select bit_count(b'10000000111111111111111111111111111111111111111111111111111111111111111');
 bit_count 
-----------
        64
(1 row)

select bit_count('2022-12-12'::date);
 bit_count 
-----------
        11
(1 row)

drop schema test_bit_count cascade;
reset current_schema;
