-- check auto startup dolphin-proto
\! netstat -antp | grep $dp | wc -l
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
2
-- dowload mysql-connector-java
\! sh @abs_builddir@/proto_jdbc/install-jars.sh > /dev/null 2>&1
drop database if exists b_databaseproto;
NOTICE:  database "b_databaseproto" does not exist, skipping
create database b_databaseproto dbcompatibility 'b';
\c b_databaseproto
-- change logic database for dolphin-server
alter system set dolphin.default_database_name=b_databaseproto;
DROP USER IF EXISTS proto_user CASCADE;
NOTICE:  role "proto_user" does not exist, skipping
CREATE USER proto_user WITH PASSWORD 'Gauss@123';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
GRANT ALL PRIVILEGES TO proto_user;
SET ROLE proto_user PASSWORD 'Gauss@123';
create schema db_jdbc;
\! $THIRD_PARTY_LIBS/kernel/platform/openjdk8/jdk/bin/javac -classpath @abs_builddir@/proto_jdbc/class/junixsocket-common-2.6.2.jar:@abs_builddir@/proto_jdbc/class/junixsocket-mysql-2.6.2.jar @abs_builddir@/proto_jdbc/class/*.java
-- wrong password before setting set_native_password
\! @abs_bindir@/../jre/bin/java -cp $CLASSPATH:@abs_builddir@/proto_jdbc/class/mysql-connector-java-5.1.47.jar:@abs_builddir@/proto_jdbc/class/. MySQLJdbcTest localhost $dp db_jdbc proto_user wrong_pass@123
Exception in thread "main" java.sql.SQLException: failed in auth check, role:proto_user
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
--?.*
-- set password for navtive_password_plugin authentication
select set_native_password('proto_user', 'Gauss@123');
           set_native_password            
------------------------------------------
 676a8fd5633248f6f59e17d4939f7f6e7093c350
(1 row)

\! @abs_bindir@/../jre/bin/java -cp $CLASSPATH:@abs_builddir@/proto_jdbc/class/mysql-connector-java-5.1.47.jar:@abs_builddir@/proto_jdbc/class/. MySQLJdbcTest localhost $dp db_jdbc proto_user Gauss@123
c1:INT
c2:INT UNSIGNED
c3:TINYINT
c4:TINYINT UNSIGNED
c5:SMALLINT
c6:SMALLINT UNSIGNED
c7:BIGINT
c8:BIGINT UNSIGNED
c9:FLOAT
c10:DOUBLE
c11:BIT
c12:TINYINT
c13:CHAR
c14:BINARY
c15:VARCHAR
c16:VARCHAR
c17:VARBINARY
c18:YEAR
c19:DATE
c20:TIME
c21:TIMESTAMP
c22:DATETIME
c23:TINYBLOB
c24:BLOB
c25:MEDIUMBLOB
c26:LONGBLOB
c27:GEOMETRY
c28:GEOMETRY
c29:VARCHAR
c30:DECIMAL
c31:JSON
c32:CHAR
c33:CHAR
res_getBoolean: true
res_getInt: 1
res_getString: 1
res_getBoolean: false
res_getInt: 0
res_getString: 0
1
mysql
2
dolphin-server
3
postgres
select * from t3 order by id;
 id |      name      
----+----------------
  1 | mysql
  2 | dolphin-server
  3 | postgres
(3 rows)

\! @abs_bindir@/../jre/bin/java -cp $CLASSPATH:@abs_builddir@/proto_jdbc/class/mysql-connector-java-5.1.47.jar:@abs_builddir@/proto_jdbc/class/. MySQLJdbcPrepareTest localhost $dp db_jdbc proto_user Gauss@123
c1:INT:1
c2:INT UNSIGNED:2000
c3:TINYINT:1
c4:TINYINT UNSIGNED:4
c5:SMALLINT:5
c6:SMALLINT UNSIGNED:6
c7:BIGINT:7
c8:BIGINT UNSIGNED:8
c9:FLOAT:9.9
c10:DOUBLE:10.0
c11:BIT:0001100011
c12:TINYINT:1
c13:CHAR:char      
c15:VARCHAR:varchar
c16:VARCHAR:nvarchar
c18:YEAR:2023-01-01
c19:DATE:2023-02-27
c20:TIME:14:46:30
c21:TIMESTAMP:2023-03-07 16:16:16.666
c22:DATETIME:2023-03-07 16:16:16.666
c23:TINYBLOB:blob
c24:BLOB:blob
c25:MEDIUMBLOB:blob
c26:LONGBLOB:blob
c27:GEOMETRY:(1000,0)
c28:GEOMETRY:((1000,0),(200,3))
c29:VARCHAR:text
c30:DECIMAL:20.000
c31:JSON:{"k": "v"}
c32:CHAR:a
c33:CHAR:a
c1:INT:null
c2:INT UNSIGNED:null
c3:TINYINT:0
c4:TINYINT UNSIGNED:null
c5:SMALLINT:null
c6:SMALLINT UNSIGNED:null
c7:BIGINT:null
c8:BIGINT UNSIGNED:null
c9:FLOAT:null
c10:DOUBLE:null
c11:BIT:null
c12:TINYINT:null
c13:CHAR:null
c15:VARCHAR:null
c16:VARCHAR:null
c18:YEAR:null
c19:DATE:null
c20:TIME:null
c21:TIMESTAMP:null
c22:DATETIME:null
c23:TINYBLOB:null
c24:BLOB:null
c25:MEDIUMBLOB:null
c26:LONGBLOB:null
c27:GEOMETRY:null
c28:GEOMETRY:null
c29:VARCHAR:null
c30:DECIMAL:null
c31:JSON:null
c32:CHAR:null
c33:CHAR:null
update failed:invalid input syntax for type tinyint: "abc"
delete failed:invalid input syntax for type tinyint: "abc"
select * from t3;
 c1 |  c2  | c3 | c4 | c5 | c6 | c7 | c8 | c9  | c10 |    c11     | c12 |    c13     |   c15   |   c16    | c18  |    c19     |   c20    |            c21             |           c22           |    c23     |   c24    |    c25     |    c26     |   c27    |        c28         | c29  |  c30   |    c31     | c32 | c33 
----+------+----+----+----+----+----+----+-----+-----+------------+-----+------------+---------+----------+------+------------+----------+----------------------------+-------------------------+------------+----------+------------+------------+----------+--------------------+------+--------+------------+-----+-----
  1 | 2000 | 1  | 4  |  5 | 6  |  7 | 8  | 9.9 |  10 | 0001100011 | t   | char       | varchar | nvarchar | 2023 | 2023-02-27 | 14:46:30 | 2023-03-07 00:16:16.666-08 | 2023-03-07 16:16:16.666 | \x626c6f62 | 626C6F62 | \x626c6f62 | \x626c6f62 | (1000,0) | ((1000,0),(200,3)) | text | 20.000 | {"k": "v"} | a   | a
(1 row)

\! @abs_bindir@/../jre/bin/java -cp $CLASSPATH:@abs_builddir@/proto_jdbc/class/mysql-connector-java-5.1.47.jar:@abs_builddir@/proto_jdbc/class/. MySQLJdbcAutoCommitTest localhost $dp db_jdbc proto_user Gauss@123
select relname from pg_class where relname like '%autocommit_test%' order by relname;
     relname      
------------------
 autocommit_test2
 autocommit_test3
 autocommit_test5
 autocommit_test6
(4 rows)

select * from autocommit_test6;
 a 
---
 2
(1 row)

\! @abs_bindir@/../jre/bin/java -cp $CLASSPATH:@abs_builddir@/proto_jdbc/class/mysql-connector-java-5.1.47.jar:@abs_builddir@/proto_jdbc/class/junixsocket-common-2.6.2.jar:@abs_builddir@/proto_jdbc/class/junixsocket-mysql-2.6.2.jar:@abs_builddir@/proto_jdbc/class/junixsocket-native-common-2.6.2.jar:@abs_builddir@/proto_jdbc/class/. MySQLJdbcAutoIncrementTest $dp db_uds $USER
1
2
3
4
RESET ROLE;
DROP USER IF EXISTS proto_user CASCADE;
\! rm @abs_builddir@/proto_jdbc/class/*.class
