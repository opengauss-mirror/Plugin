-- dowload mysql-connector-java
\! sh @abs_builddir@/proto_jdbc/install-jars.sh > /dev/null 2>&1
drop database if exists b_databaseproto;
NOTICE:  database "b_databaseproto" does not exist, skipping
create database b_databaseproto dbcompatibility 'b';
\c b_databaseproto
-- change logic database for dolphin-server
alter system set dolphin.default_database_name=b_databaseproto;
DROP USER IF EXISTS proto_user CASCADE;
NOTICE:  role "proto_user" does not exist, skipping
CREATE USER proto_user WITH PASSWORD 'Gauss@123';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
GRANT ALL PRIVILEGES TO proto_user;
SET ROLE proto_user PASSWORD 'Gauss@123';
create schema db_jdbc;
-- set password for navtive_password_plugin authentication
select set_native_password('proto_user', 'Gauss@123');
           set_native_password            
------------------------------------------
 676a8fd5633248f6f59e17d4939f7f6e7093c350
(1 row)

\! $THIRD_PARTY_LIBS/kernel/platform/openjdk8/jdk/bin/javac @abs_builddir@/proto_jdbc/class/*.java
\! @abs_bindir@/../jre/bin/java -cp $CLASSPATH:@abs_builddir@/proto_jdbc/class/mysql-connector-java-5.1.47.jar:@abs_builddir@/proto_jdbc/class/. MySQLJdbcTest localhost $dp db_jdbc proto_user Gauss@123
c1:INT
c2:INT UNSIGNED
c3:TINYINT
c4:TINYINT UNSIGNED
c5:SMALLINT
c6:SMALLINT UNSIGNED
c7:BIGINT
c8:BIGINT UNSIGNED
c9:FLOAT
c10:DOUBLE
c11:BIT
c12:TINYINT
c13:CHAR
c14:BINARY
c15:VARCHAR
c16:VARCHAR
c17:VARBINARY
c18:YEAR
c19:DATE
c20:TIME
c21:TIMESTAMP
c22:DATETIME
c23:TINYBLOB
c24:BLOB
c25:MEDIUMBLOB
c26:LONGBLOB
c27:GEOMETRY
c28:GEOMETRY
c29:VARCHAR
c30:DECIMAL
c31:JSON
c32:CHAR
c33:CHAR
res_getBoolean: true
res_getInt: 1
res_getString: 1
res_getBoolean: false
res_getInt: 0
res_getString: 0
1
mysql
2
dolphin-server
3
postgres
select * from t3 order by id;
 id |      name      
----+----------------
  1 | mysql
  2 | dolphin-server
  3 | postgres
(3 rows)

\! @abs_bindir@/../jre/bin/java -cp $CLASSPATH:@abs_builddir@/proto_jdbc/class/mysql-connector-java-5.1.47.jar:@abs_builddir@/proto_jdbc/class/. MySQLJdbcPrepareTest localhost $dp db_jdbc proto_user Gauss@123
c1:INT:1
c2:INT UNSIGNED:2000
c3:TINYINT:1
c4:TINYINT UNSIGNED:4
c5:SMALLINT:5
c6:SMALLINT UNSIGNED:6
c7:BIGINT:7
c8:BIGINT UNSIGNED:8
c9:FLOAT:9.9
c10:DOUBLE:10.0
c11:BIT:0001100011
c12:TINYINT:1
c13:CHAR:char      
c14:BINARY:binary
c15:VARCHAR:varchar
c16:VARCHAR:nvarchar
c17:VARBINARY:varbinary
c18:YEAR:2023-01-01
c19:DATE:2023-02-27
c20:TIME:14:46:30
c21:TIMESTAMP:2023-03-07 16:16:16.666
c22:DATETIME:2023-03-07 16:16:16.666
c23:TINYBLOB:null
c24:BLOB:null
c25:MEDIUMBLOB:null
c26:LONGBLOB:null
c27:GEOMETRY:(1000,0)
c28:GEOMETRY:((1000,0),(200,3))
c29:VARCHAR:text
c30:DECIMAL:20.000
c31:JSON:{"k": "v"}
c32:CHAR:a
c33:CHAR:a
select * from t3;
 c1 |  c2  | c3 | c4 | c5 | c6 | c7 | c8 | c9  | c10 |    c11     | c12 |    c13     |          c14           |   c15   |   c16    |         c17          | c18  |    c19     |   c20    |               c21                |             c22              | c23 | c24 | c25 | c26 |   c27    |        c28         | c29  |  c30   |    c31     | c32 | c33 
----+------+----+----+----+----+----+----+-----+-----+------------+-----+------------+------------------------+---------+----------+----------------------+------+------------+----------+----------------------------------+------------------------------+-----+-----+-----+-----+----------+--------------------+------+--------+------------+-----+-----
  1 | 2000 | 1  | 4  |  5 | 6  |  7 | 8  | 9.9 |  10 | 0001100011 | t   | char       | \x62696e61727900000000 | varchar | nvarchar | \x76617262696e617279 | 2023 | 02-27-2023 | 14:46:30 | Tue Mar 07 00:16:16.666 2023 PST | Tue Mar 07 16:16:16.666 2023 |     |     |     |     | (1000,0) | ((1000,0),(200,3)) | text | 20.000 | {"k": "v"} | a   | a
(1 row)

RESET ROLE;
DROP USER IF EXISTS proto_user CASCADE;
\! rm @abs_builddir@/proto_jdbc/class/*.class
