show sql_compatibility;
 sql_compatibility 
-------------------
 B
(1 row)

create user 'test_user_host'@'%' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create user 'test_user_host'@'127.%' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create user 'test_user_host'@'127.0.0.%' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create user 'test_user_host'@'127.0.%' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create user 'test_user_host%' password 'test123@';
ERROR:  syntax error at or near "test_user_host%"
LINE 1: create user 'test_user_host%' password 'test123@';
                    ^
create user 'test_user_host'@'127.0.0.1' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create database user_host_db dbcompatibility 'B';
\c user_host_db;
set b_compatibility_user_host_auth = off;
create user 'test_user_host'@'%' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create user 'test_user_host'@'127.%' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create user 'test_user_host'@'127.0.0.%' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create user 'test_user_host'@'127.0.%' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
create user 'test_user_host%' password 'test123@';
ERROR:  syntax error at or near "test_user_host%"
LINE 1: create user 'test_user_host%' password 'test123@';
                    ^
create user 'test_user_host'@'127.0.0.1' password 'test123@';
ERROR:  user@host is only supported in b database when the b_compatibility_user_host_auth is on
set b_compatibility_user_host_auth = on;
CREATE USER 'da@localhost'@'%' PASSWORD 'test123@';
ERROR:  @ can't be allowed in username
create user if not exists 'test_user_host'@'%' password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
alter user 'test_user_host'@'%' with account lock;
alter user 'test_user_host'@'%' password 'test1234@';
ERROR:  The account has been locked.
alter user 'test_user_host'@'%' with account unlock;
create user 'test_user_host'@'127.%' password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user 'test_user_host'@'127.0.0.%' password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user 'test_user_host'@'127.0.%' password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user 'test_user_host%' password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user 'test_user_host'@'127.0.0.1' password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user 'test_user_host1@127.0.0.1' password 'test123@';
ERROR:  @ can't be allowed in username
create user test_user_host1@127.0.0.1 password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user test_user_host1@127.0.0. password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user test_user_host2@localhost password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user 'test_user_host3'@'localhost' password 'test123@';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
create user test_user_host1@127.0.0.% password 'test123@';
ERROR:  syntax error at or near "%"
LINE 1: create user test_user_host1@127.0.0.% password 'test123@';
                                            ^
select usename from pg_user where usename like 'test_user_host%' order by usename;
          usename          
---------------------------
 test_user_host%
 test_user_host1@127.0.0.
 test_user_host1@127.0.0.1
 test_user_host2@localhost
 test_user_host3@localhost
 test_user_host@%
 test_user_host@127.%
 test_user_host@127.0.%
 test_user_host@127.0.0.%
 test_user_host@127.0.0.1
(10 rows)

create table test1(a int);
alter table test1 owner to 'test_user_host'@'%';
GRANT ALL PRIVILEGES TO 'test_user_host'@'%';
REVOKE ALL PRIVILEGES FROM 'test_user_host'@'%';
ALTER USER 'test_user_host'@'%' password 'test@123';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
ALTER USER 'test_user_host'@'%' RENAME TO 'test_user_host'@'1%';
CREATE  DEFINER='test_user_host'@'127.0.%' FUNCTION test_func(integer, integer) RETURNS integer SECURITY INVOKER
AS 'select $1 + $2;'
LANGUAGE SQL
IMMUTABLE
RETURNS NULL ON NULL INPUT;
create table test2(a int);
insert into test2 values(1);
grant select on test2 to 'test_user_host'@'127.0.%';
grant insert on test2 to 'test_user_host'@'127.0.%';
revoke insert on test2 from 'test_user_host'@'127.0.%';
create user test1@localhost password 'Test@123';
NOTICE:  The iteration value of password is not recommended.Setting the iteration value too small reduces the security of the password, and setting it too large results in performance degradation.
alter session set session authorization test1@localhost password 'Test@123';
--?.*
--?.*
--?.*
\! sleep 5
--?.*
       current_user       
--------------------------
 test_user_host@127.0.0.1
(1 row)

--?.*
DROP ROLE
--?.*
\! sleep 5
--?.*
       current_user       
--------------------------
 test_user_host@127.0.0.%
(1 row)

--?.*
DROP ROLE
--?.*
\! sleep 5
--?.*
      current_user      
------------------------
 test_user_host@127.0.%
(1 row)

--?.*
 a 
---
 1
(1 row)

