## 兼容mysql时间类型

下列表格为兼容 mysql 数据库后时间数据类型后的基本属性

| 类型         | 描述                                                         | 存储空间 | 取值范围                             | 精度范围                           | 备注                                                         |
| ------------ | ------------------------------------------------------------ | -------- | ------------------------------------ | ---------------------------------- | ------------------------------------------------------------ |
| date         | 日期                                                         | 4 字节   | 4713 BC ~ 294276 AD                  | -                                  | 输入必须为有效日期，不支持月份或者天数为零值                 |
| time(p)      | 可以用于表示一天中的时间或者一段时间(时分秒)，p 表示精度     | 8 字节   | -838:59:59[.frac] ~ 838:59:59[.frac] | p表示小数点后的精度，取值范围为0~6 | -                                                            |
| datetime(p)  | 日期和时间，不带时区信息，p 表示精度                         | 8字节    | 4713 BC ~ 294276 AD                  | p表示小数点后的精度，取值范围为0~6 | 输入必须为有效日期，不支持月份或者天数为零值                 |
| timestamp(p) | 日期和时间，带时区信息，p 表示精度                           | 8字节    | 4713 BC ~ 294276 AD                  | p表示小数点后的精度，取值范围为0~6 | 输入必须为有效日期，不支持月份或者天数为零值；注意，timestamp 类型在原来 openGauss 数据库中表示不带时区的时间戳，兼容后的 timestamp 类型往 mysql 数据库靠拢，表示带时区信息的时间戳，因此存在兼容性问题 |
| year(w)      | 年份，w 表示 "display width"，year(4)、year 形式输出为 'YYYY' 形式，year(2) 形式输出为 'YY' | 2字节    | 1901 ~ 2155                          | -                                  | -                                                            |



### date 类型输入

支持如下格式：

| 格式                      | 含义   |
| ------------------------- | ------ |
| 'YYYY-MM-DD' , 'YY-MM-DD' | 年月日 |
| 'YYYYMMDD' 、'YYMMDD'     | 年月日 |
| YYYYMMDD、YYMMDD          | 年月日 |

备注：

- 输入必须为有效日期，不支持月份或者日期为零值
- 输入整数形式(YYYYMMDD, YYMMDD) 格式，需要加上强制类型转换符号 :: 或者使用 cast 函数；当输入整数0时，代表的值为 '0000-00-00'

示例(注意下方 openGauss 数据库兼容性为 b)

```sql
--创建表。
openGauss=# CREATE TABLE test_date(
openGauss(# dt date);
CREATE TABLE
    
--插入数据。
openGauss=# INSERT INTO test_date VALUES ('2020-12-21');
INSERT 0 1
openGauss=# INSERT INTO test_date VALUES ('141221');
INSERT 0 1
openGauss=# INSERT INTO test_date VALUES (20151022::date);
INSERT 0 1

--查看数据。
openGauss=# SELECT * FROM test_date;
     dt     
------------
 2020-12-21
 2014-12-21
 2015-10-22
(3 rows)
```



### time 类型输入

支持如下格式：

| 格式                           | 含义                                                   |
| ------------------------------ | ------------------------------------------------------ |
| '\[-\]\[D\] hh:mm:ss\[.frac\]' | 时分秒，前方可以指定为负，D 表示天数，取值范围为[0-34] |
| '\[-\]hhmmss\[.frac\]'         | 时分秒                                                 |
| \[-\]hhmmss\[.frac\]           | 时分秒                                                 |

备注：

- 对于格式 'hh:mm:ss' ，还支持宽松的类型 'hh:mm' 和 'ss' 的输入格式
- 输入整数(如hhmmss)需要加上强制类型转换符号 :: 或者使用 cast 函数；当输入整数0时，代表的值为 '00:00:00'，也是 time 类型的零值

示例(注意下方 openGauss 数据库兼容性为 b)

```sql
--创建表。
openGauss=# CREATE TABLE test_time(
openGauss(# ti time(2));
CREATE TABLE
    
--插入数据。
openGauss=# INSERT INTO test_time VALUES ('2 9:12:24.1234');
INSERT 0 1
openGauss=# INSERT INTO test_time VALUES ('-34:56:59.1234');
INSERT 0 1
openGauss=# INSERT INTO test_time VALUES (561234::time);
INSERT 0 1

--查看数据。
openGauss=# SELECT * FROM test_time;
      ti      
--------------
 57:12:24.12
 -34:56:59.12
 56:12:34
(3 rows)
```



### datetime 类型输入

支持如下格式：

| 格式                                                         | 含义   |
| ------------------------------------------------------------ | ------ |
| 'YYYY-MM-DD hh:mm:ss\[.frac\]'，'YY-MM-DD hh:mm:ss\[.frac\]' | 时间戳 |
| 'YYYYMMDDhhmmss\[.frac]'， 'YYMMDDhhmmss\[.frac\]'           | 时间戳 |
| YYYYMMDDhhmmss\[.frac]，YYMMDDhhmmss\[.frac]                 | 时间戳 |

备注：

- 输入必须为有效日期，不支持月份或者日期为零值
- 对于'YYYYMMDDhhmmss' 和 'YYMMDDhhmmss' 格式，只有当字符串长度刚好为 8 或者 14 的时候，才会将字符串前4位字母识别为年的部分，其余都只会将前2位字母识别为年的部分。
- 对于输入为 YYYYMMDDhhmmss 或 YYMMDDhhmmss 格式，输入的整数长度应该为 6/8/12/14 其中之一，如果长度不满足这个要求，则相当于往整数前方添加零，直到长度符合 6/8/12/14 其中之一(长度为6对应为YYMMDD格式，长度为8对应为YYYYMMDD格式，长度为12对应为YYMMDDhhmmss格式，长度为14对应为YYYYMMDDhhmmss格式)

示例(注意下方 openGauss 数据库兼容性为 b)

```sql
--创建表。
openGauss=# CREATE TABLE test_datetime(
openGauss(# dt datetime(2));
CREATE TABLE
    
--插入数据。
openGauss=# INSERT INTO test_datetime VALUES ('0-0-0 0:0:0');
INSERT 0 1
openGauss=# INSERT INTO test_datetime VALUES ('201108023125.955');
INSERT 0 1
openGauss=# INSERT INTO test_datetime VALUES (201112234512::datetime);
INSERT 0 1

--查看数据。
openGauss=# SELECT * FROM test_datetime;
           dt           
------------------------
 0000-00-00 00:00:00
 2020-11-08 02:31:25.96
 2020-11-12 23:45:12
(3 rows)
```



### timestamp 类型输入

支持如下格式：

| 格式                                                         | 含义             |
| ------------------------------------------------------------ | ---------------- |
| 'YYYY-MM-DD hh:mm:ss\[.frac\]\[+/-hh:mm:ss\]'， 'YY-MM-DD hh:mm:ss\[.frac\]\[+/-hh:mm:ss\]' | 带时区信息时间戳 |
| 'YYYYMMDDhhmmss\[.frac\]'， 'YYMMDDhhmmss\[.frac]'           | 带时区信息时间戳 |
| YYYYMMDDhhmmss\[.frac\]，YYMMDDhhmmss\[.frac\]               | 带时区信息时间戳 |

备注：

- 输入必须为有效日期，不支持月份或者日期为零值
- 兼容的 timestamp 类型允许在格式'YYYY-MM-DD hh:mm:ss\[.frac\]'后面带上时区的偏移信息\[+/-hh:mm:ss\]

示例(注意下方 openGauss 数据库兼容性为 b)

```sql
--创建表。
openGauss=# CREATE TABLE test_timestamp(
openGauss(# ts timestamp(2));
CREATE TABLE
    
--插入数据。
openGauss=# INSERT INTO test_timestamp VALUES ('0-0-0 0:0:0');
INSERT 0 1
openGauss=# INSERT INTO test_timestamp VALUES ('2012-10-21 23:55:23-12:12');
INSERT 0 1
openGauss=# INSERT INTO test_timestamp VALUES (201112234512::timestamp);
INSERT 0 1

--查看数据。
openGauss=# SELECT * FROM test_timestamp;
           ts           
------------------------
 0000-00-00 00:00:00
 2012-10-22 20:07:23
 2020-11-12 23:45:12
(3 rows)
    
--变更时区。
openGauss=# SET TIME ZONE UTC;
SET
--查看数据。
openGauss=# SELECT * FROM test_timestamp;
           ts           
------------------------
 0000-00-00 00:00:00
 2012-10-22 12:07:23
 2020-11-12 15:45:12
(3 rows)
```



### year/year(4)，year(2)类型输入

支持如下格式：

| 格式          | 含义                                                         |
| ------------- | ------------------------------------------------------------ |
| 'YYYY'， 'YY' | 年，当输入两位数年份时，若值小于70，则实际年份需要加上2000，例如'69'表示2069年；若值大于等于70，则实际年份需要加上1900，例如'70'表示1970年 |
| YYYY， YY     | 年                                                           |

备注

- 三种类型都接受相同的输入格式和范围，区别仅在于 year(2) 类型输出格式只为 2 位数
- 如果输入'0'，openGuass 会解析成为2000年；但是当输入的是整数0，openGauss 会解析成为 0，表示 year类型的 0 值。需要注意的是，输入整数形式需要使用强制转换符 :: 或者 cast 函数首先进行类型转换。

示例(注意下方 openGauss 数据库兼容性为 b)

```sql
--创建表。
openGauss=# CREATE TABLE test_year(
openGauss(#  y year,
openGauss(#  y2 year(2));
CREATE TABLE
    
--插入数据。
openGauss=# INSERT INTO test_year VALUES ('70', '70');
INSERT 0 1
openGauss=# INSERT INTO test_year VALUES ('69', '69');
INSERT 0 1
openGauss=# INSERT INTO test_year VALUES ('2069', '2069');
INSERT 0 1
openGauss=# INSERT INTO test_year VALUES ('1970', '1970');
INSERT 0 1

--查看数据。
openGauss=# SELECT * FROM test_year;
  y   | y2 
------+----
 1970 | 70
 2069 | 69
 2069 | 69
 1970 | 70
(4 rows)
```

