create schema test_interval_expr;
set current_schema to 'test_interval_expr';

-- 类型
select 1::interval;
select 1::interval year;
select 1::interval quarter;
select 1::interval month;
select 1::interval week;
select 1::interval day;
select 1::interval hour;
select 1::interval minute;
select 1::interval second;
select 1::interval microsecond;
select '1 2'::interval year_month;
select '1 2'::intervalyear to month;
select '1 2'::interval day_hour;
select '1 2'::interval day to hour;
select '1 2 3'::interval day_minute;
select '1 2 3'::interval day to minute;
select '1 2 3 4'::interval day_second;
select '1 2 3 4'::interval day to second;
select '1 2 3 4 5'::interval day_microsecond;
select '1 2 3 4 5'::interval day to microsecond;
select '1 2'::interval hour_minute;
select '1 2'::interval hour to minute;
select '1 2 3'::interval hour_second;
select '1 2 3'::interval hour to second;
select '1 2 3 4'::interval hour_microsecond;
select '1 2 3 4'::interval hour to microsecond;
select '1 2'::interval minute_second;
select '1 2'::interval minute to second;
select '1 2 3'::interval minute_microsecond;
select '1 2 3'::interval minute to microsecond;
select '1 2'::interval second_microsecond;
select '1 2'::interval second to microsecond;

-- 表达式
select interval 1 + 2 * 3 + 0.1 year;
select interval 1 + 2 * 3 + 0.1 quarter;
select interval 1 + 2 * 3 + 0.1 month;
select interval 1 + 2 * 3 + 0.1 week;
select interval 1 + 2 * 3 + 0.1 day;
select interval 1 + 2 * 3 + 0.1 hour;
select interval 1 + 2 * 3 + 0.1 minute;
select interval 1 + 2 * 3 + 0.1 second;
select interval 1 + 2 * 3 + 0.1 microsecond;
select interval '1 2' year_month;
select interval '1 2' year to month;
select interval '1 2' day_hour;
select interval '1 2' day to hour;
select interval '1 2 3' day_minute;
select interval '1 2 3' day to minute;
select interval '1 2 3 4' day_second;
select interval '1 2 3 4' day to second;
select interval '1 2 3 4 5' day_microsecond;
select interval '1 2 3 4 5' day to microsecond;
select interval '1 2' hour_minute;
select interval '1 2' hour to minute;
select interval '1 2 3' hour_second;
select interval '1 2 3' hour to second;
select interval '1 2 3 4' hour_microsecond;
select interval '1 2 3 4' hour to microsecond;
select interval '1 2' minute_second;
select interval '1 2' minute to second;
select interval '1 2 3' minute_microsecond;
select interval '1 2 3' minute to microsecond;
select interval '1 2' second_microsecond;
select interval '1 2' second to microsecond;

-- 绑定参数
prepare stmt as 'select ? + interval 1 + ? year';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval 1 + ? quarter';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval 1 + ? month';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval 1 + ? week';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval 1 + ? day';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval 1 + ? hour';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval 1 + ? minute';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval 1 + ? second';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval 1 + ? microsecond';
execute stmt('2024-06-18 18:30:00', 1);
prepare stmt as 'select ? + interval ? year_month';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? year to month';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? day_hour';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? day to hour';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? day_minute';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? day to minute';
execute stmt('2024-06-18 18:30:00', '1 2 3');
prepare stmt as 'select ? + interval ? day_second';
execute stmt('2024-06-18 18:30:00', '1 2 3');
prepare stmt as 'select ? + interval ? day to second';
execute stmt('2024-06-18 18:30:00', '1 2 3 4');
prepare stmt as 'select ? + interval ? day_microsecond';
execute stmt('2024-06-18 18:30:00', '1 2 3 4 5');
prepare stmt as 'select ? + interval ? day to microsecond';
execute stmt('2024-06-18 18:30:00', '1 2 3 4 5');
prepare stmt as 'select ? + interval ? hour_minute';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? hour to minute';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? hour_second';
execute stmt('2024-06-18 18:30:00', '1 2 3');
prepare stmt as 'select ? + interval ? hour to second';
execute stmt('2024-06-18 18:30:00', '1 2 3');
prepare stmt as 'select ? + interval ? hour_microsecond';
execute stmt('2024-06-18 18:30:00', '1 2 3 4');
prepare stmt as 'select ? + interval ? hour to microsecond';
execute stmt('2024-06-18 18:30:00', '1 2 3 4');
prepare stmt as 'select ? + interval ? minute_second';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? minute to second';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? minute_microsecond';
execute stmt('2024-06-18 18:30:00', '1 2 3');
prepare stmt as 'select ? + interval ? minute to microsecond';
execute stmt('2024-06-18 18:30:00', '1 2 3');
prepare stmt as 'select ? + interval ? second_microsecond';
execute stmt('2024-06-18 18:30:00', '1 2');
prepare stmt as 'select ? + interval ? second to microsecond';
execute stmt('2024-06-18 18:30:00', '1 2');

-- 列引用
create table t1 (c1 int);
insert into t1 values(1);
select '2024-06-18 18:30:00' + interval 1 + c1 year from t1;
select '2024-06-18 18:30:00' + interval 1 + c1 quarter from t1;
select '2024-06-18 18:30:00' + interval 1 + c1 month from t1;
select '2024-06-18 18:30:00' + interval 1 + c1 week from t1;
select '2024-06-18 18:30:00' + interval 1 + c1 day from t1;
select '2024-06-18 18:30:00' + interval 1 + c1 hour from t1;
select '2024-06-18 18:30:00' + interval 1 + c1 minute from t1;
select '2024-06-18 18:30:00' + interval 1 + c1 second from t1;
select '2024-06-18 18:30:00' + interval 1 + c1 microsecond from t1;
select '2024-06-18 18:30:00' + interval '1 2' year_month from t1;
select '2024-06-18 18:30:00' + interval '1 2' year to month from t1;
select '2024-06-18 18:30:00' + interval '1 2' day_hour from t1;
select '2024-06-18 18:30:00' + interval '1 2' day to hour from t1;
select '2024-06-18 18:30:00' + interval '1 2 3' day_minute from t1;
select '2024-06-18 18:30:00' + interval '1 2 3' day to minute from t1;
select '2024-06-18 18:30:00' + interval '1 2 3 4' day_second from t1;
select '2024-06-18 18:30:00' + interval '1 2 3 4' day to second from t1;
select '2024-06-18 18:30:00' + interval '1 2 3 4 5' day_microsecond from t1;
select '2024-06-18 18:30:00' + interval '1 2 3 4 5' day to microsecond from t1;
select '2024-06-18 18:30:00' + interval '1 2' hour_minute from t1;
select '2024-06-18 18:30:00' + interval '1 2' hour to minute from t1;
select '2024-06-18 18:30:00' + interval '1 2 3' hour_second from t1;
select '2024-06-18 18:30:00' + interval '1 2 3' hour to second from t1;
select '2024-06-18 18:30:00' + interval '1 2 3 4' hour_microsecond from t1;
select '2024-06-18 18:30:00' + interval '1 2 3 4' hour to microsecond from t1;
select '2024-06-18 18:30:00' + interval '1 2' minute_second from t1;
select '2024-06-18 18:30:00' + interval '1 2' minute to second from t1;
select '2024-06-18 18:30:00' + interval '1 2 3' minute_microsecond from t1;
select '2024-06-18 18:30:00' + interval '1 2 3' minute to microsecond from t1;
select '2024-06-18 18:30:00' + interval '1 2' second_microsecond from t1;
select '2024-06-18 18:30:00' + interval '1 2' second to microsecond from t1;

select '2024-06-18 18:30:00' - interval 1 + c1 year from t1;
select '2024-06-18 18:30:00' - interval 1 + c1 quarter from t1;
select '2024-06-18 18:30:00' - interval 1 + c1 month from t1;
select '2024-06-18 18:30:00' - interval 1 + c1 week from t1;
select '2024-06-18 18:30:00' - interval 1 + c1 day from t1;
select '2024-06-18 18:30:00' - interval 1 + c1 hour from t1;
select '2024-06-18 18:30:00' - interval 1 + c1 minute from t1;
select '2024-06-18 18:30:00' - interval 1 + c1 second from t1;
select '2024-06-18 18:30:00' - interval 1 + c1 microsecond from t1;
select '2024-06-18 18:30:00' - interval '1 2' year_month from t1;
select '2024-06-18 18:30:00' - interval '1 2' year to month from t1;
select '2024-06-18 18:30:00' - interval '1 2' day_hour from t1;
select '2024-06-18 18:30:00' - interval '1 2' day to hour from t1;
select '2024-06-18 18:30:00' - interval '1 2 3' day_minute from t1;
select '2024-06-18 18:30:00' - interval '1 2 3' day to minute from t1;
select '2024-06-18 18:30:00' - interval '1 2 3 4' day_second from t1;
select '2024-06-18 18:30:00' - interval '1 2 3 4' day to second from t1;
select '2024-06-18 18:30:00' - interval '1 2 3 4 5' day_microsecond from t1;
select '2024-06-18 18:30:00' - interval '1 2 3 4 5' day to microsecond from t1;
select '2024-06-18 18:30:00' - interval '1 2' hour_minute from t1;
select '2024-06-18 18:30:00' - interval '1 2' hour to minute from t1;
select '2024-06-18 18:30:00' - interval '1 2 3' hour_second from t1;
select '2024-06-18 18:30:00' - interval '1 2 3' hour to second from t1;
select '2024-06-18 18:30:00' - interval '1 2 3 4' hour_microsecond from t1;
select '2024-06-18 18:30:00' - interval '1 2 3 4' hour to microsecond from t1;
select '2024-06-18 18:30:00' - interval '1 2' minute_second from t1;
select '2024-06-18 18:30:00' - interval '1 2' minute to second from t1;
select '2024-06-18 18:30:00' - interval '1 2 3' minute_microsecond from t1;
select '2024-06-18 18:30:00' - interval '1 2 3' minute to microsecond from t1;
select '2024-06-18 18:30:00' - interval '1 2' second_microsecond from t1;
select '2024-06-18 18:30:00' - interval '1 2' second to microsecond from t1;
drop schema test_interval_expr cascade;
reset current_schema;
