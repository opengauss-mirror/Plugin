create extension custom_analyzer_demo;
-- test without custom analyzer
show custom_analyzer_demo.enable_custom_analyzer;
 custom_analyzer_demo.enable_custom_analyzer 
---------------------------------------------
 off
(1 row)

set custom_analyzer_demo.enable_custom_analyzer to off;
drop table if exists group_test;
NOTICE:  table "group_test" does not exist, skipping
create table group_test(a int, b int);
insert into group_test values(1,1),(2,2),(3,3),(3,4),(3,5),(2,66);
select * from group_test;
 a | b  
---+----
 1 |  1
 2 |  2
 3 |  3
 3 |  4
 3 |  5
 2 | 66
(6 rows)

SELECT a, b FROM group_test GROUP BY a order by a,b;
ERROR:  column "group_test.b" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT a, b FROM group_test GROUP BY a order by a,b;
                  ^
-- test with custom analyzer
set custom_analyzer_demo.enable_custom_analyzer to on;
SELECT a, b FROM group_test GROUP BY a order by a,b;
 a | b 
---+---
 1 | 1
 2 | 2
 3 | 3
(3 rows)

--cleanup
set custom_analyzer_demo.enable_custom_analyzer to off;
drop table group_test;
